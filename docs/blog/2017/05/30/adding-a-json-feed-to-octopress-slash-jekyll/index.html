<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <title>Adding a JSON Feed to an Octopress/Jekyll generated site - Jake McCrary</title>
  <meta name="author" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- <link rel="stylesheet" href="/style.css"> -->

  <meta itemprop="name" content="Adding a JSON Feed to an Octopress/Jekyll generated site - Jake McCrary" />
  
  <meta itemprop="description" content="Quick guide to adding a JSON Feed to your Octopress/Jekyll generated site" />
  

  <!-- Twitter Card data -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@jakemcc" />
  <meta name="twitter:title" content="Adding a JSON Feed to an Octopress/Jekyll generated site - Jake McCrary" />
  
  <meta name="twitter:description" content="Quick guide to adding a JSON Feed to your Octopress/Jekyll generated site" />
  
  <meta name="twitter:creator" content="@jakemcc" />
  <!-- <meta name="twitter:image" content="" /> -->

  <!-- Open Graph data -->
  <meta property="og:site_name" content="Writing by Jake McCrary" />
  <meta property="og:url" content="https://jakemccrary.com//blog/2017/05/30/adding-a-json-feed-to-octopress-slash-jekyll/" />
  <meta property="og:title" content="Adding a JSON Feed to an Octopress/Jekyll generated site - Jake McCrary" />
  
  <meta property="og:description" content="Quick guide to adding a JSON Feed to your Octopress/Jekyll generated site" />
  
  <!-- <meta property="og:image" content="" /> -->
  
  <meta property="og:type" content="article" />
  
  
  <!-- maybe rfc blahblahblah it? -->
  <meta property="article:published_time" content="2017-05-30T23:59:59+00:00" />
  

  <link rel="canonical" href="https://jakemccrary.com//blog/2017/05/30/adding-a-json-feed-to-octopress-slash-jekyll/">

  <style>
   body {
     font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
     max-width: 1200px;
     margin: 0 auto;
     padding: 1rem;
     line-height: 1.5;
   }

   header {
     margin-bottom: 0.5rem;
   }

   header h1 {
     margin: 0;
     font-size: 2.5rem;
   }

   header h1 a {
     color: #333;
     text-decoration: none;
   }

   .main-nav {
     display: flex;
     align-items: center;
     justify-content: space-between;
     padding: 0.5rem 0;
     margin-bottom: 2rem;
   }

   .nav-list {
     display: flex;
     list-style: none;
     margin: 0;
     padding: 0;
     gap: 1.5rem;
   }

   .nav-list a {
     text-decoration: none;
     color: #333;
   }

   .search-form fieldset {
     border: none;
     margin: 0;
     padding: 0;
   }

   .search {
     padding: 0.5rem;
     border: none;
     background: #f5f5f5;
     border-radius: 4px;
   }

   /* Blog post list styling */
   .post-list {
     list-style: none;
     padding: 0;
     margin: 0;
   }

   .post-list li {
     margin-bottom: 1.5rem;
   }

   .post-meta {
     margin-bottom: 0.25rem;
   }

   .post-meta time {
     color: #666;
     margin-right: 0.5rem;
   }

   .post-list h2 {
     display: inline;
     font-size: 1.1rem;
     font-weight: 500;
     margin: 0;
   }

   .post-list h2 a {
     color: #0066cc;
     text-decoration: none;
   }

   .post-list h2 a:hover {
     text-decoration: underline;
   }

   .post-description {
     color: #444;
     margin: 0.25rem 0 0 0;
     line-height: 1.6;
   }

   .right {
     float: right;
   }
   .left {
     float: left;
   }
   .mr1 {
     margin-right: 1em;
   }
   /* Style the footnote references in the text */
   [id^="fnref"] sup {
     font-size: 0.75em;
     line-height: 0;
     position: relative;
     top: -0.5em;
     padding: 0 0.3em;
   }

   [id^="fnref"] a {
     text-decoration: none;
     background-color: #f3f4f6;
     color: #4b5563;
     border-radius: 3px;
     padding: 2px 6px;
     transition: all 0.2s ease;
   }

   [id^="fnref"] a:hover {
     background-color: #e5e7eb;
     color: #1f2937;
   }

   /* Style the footnotes section */
   .footnotes {
     margin-top: 3rem;
     padding-top: 2rem;
     border-top: 2px solid #e5e7eb;
   }

   /* Create custom numbering for footnotes */
   .footnotes li {
     margin-bottom: 1rem;
     color: #4b5563;
   }
   
   /* Style the return links in footnotes */
   .footnotes li a[href^="#fnref"] {
     text-decoration: none;
     color: #6b7280;
     margin-left: 0.5rem;
     font-size: 0.875rem;
     transition: color 0.2s ease;
   }

   .footnotes li a[href^="#fnref"]:hover {
     color: #374151;
   }

   blockquote {
     border-left: 4px solid #d1d5db;
     padding-left: 1em;
     margin-left: 1em;
     color: #4b5563;
     font-style: italic;
     background-color: #f9fafb;
   }

   figure {
     margin: 1rem 0;
     text-align: center;
   }

   figcaption {
     color: #666;
     font-size: 0.9em;
     margin-top: 0.5rem;
     font-style: italic;
   }

   .page-header h1 {
     margin: 0
   }

   .page-header .publication-date {
     color: #666;
     font-size: 0.8em;
     margin: 0;
   }

   body > footer {
     font-size: .8em;
	   color: #888;
     margin-top: 1em;
	   padding-top: 1em;
     padding-bottom: 1em;
   }
   p code, li code {
     display: inline-block;
     white-space: nowrap;
     border: 1px solid #ddd;
     -moz-border-radius: .4em;
     -webkit-border-radius: .4em;
     border-radius: .4em;
     padding: 0 .3em;
     margin: -1px 0;
   }

  </style>
  <link rel="stylesheet" href="/highlight/base16/tomorrow-night.min.css">
</head>
<body>
<header>
    <h1><a href="/">Jake McCrary</a></h1>
  </header>
  <nav role="navigation" class="main-nav">
    <ul role="main-navigation" class="nav-list">
      <li><a href="/">Articles</a></li>
      <li><a href="/adventures/">Adventures</a></li>
      <li><a href="/about.html">About</a></li>
      <li><a href="/blog/archives/">Archives</a></li>
      <li><a href="http://feeds.feedburner.com/JakeMccrarysMusings" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
      <li><a href="https://jakemccrary.substack.com/welcome" target="_blank" rel="subscribe-email" title="subscribe via email">Newsletter</a></li>
    </ul>
    <form class="search-form" action="https://google.com/search" method="get">
      <fieldset role="search">
        <input type="hidden" name="sitesearch" value="jakemccrary.com">
        <input class="search" type="text" name="q" placeholder="Search">
      </fieldset>
    </form>
  </nav>
  
  <div class="page-header">
    <h1>Adding a JSON Feed to an Octopress/Jekyll generated site</h1>
    
    
    <p class="publication-date">Published on 
      <time datetime="2017-05-30">May 30, 2017</time>
    </p>
    
  </div>
  

  <p>I went to a coffee shop this last weekend with the intention of writing up a <a href='/blog/2017/05/29/using-comm-to-verify-matching-content/'>quick article</a> on <code>comm</code>. I sat down, sipping my coffee, and wasn’t motivated. I didn’t feel like knocking out a short post, and I didn’t feel like editing a draft I’ve been sitting on for a while. I wanted to do some work though, so I decided to add a <a href='https://jsonfeed.org/'>JSON Feed</a> to this site.</p><p>JSON Feed is an alternative to <a href='https://tools.ietf.org/html/rfc4287'>Atom</a> and <a href='http://cyber.harvard.edu/rss/rss.html'>RSS</a> that uses JSON instead of XML. I figured I could add support for it in less than the time it would take to enjoy my coffee and maybe some readers would find it useful. I’d be shocked if anyone actually finds this useful, but it was a fun little exercise anyway.</p><p>An old version of Octopress (2.something), which uses an old version of Jekyll (2.5.3), generates this site. Despite this, I don’t think the template would need to change much if I moved to a new version. The template below is saved as <a href='https://github.com/jakemcc/jakemccrary.com/blob/00d4b0416ab2591be5702286b735091a3d2e2105/source/feed.json'>source/feed.json</a> in my git repository.</p><pre><code class="language-javascript">---
layout: null
---
{
  &quot;version&quot;: &quot;https://jsonfeed.org/version/1&quot;,
  &quot;title&quot;: {{ site.title | jsonify }},
  &quot;home&#95;page&#95;url&quot;: &quot;{{ site.url }}&quot;,
  &quot;feed&#95;url&quot;: &quot;{{site.url}}/feed.json&quot;,
  &quot;favicon&quot;: &quot;{{ site.url }}/favicon.png&quot;,
  &quot;author&quot; : {
      &quot;url&quot; : &quot;https://twitter.com/jakemcc&quot;,
      &quot;name&quot; : &quot;{{ site.author | strip&#95;html }}&quot;
  },
  &quot;user&#95;comment&quot;: &quot;This feed allows you to read the posts from this site in any feed reader that supports the JSON Feed format. To add this feed to your reader, copy the following URL - {{ site.url }}/feed.json - and add it your reader.&quot;,
  &quot;items&quot;: &#91;{% for post in site.posts limit: 20 %}
    {
      &quot;id&quot;: &quot;{{ site.url }}{{ post.id }}&quot;,
      &quot;url&quot;: &quot;{{ site.url }}{{ post.url }}&quot;,
      &quot;date&#95;published&quot;: &quot;{{ post.date | date&#95;to&#95;xmlschema }}&quot;,
      &quot;title&quot;: {% if site.titlecase %}{{ post.title | titlecase | jsonify }}{% else %}{{ post.title | jsonify }}{% endif %},
      {% if post.description %}&quot;summary&quot;: {{ post.description | jsonify }},{% endif %}
      &quot;content&#95;html&quot;: {{ post.content | expand&#95;urls: site.url | jsonify }},
      &quot;author&quot; : {
        &quot;name&quot; : &quot;{{ site.author | strip&#95;html }}&quot;
      }
    }{% if forloop.last == false %},{% endif %}
    {% endfor %}
  &#93;
}
</code></pre><p>I approached this problem by reading the <a href='https://jsonfeed.org/version/1'>JSON Feed Version 1 spec</a> and cribbing values from the template for my Atom feed. The trickiest part was filling in the <code>&quot;content&#95;html&quot;</code> value. It took me a while to find figure out that <code>jsonify</code> needed to be at the end of <code>{{ post.content | expand&#95;urls: site.url | jsonify }}</code>. That translates the post's HTML content into its JSON representation. You’ll notice that any template expression with <code>jsonify</code> at the end also isn’t wrapped in quotes. This is because <code>jsonify</code> is doing that for me.</p><p>The <code>{% if forloop.last == false %},{% endif %}</code> is also important. Without this, the generated JSON has an extra <code>,</code> after the final element in items. This isn’t valid JSON.</p><p>I caught that by using the command line tool <a href='http://trentm.com/json/'>json</a>. If you ever edit JSON by hand or generate it from a template then you should add this tool to your toolbox. It will prevent you from creating invalid JSON.</p><p>How did I use it? I’d make a change in the <code>feed.json</code> template and generate an output file. Then I’d <code>cat</code> that file to <code>json --validate</code>. When there was an error, I’d see a message like below.</p><pre><code class="language-console">0 &#91;last: 5s&#93; 12:43:47 &#126;/src/jakemcc/blog &#40;master &#42;&#41;
$ cat public/feed.json | json --validate
json: error: input is not JSON: Expected ',' instead of '{' at line 25, column 5:
            {
        ....&#94;
1 &#91;last: 0s&#93; 12:43:49 &#126;/src/jakemcc/blog &#40;master &#42;&#41;
$
</code></pre><p>And there would be zero output on success.</p><pre><code class="language-console">0 &#91;last: 5s&#93; 12:45:25 &#126;/src/jakemcc/blog &#40;master&#41;
$ cat public/feed.json | json --validate
0 &#91;last: 0s&#93; 12:45:30 &#126;/src/jakemcc/blog &#40;master&#41;
$
</code></pre><p>It was pretty straightforward to add a JSON Feed. Was it a good use of my time? <code>¯&amp;#95;&#40;ツ&#41;&#95;/¯</code>. In the process of adding the feed I learned more about Liquid templating and figured out how to embed liquid tags into a blog post. Even adding redundant features can be a useful exercise.</p>
  <script src="/highlight/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>
  <script></script>
  <footer>
    <p xmlns:cc="http://creativecommons.org/ns#" >This work by <a rel="cc:attributionURL dct:creator" property="cc:attributionName" href="https://jakemccrary.com">Jake McCrary</a> is licensed under <a href="https://creativecommons.org/licenses/by-nc/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">CC BY-NC 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1" alt=""></a></p> 
    <a href="/disclosure-policy">Disclosure Policy</a><br/>
  </footer>
</body>
</html>
