<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <title>Comparing Clojure Testing Libraries: Output - Jake McCrary</title>
  <meta name="author" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- <link rel="stylesheet" href="/style.css"> -->

  <meta itemprop="name" content="Comparing Clojure Testing Libraries: Output - Jake McCrary" />
  
  <meta itemprop="description" content="An in-depth comparison of the output of Clojure testing libraries." />
  

  <!-- Twitter Card data -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@jakemcc" />
  <meta name="twitter:title" content="Comparing Clojure Testing Libraries: Output - Jake McCrary" />
  
  <meta name="twitter:description" content="An in-depth comparison of the output of Clojure testing libraries." />
  
  <meta name="twitter:creator" content="@jakemcc" />
  <!-- <meta name="twitter:image" content="" /> -->

  <!-- Open Graph data -->
  <meta property="og:site_name" content="Writing by Jake McCrary" />
  <meta property="og:url" content="https://jakemccrary.com//blog/2014/06/22/comparing-clojure-testing-libraries-output/" />
  <meta property="og:title" content="Comparing Clojure Testing Libraries: Output - Jake McCrary" />
  
  <meta property="og:description" content="An in-depth comparison of the output of Clojure testing libraries." />
  
  <!-- <meta property="og:image" content="" /> -->
  
  <meta property="og:type" content="article" />
  
  
  <!-- maybe rfc blahblahblah it? -->
  <meta property="article:published_time" content="2014-06-22T23:59:59+00:00" />
  

  <link rel="canonical" href="https://jakemccrary.com//blog/2014/06/22/comparing-clojure-testing-libraries-output/">

  <style>
   body {
     font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
     max-width: 1200px;
     margin: 0 auto;
     padding: 1rem;
     line-height: 1.5;
   }

   header {
     margin-bottom: 0.5rem;
   }

   header h1 {
     margin: 0;
     font-size: 2.5rem;
   }

   header h1 a {
     color: #333;
     text-decoration: none;
   }

   .main-nav {
     display: flex;
     align-items: center;
     justify-content: space-between;
     padding: 0.5rem 0;
     margin-bottom: 2rem;
   }

   .nav-list {
     display: flex;
     list-style: none;
     margin: 0;
     padding: 0;
     gap: 1.5rem;
   }

   .nav-list a {
     text-decoration: none;
     color: #333;
   }

   .search-form fieldset {
     border: none;
     margin: 0;
     padding: 0;
   }

   .search {
     padding: 0.5rem;
     border: none;
     background: #f5f5f5;
     border-radius: 4px;
   }

   /* Blog post list styling */
   .post-list {
     list-style: none;
     padding: 0;
     margin: 0;
   }

   .post-list li {
     margin-bottom: 1.5rem;
   }

   .post-meta {
     margin-bottom: 0.25rem;
   }

   .post-meta time {
     color: #666;
     margin-right: 0.5rem;
   }

   .post-list h2 {
     display: inline;
     font-size: 1.1rem;
     font-weight: 500;
     margin: 0;
   }

   .post-list h2 a {
     color: #0066cc;
     text-decoration: none;
   }

   .post-list h2 a:hover {
     text-decoration: underline;
   }

   .post-description {
     color: #444;
     margin: 0.25rem 0 0 0;
     line-height: 1.6;
   }

   .right {
     float: right;
   }
   .left {
     float: left;
   }
   .mr1 {
     margin-right: 1em;
   }
   /* Style the footnote references in the text */
   [id^="fnref"] sup {
     font-size: 0.75em;
     line-height: 0;
     position: relative;
     top: -0.5em;
     padding: 0 0.3em;
   }

   [id^="fnref"] a {
     text-decoration: none;
     background-color: #f3f4f6;
     color: #4b5563;
     border-radius: 3px;
     padding: 2px 6px;
     transition: all 0.2s ease;
   }

   [id^="fnref"] a:hover {
     background-color: #e5e7eb;
     color: #1f2937;
   }

   /* Style the footnotes section */
   .footnotes {
     margin-top: 3rem;
     padding-top: 2rem;
     border-top: 2px solid #e5e7eb;
   }

   /* Create custom numbering for footnotes */
   .footnotes li {
     margin-bottom: 1rem;
     color: #4b5563;
   }
   
   /* Style the return links in footnotes */
   .footnotes li a[href^="#fnref"] {
     text-decoration: none;
     color: #6b7280;
     margin-left: 0.5rem;
     font-size: 0.875rem;
     transition: color 0.2s ease;
   }

   .footnotes li a[href^="#fnref"]:hover {
     color: #374151;
   }

   blockquote {
     border-left: 4px solid #d1d5db;
     padding-left: 1em;
     margin-left: 1em;
     color: #4b5563;
     font-style: italic;
     background-color: #f9fafb;
   }

   figure {
     margin: 1rem 0;
     text-align: center;
   }

   figcaption {
     color: #666;
     font-size: 0.9em;
     margin-top: 0.5rem;
     font-style: italic;
   }

   .page-header h1 {
     margin: 0
   }

   .page-header .publication-date {
     color: #666;
     font-size: 0.8em;
     margin: 0;
   }

   body > footer {
     font-size: .8em;
	   color: #888;
     margin-top: 1em;
	   padding-top: 1em;
     padding-bottom: 1em;
   }
   p code, li code {
     display: inline-block;
     white-space: nowrap;
     border: 1px solid #ddd;
     -moz-border-radius: .4em;
     -webkit-border-radius: .4em;
     border-radius: .4em;
     padding: 0 .3em;
     margin: -1px 0;
   }

  </style>
  <link rel="stylesheet" href="/highlight/base16/tomorrow-night.min.css">
</head>
<body>
<header>
    <h1><a href="/">Jake McCrary</a></h1>
  </header>
  <nav role="navigation" class="main-nav">
    <ul role="main-navigation" class="nav-list">
      <li><a href="/">Articles</a></li>
      <li><a href="/adventures/">Adventures</a></li>
      <li><a href="/about.html">About</a></li>
      <li><a href="/blog/archives/">Archives</a></li>
      <li><a href="http://feeds.feedburner.com/JakeMccrarysMusings" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
      <li><a href="https://jakemccrary.substack.com/welcome" target="_blank" rel="subscribe-email" title="subscribe via email">Newsletter</a></li>
    </ul>
    <form class="search-form" action="https://google.com/search" method="get">
      <fieldset role="search">
        <input type="hidden" name="sitesearch" value="jakemccrary.com">
        <input class="search" type="text" name="q" placeholder="Search">
      </fieldset>
    </form>
  </nav>
  
  <div class="page-header">
    <h1>Comparing Clojure Testing Libraries: Output</h1>
    
    
    <p class="publication-date">Published on 
      <time datetime="2014-06-22">June 22, 2014</time>
    </p>
    
  </div>
  

  <p>I recently became interested in how Clojure testing libraries help you when there is a test failure. This interest resulted in me <a href='https://github.com/jakemcc/clojure-test-bed'>exploring</a> different Clojure testing libraries. I created the same tests using <strong>clojure.test</strong> (with and without <a href='https://github.com/pjstadig/humane-test-output'>humane-test-output</a>), <a href='http://jayfields.com/expectations/'>expectations</a>, <a href='https://github.com/marick/Midje'>Midje</a>, and <a href='http://speclj.com/'>Speclj</a> and looked at the output.</p><p>I ran all of these examples using Leiningen. <strong>Midje</strong>, <strong>Speclj</strong>, and <strong>expectations</strong> color their output but I'm not going to try to reproduce that here. The color added by <strong>Midje</strong> and <strong>expectations</strong> is useful. <strong>Speclj</strong> color hurt its readability. I use a dark colored terminal and <strong>Speclj</strong> colors the line that tells where the failure occurs black. This made it hard to read.</p><p>I'm not going to show what the tests look like for each testing library past the first comparison. How a test in expressed is important but not what I want to focus on in this post.</p><h2>Comparing Strings</h2><p>Going to start off with a basic string comparison. The failing test compares two strings that only differ by one character.</p><h5>clojure.test</h5><p>Most (hopefully all) Clojure programmers should be familiar with <strong>clojure.test</strong>. It is the testing library that is included with Clojure.</p><pre><code class="language-clojure">&#40;ns example.string-test
  &#40;:require &#91;clojure.test :refer :all&#93;&#41;&#41;

&#40;deftest string-comparisons
  &#40;is &#40;= &quot;strings equal&quot; &quot;strings equal&quot;&#41;&#41;
  &#40;is &#40;= &quot;space&quot; &quot;spice&quot;&#41;&#41;&#41;
</code></pre><p>The output below is what you get when the above test runs. Even in this simple example it isn't the easiest to read. It doesn't make it easy to find the expected or actual values.</p><pre><code class="language-console clojure.test output">FAIL in &#40;string-comparisons&#41; &#40;string&#95;test.clj:6&#41;
expected: &#40;= &quot;space&quot; &quot;spice&quot;&#41;
  actual: &#40;not &#40;= &quot;space&quot; &quot;spice&quot;&#41;&#41;
</code></pre><p>Below is the same test but with <strong>humane-test-output</strong> enabled. It is easy to read the output and see the expected and actual value. It even provides a diff between them although in this situation it isn't that useful.</p><pre><code class="language-console clojure.test with humane-test-output">FAIL in &#40;string-comparisons&#41; &#40;string&#95;test.clj:6&#41;
expected: &quot;space&quot;
  actual: &quot;spice&quot;
    diff: - &quot;space&quot;
          + &quot;spice&quot;
</code></pre><h5>expectations</h5><p>Another testing library is Jay Field's <a href='http://jayfields.com/expectations/'>expectations</a>. You can see from the example that it has a fairly minimal syntax.</p><pre><code class="language-clojure">&#40;ns example.string-expectations
  &#40;:require &#91;expectations :refer :all&#93;&#41;&#41;

&#40;expect &quot;strings equal&quot; &quot;strings equal&quot;&#41;
&#40;expect &quot;space&quot; &quot;spice&quot;&#41;
</code></pre><pre><code class="language-console expectations output">failure in &#40;string&#95;expectations.clj:5&#41; : example.string-expectations
&#40;expect &quot;space&quot; &quot;spice&quot;&#41;

           expected: &quot;space&quot;
                was: &quot;spice&quot;

           matches: &quot;sp&quot;
           diverges: &quot;ace&quot;
                  &amp;: &quot;ice&quot;
</code></pre><p>The output from <strong>expectations</strong> is very readable. You can easily pick out the expected and actual values. It also shows you where the string starts to diverge.</p><h5>Speclj</h5><p>Before writing this post I had zero experience with Micah Martin's <a href='http://speclj.com/'>Speclj</a>. Below is my translation of the failing string test and its output.</p><pre><code class="language-clojure">&#40;ns example.string-spec
  &#40;:require &#91;speclj.core :refer :all&#93;&#41;&#41;

&#40;describe &quot;String comparisons&quot;
  &#40;it &quot;have nice error message&quot;
      &#40;should= &quot;space&quot; &quot;spice&quot;&#41;&#41;&#41;
</code></pre><pre><code class="language-console Speclj">9&#41; String comparisons have nice error message
   Expected: &quot;space&quot;
        got: &quot;spice&quot; &#40;using =&#41;
   /Users/jake/src/jakemcc/example/spec/example/string&#95;spec.clj:7
</code></pre><p><strong>Speclj</strong>'s test output above is an improvement over <strong>clojure.test</strong>. You can easily find the expected and actual values. It doesn't provide any help with diagnosing how those values are different.</p><h5>Midje</h5><p>I have a little bit of experience with Brian Marick's <a href='https://github.com/marick/Midje'>Midje</a>. Unlike the other libraries it switches up the assertion syntax. In <strong>Midje</strong> the expected value is on the right side of <code>=&gt;</code>.</p><pre><code class="language-clojure">&#40;ns example.string-test
  &#40;:require &#91;midje.sweet :refer :all&#93;&#41;&#41;

&#40;fact &quot;strings are equal&quot;
  &quot;string is equal&quot; =&gt; &quot;string is equal&quot;&#41;

&#40;fact &quot;strings not equal&quot;
   &quot;spice&quot; =&gt; &quot;space&quot;&#41;
</code></pre><pre><code class="language-console Midje">FAIL &quot;strings not equal&quot; at &#40;string&#95;test.clj:8&#41;
    Expected: &quot;space&quot;
      Actual: &quot;spice&quot;
</code></pre><p><strong>Midje</strong>'s output is similar to <strong>Speclj</strong>'s. You can quickly find the expected and actual values but it doesn't help you spot the difference.</p><h3>String Comparison Winner</h3><p><strong>expectations</strong> wins for best output. You can easily spot the expected and actual values and it also helps you find the difference between the strings.</p><p>The worst output comes from <strong>clojure.test</strong>. It doesn't make it easy to spot the difference or even find the expected and actual values.</p><h2>Comparing Maps</h2><p>For maps I've setup three assertions. The first has an extra key-value pair in the actual value. The second has an extra in the expected value. The final assertion has a different value for the <code>:cheese</code> key. The <strong>clojure.test</strong> example is below.</p><pre><code class="language-clojure">&#40;deftest map-comparisons
  &#40;is &#40;= {:sheep 1} {:cheese 1 :sheep 1}&#41;&#41;
  &#40;is &#40;= {:sheep 1 :cheese 1} {:sheep 1}&#41;&#41;
  &#40;is &#40;= {:sheep 1 :cheese 1} {:sheep 1 :cheese 5}&#41;&#41;&#41;
</code></pre><pre><code class="language-console clojure.test">FAIL in &#40;map-comparisons&#41; &#40;map&#95;test.clj:5&#41;
expected: &#40;= {:sheep 1} {:cheese 1, :sheep 1}&#41;
  actual: &#40;not &#40;= {:sheep 1} {:cheese 1, :sheep 1}&#41;&#41;

FAIL in &#40;map-comparisons&#41; &#40;map&#95;test.clj:6&#41;
expected: &#40;= {:sheep 1, :cheese 1} {:sheep 1}&#41;
  actual: &#40;not &#40;= {:cheese 1, :sheep 1} {:sheep 1}&#41;&#41;

FAIL in &#40;map-comparisons&#41; &#40;map&#95;test.clj:7&#41;
expected: &#40;= {:sheep 1, :cheese 1} {:sheep 1, :cheese 5}&#41;
  actual: &#40;not &#40;= {:cheese 1, :sheep 1} {:cheese 5, :sheep 1}&#41;&#41;
</code></pre><p>Unsurprisingly the default <strong>clojure.test</strong> output for maps suffers from the same problems found in the string comparisons. To find the actual and expected values you need to manually parse the output.</p><pre><code class="language-console clojure.test with humane-test-output">FAIL in &#40;map-comparisons&#41; &#40;map&#95;test.clj:5&#41;
expected: {:sheep 1}
  actual: {:cheese 1, :sheep 1}
    diff: + {:cheese 1}

FAIL in &#40;map-comparisons&#41; &#40;map&#95;test.clj:6&#41;
expected: {:cheese 1, :sheep 1}
  actual: {:sheep 1}
    diff: - {:cheese 1}

FAIL in &#40;map-comparisons&#41; &#40;map&#95;test.clj:7&#41;
expected: {:cheese 1, :sheep 1}
  actual: {:cheese 5, :sheep 1}
    diff: - {:cheese 1}
          + {:cheese 5}
</code></pre><p>Above is the output of using <strong>clojure.test</strong> with <strong>humane-test-output</strong>. It is a big improvement over the default <strong>clojure.test</strong>. You can quickly see the expected and actual values. Unlike with the string assertions the diff view is actually helpful. The diffs do a good job of helping you identify the error.</p><pre><code class="language-console expectations">failure in &#40;map&#95;expectations.clj:6&#41; : example.map-expectations
&#40;expect {:sheep 1} {:sheep 1, :cheese 1}&#41;

           expected: {:sheep 1}
                was: {:cheese 1, :sheep 1}

           in expected, not actual: null
           in actual, not expected: {:cheese 1}

failure in &#40;map&#95;expectations.clj:7&#41; : example.map-expectations
&#40;expect {:sheep 1, :cheese 1} {:sheep 1}&#41;

           expected: {:cheese 1, :sheep 1}
                was: {:sheep 1}

           in expected, not actual: {:cheese 1}
           in actual, not expected: null

failure in &#40;map&#95;expectations.clj:8&#41; : example.map-expectations
&#40;expect {:sheep 1, :cheese 5} {:sheep 1, :cheese 1}&#41;

           expected: {:cheese 5, :sheep 1}
                was: {:cheese 1, :sheep 1}

           in expected, not actual: {:cheese 5}
           in actual, not expected: {:cheese 1}
</code></pre><p><strong>expectations</strong> does a pretty good job helping you as well. As before, you can clearly read the expected and actual values. <strong>expectations</strong> also provides some hint as to what is different between the maps. I find the English descriptions a bit easier to read than <strong>humane-test-output</strong>'s diff view. Still seeing lines like line 7 (`in expected, not actual: null`) is a bit confusing and the output would be improved if it was suppressed.</p><p>I'm just going to lump <strong>Speclj</strong> and <strong>Midje</strong> together. The output for each is below. They both improve over <strong>clojure.test</strong> by making it easy to see the expected and actual value. They both don't do anything beyond that.</p><pre><code class="language-console Speclj">4&#41; map comparisons have nice error messages when extra entries keys present
   Expected: {:sheep 1}
        got: {:cheese 1, :sheep 1} &#40;using =&#41;
   /Users/jake/src/jakemcc/example/spec/example/map&#95;spec.clj:7

5&#41; map comparisons have nice error messages when missing an entry
   Expected: {:cheese 1, :sheep 1}
        got: {:sheep 1} &#40;using =&#41;
   /Users/jake/src/jakemcc/example/spec/example/map&#95;spec.clj:9

6&#41; map comparisons have nice error messages when mismatched values
   Expected: {:cheese 5, :sheep 1}
        got: {:cheese 1, :sheep 1} &#40;using =&#41;
   /Users/jake/src/jakemcc/example/spec/example/map&#95;spec.clj:11
</code></pre><pre><code class="language-console Midje">FAIL &quot;map is missing an entry&quot; at &#40;map&#95;test.clj:5&#41;
    Expected: {:cheese 1, :sheep 1}
      Actual: {:sheep 1}

FAIL &quot;map has an extra entry&quot; at &#40;map&#95;test.clj:8&#41;
    Expected: {:sheep 1}
      Actual: {:cheese 1, :sheep 1}

FAIL &quot;map has a different value&quot; at &#40;map&#95;test.clj:11&#41;
    Expected: {:cheese 5, :sheep 1}
      Actual: {:cheese 1, :sheep 1}
</code></pre><h3>Map Comparison Winner</h3><p>Tie between <strong>humane-test-output</strong> and <strong>expectations</strong>. Both do a good job of helping the reader spot the difference.</p><h2>Comparing Sets</h2><p>Next up are sets. Only two assertions for this section. One with the actual value having an extra member and one test where it is missing a member.</p><pre><code class="language-clojure">&#40;ns example.set-test
  &#40;:require &#91;clojure.test :refer :all&#93;&#41;&#41;

&#40;deftest set-comparisons
  &#40;is &#40;= #{:a :b} #{:a :b :c}&#41;&#41;
  &#40;is &#40;= #{:a :b :c} #{:a :b}&#41;&#41;&#41;
</code></pre><p>First up is the basic <strong>clojure.test</strong> output. It suffers from the same problem it has suffered this entire time. It doesn't make it easy to read the expected and actual values. </p><pre><code class="language-console clojure.test">FAIL in &#40;set-comparisons&#41; &#40;set&#95;test.clj:5&#41;
expected: &#40;= #{:b :a} #{:c :b :a}&#41;
  actual: &#40;not &#40;= #{:b :a} #{:c :b :a}&#41;&#41;

FAIL in &#40;set-comparisons&#41; &#40;set&#95;test.clj:6&#41;
expected: &#40;= #{:c :b :a} #{:b :a}&#41;
  actual: &#40;not &#40;= #{:c :b :a} #{:b :a}&#41;&#41;
</code></pre><p>No surprises with <strong>humane-test-output</strong>. It improves the <strong>clojure.test</strong> output by making it easy to read the expected and actual values. The diff view also helps figure out what is causing the assertion to fail.</p><pre><code class="language-console clojure.test with humane-test-output">FAIL in &#40;set-comparisons&#41; &#40;set&#95;test.clj:5&#41;
expected: #{:b :a}
  actual: #{:c :b :a}
    diff: + #{:c}

FAIL in &#40;set-comparisons&#41; &#40;set&#95;test.clj:6&#41;
expected: #{:c :b :a}
  actual: #{:b :a}
    diff: - #{:c}
</code></pre><p><strong>expectations</strong> once again delivers nice output. It continues to be easy to find the expected and actual values and helps you spot the differences with a diff view.</p><pre><code class="language-console expectations">failure in &#40;set&#95;expectations.clj:4&#41; : example.set-expectations
&#40;expect #{:b :a} #{:c :b :a}&#41;

           expected: #{:b :a}
                was: #{:c :b :a}

           in expected, not actual: null
           in actual, not expected: #{:c}

failure in &#40;set&#95;expectations.clj:5&#41; : example.set-expectations
&#40;expect #{:c :b :a} #{:b :a}&#41;

           expected: #{:c :b :a}
                was: #{:b :a}

           in expected, not actual: #{:c}
           in actual, not expected: null
</code></pre><p><strong>Speclj</strong> and <strong>Midje</strong> both have better output than the basic <strong>clojure.test</strong>.</p><pre><code class="language-console Speclj">7&#41; set comparisons have nice error messages when missing item
   Expected: #{:b :a}
        got: #{:c :b :a} &#40;using =&#41;
   /Users/jake/src/jakemcc/example/spec/example/set&#95;spec.clj:9

8&#41; set comparisons have nice error messages when more items
   Expected: #{:c :b :a}
        got: #{:b :a} &#40;using =&#41;
   /Users/jake/src/jakemcc/example/spec/example/set&#95;spec.clj:11
</code></pre><pre><code class="language-console Midje">FAIL &quot;set is superset of expected&quot; at &#40;set&#95;test.clj:5&#41;
    Expected: #{:a :b}
      Actual: #{:a :b :c}

FAIL &quot;set is subset of expected&quot; at &#40;set&#95;test.clj:8&#41;
    Expected: #{:a :b :c}
      Actual: #{:a :b}
</code></pre><h3>Set Comparison Winner</h3><p>Similar to the winner of the map comparisons I'm going to split the victory between <strong>expectations</strong> and <strong>humane-test-output</strong>.</p><h2>Comparing Lists</h2><p>Next up we compare lists (and lists to vectors). There are three comparisons; one with an extra element, one with same length but a mismatched element, and one comparing a vector and list with drastically different contents.</p><pre><code class="language-clojure">&#40;ns example.seq-test
  &#40;:require &#91;clojure.test :refer :all&#93;&#41;&#41;

&#40;deftest list-comparisons
  &#40;is &#40;= '&#40;1 2 3&#41; '&#40;1 2 3 4&#41;&#41;&#41;
  &#40;is &#40;= '&#40;1 2 4&#41; '&#40;1 2 3&#41;&#41;&#41;
  &#40;is &#40;= '&#40;9 8 7&#41; &#91;1 2 3&#93;&#41;&#41;&#41;
</code></pre><p>First up <strong>clojure.test</strong>. Same issues as with all the previous comparisons.</p><pre><code class="language-console clojure.test">FAIL in &#40;list-comparisons&#41; &#40;seq&#95;test.clj:5&#41;
expected: &#40;= &#40;quote &#40;1 2 3&#41;&#41; &#40;quote &#40;1 2 3 4&#41;&#41;&#41;
  actual: &#40;not &#40;= &#40;1 2 3&#41; &#40;1 2 3 4&#41;&#41;&#41;

FAIL in &#40;list-comparisons&#41; &#40;seq&#95;test.clj:6&#41;
expected: &#40;= &#40;quote &#40;1 2 4&#41;&#41; &#40;quote &#40;1 2 3&#41;&#41;&#41;
  actual: &#40;not &#40;= &#40;1 2 4&#41; &#40;1 2 3&#41;&#41;&#41;

FAIL in &#40;list-comparisons&#41; &#40;seq&#95;test.clj:7&#41;
expected: &#40;= &#40;quote &#40;9 8 7&#41;&#41; &#91;1 2 3&#93;&#41;
  actual: &#40;not &#40;= &#40;9 8 7&#41; &#91;1 2 3&#93;&#41;&#41;
</code></pre><p>Once again <strong>humane-test-output</strong> improves upon <strong>clojure.test</strong>. Only interesting difference from previous comparisons is that the diff view ends up having <code>nil</code> values in it where the elements are the same.</p><pre><code class="language-console clojure.test with humane-test-output">FAIL in &#40;list-comparisons&#41; &#40;seq&#95;test.clj:5&#41;
expected: &#40;1 2 3&#41;
  actual: &#40;1 2 3 4&#41;
    diff: + &#91;nil nil nil 4&#93;

FAIL in &#40;list-comparisons&#41; &#40;seq&#95;test.clj:6&#41;
expected: &#40;1 2 4&#41;
  actual: &#40;1 2 3&#41;
    diff: - &#91;nil nil 4&#93;
          + &#91;nil nil 3&#93;

FAIL in &#40;list-comparisons&#41; &#40;seq&#95;test.clj:7&#41;
expected: &#40;9 8 7&#41;
  actual: &#91;1 2 3&#93;
    diff: - &#91;9 8 7&#93;
          + &#91;1 2 3&#93;
</code></pre><p><strong>expectations</strong> continues to have good output. It tries to help you out as well. You'll notice that it also has <code>nil</code> values inserted where the lists are the same.</p><pre><code class="language-console expectations">failure in &#40;list&#95;expectations.clj:4&#41; : example.list-expectations
&#40;expect '&#40;1 2 3&#41; '&#40;1 2 3 4&#41;&#41;

           expected: &#40;1 2 3&#41;
                was: &#40;1 2 3 4&#41;

           in expected, not actual: null
           in actual, not expected: &#91;nil nil nil 4&#93;
           actual is larger than expected

failure in &#40;list&#95;expectations.clj:5&#41; : example.list-expectations
&#40;expect '&#40;1 2 4&#41; '&#40;1 2 3&#41;&#41;

           expected: &#40;1 2 4&#41;
                was: &#40;1 2 3&#41;

           in expected, not actual: &#91;nil nil 4&#93;
           in actual, not expected: &#91;nil nil 3&#93;

failure in &#40;list&#95;expectations.clj:6&#41; : example.list-expectations
&#40;expect '&#40;9 8 7&#41; &#91;1 2 3&#93;&#41;

           expected: &#40;9 8 7&#41;
                was: &#91;1 2 3&#93;

           in expected, not actual: &#91;9 8 7&#93;
           in actual, not expected: &#91;1 2 3&#93;
</code></pre><p>Unsurprisingly, <strong>Speclj</strong> and <strong>Midje</strong> are better than <strong>clojure.test</strong> but again don't go beyond making easy to find the expected and actual values.</p><pre><code class="language-console Speclj">1&#41; List/vector comparisons when there is an extra element
   Expected: &#40;1 2 3&#41;
        got: &#40;1 2 3 4&#41; &#40;using =&#41;
   /Users/jake/src/jakemcc/example/spec/example/string&#95;spec.clj:7

2&#41; List/vector comparisons when there is a mismatched element
   Expected: &#40;1 2 4&#41;
        got: &#40;1 2 3&#41; &#40;using =&#41;
   /Users/jake/src/jakemcc/example/spec/example/string&#95;spec.clj:9

3&#41; List/vector comparisons when comparing different types
   Expected: &#40;9 8 7&#41;
        got: &#91;1 2 3&#93; &#40;using =&#41;
   /Users/jake/src/jakemcc/example/spec/example/string&#95;spec.clj:11
</code></pre><pre><code class="language-console Midje">FAIL &quot;lists are different sizes&quot; at &#40;seq&#95;test.clj:5&#41;
    Expected: &#40;1 2 3&#41;
      Actual: &#40;1 2 3 4&#41;

FAIL &quot;lists have different entries&quot; at &#40;seq&#95;test.clj:8&#41;
    Expected: &#40;1 2 4&#41;
      Actual: &#40;1 2 3&#41;

FAIL &quot;compare very different list like values&quot; at &#40;seq&#95;test.clj:14&#41;
    Expected: &#40;9 8 7&#41;
      Actual: &#91;1 2 3&#93;
</code></pre><h3>List Comparison Winner</h3><p>I find the <strong>clojure.test</strong> with <strong>humane-test-output</strong> to be a bit easier to read than <strong>expectations</strong>. Both have better output than the basic <strong>clojure.test</strong>, <strong>Speclj</strong>, and <strong>Midje</strong>.</p><h2>Overall Winner</h2><p>If I were picking a testing library based entirely on what a failing test looks like I would use <strong>expectations</strong>. My second pick would be <strong>clojure.test</strong> with <strong>humane-test-output</strong>.</p><p>It is great that Clojure ships with <strong>clojure.test</strong>. It is unfortunate that it does so little to help you read a failing test. Every library I tried has better output than <strong>clojure.test</strong>.</p><h3>Addendum</h3><p><i>Added 2014/06/23</i></p><p>Colin Jones <a href='http://jakemccrary.com/blog/2014/06/22/comparing-clojure-testing-libraries-output/#comment-1449451549'>points out</a> that Speclj provides <code>should==</code>. <code>should==</code> checks that the expected and actual value have the same contents. He provided a <a href='https://gist.github.com/trptcolin/7e1ece5179581085730f'>gist</a> that shows the difference.</p>
  <script src="/highlight/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>
  <script></script>
  <footer>
    <p xmlns:cc="http://creativecommons.org/ns#" >This work by <a rel="cc:attributionURL dct:creator" property="cc:attributionName" href="https://jakemccrary.com">Jake McCrary</a> is licensed under <a href="https://creativecommons.org/licenses/by-nc/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">CC BY-NC 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1" alt=""></a></p> 
    <a href="/disclosure-policy">Disclosure Policy</a><br/>
  </footer>
</body>
</html>
