
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="iem7"><![endif]-->
<!--[if lt IE 9]><html class="lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html lang="en"><!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <title>Jake McCrary</title>
    <meta name="author" content="Jake McCrary">

    
    
    
    

    <meta itemprop="name" content="Jake McCrary" />
    <meta itemprop="description" content=" 2017-08-27: I&rsquo;ve published an updated version here. Leiningen, a Clojure build
tool, has the concept of
profiles.
One thing profiles are useful &hellip;" />

    <!-- Twitter Card data -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@jakemcc" />
    <meta name="twitter:title" content="Jake McCrary" />
    <meta name="twitter:description" content=" 2017-08-27: I&rsquo;ve published an updated version here. Leiningen, a Clojure build
tool, has the concept of
profiles.
One thing profiles are useful &hellip;" />
    <meta name="twitter:creator" content="@jakemcc" />
    <meta name="twitter:image" content="https://jakemccrary.com/images/jake-surprised-eyes-brighter.jpg" />

    <!-- Open Graph data -->
    <meta property="og:site_name" content="The Blog of Jake McCrary" />
    <meta property="og:url" content="https://jakemccrary.com/blog/7/" />
    <meta property="og:title" content="Jake McCrary" />
    <meta property="og:description" content=" 2017-08-27: I&rsquo;ve published an updated version here. Leiningen, a Clojure build
tool, has the concept of
profiles.
One thing profiles are useful &hellip;" />
    <meta property="og:image" content="https://jakemccrary.com/images/jake-surprised-eyes-brighter.jpg" />
    
    

    <meta name="description" content=" 2017-08-27: I&rsquo;ve published an updated version here. Leiningen, a Clojure build
tool, has the concept of
profiles.
One thing profiles are useful &hellip;">

    

    <!-- http://t.co/dKP3o1e -->
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="canonical" href="https://jakemccrary.com/blog/7/">
    <link href="/favicon.png" rel="icon">
    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="http://feeds.feedburner.com/JakeMccrarysMusings" rel="alternate" title="Jake McCrary" type="application/atom+xml">
    <link href="https://jakemccrary.com/feed.json" rel="alternate" title="Jake McCrary" type="application/json">

    <!-- iOS scaling bug fix Rewritten version By @mathias, @cheeaun and @jdalton Source url: https://gist.github.com/901295 -->
    <script type="text/javascript">
     (function(doc) {
       var addEvent = 'addEventListener',
           type = 'gesturestart',
           qsa = 'querySelectorAll',
           scales = [1, 1],
           meta = qsa in doc ? doc[qsa]('meta[name=viewport]') : [];
       function fix() {
         meta.content = 'width=device-width,minimum-scale=' + scales[0] + ',maximum-scale=' + scales[1];
         doc.removeEventListener(type, fix, true);
       }
       if ((meta = meta[meta.length - 1]) && addEvent in doc) {
         fix();
         scales = [0.25, 1.6];
         doc[addEvent](type, fix, true);
       }
     }(document));
    </script>
    
<script>
 var origin = window.location.origin;
 if (!origin) {
   origin = window.location.protocol + '//' + window.location.hostname + (window.location.port ? (':' + window.location.port) : '');
 }
 if (origin.indexOf('localhost') === -1) {
   (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
   })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

   ga('create', 'UA-19834208-2', 'auto');
   ga('send', 'pageview');
 }
</script>


  </head>

<body  >
  <header role="banner"><hgroup>
  <h1><a href="/">Jake McCrary</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul role=main-navigation>
  <li><a href="/">Articles</a></li>
  <li><a href="/adventures/">Adventures</a></li>
  <li><a href="/about.html">About</a></li>
  <li><a href="/blog/archives/">Archives</a></li>
  <li><a href="http://feeds.feedburner.com/JakeMccrarysMusings" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
</ul>

  <form action="https://google.com/search" method="get">
    <fieldset role="search">
      <input type="hidden" name="sitesearch" value="jakemccrary.com">
      <input class="search" type="text" name="q" placeholder="Search"/>
    </fieldset>
  </form>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/01/11/overview-of-my-leiningen-profiles-dot-clj/">Overview of my Leiningen profiles.clj</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-01-11T22:12:00-06:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>11</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>10:12 pm</span></time>
      </p>
    
  </header>


  <div class="entry-content"><p><strong>2017-08-27: I&rsquo;ve published an updated version <a href="/blog/2017/08/27/my-current-leiningen-profiles-dot-clj/">here</a>.</strong></p>

<p><a href="https://github.com/technomancy/leiningen">Leiningen</a>, a Clojure build
tool, has the concept of
<a href="https://github.com/technomancy/leiningen/blob/master/doc/PROFILES.md">profiles</a>.
One thing profiles are useful for is allowing you to have development
tools available to a project without having them as dependencies when
you release your project. An example of when you might want to do this
is when you are using a testing library like
<a href="https://github.com/jaycfields/expectations">expectations</a>.</p>

<p>Some development tools, such as
<a href="https://github.com/jakemcc/lein-test-refresh">lein-test-refresh</a>, are
useful to have across most of your Clojure projects. Rather nicely,
Leiningen supports adding global profiles to <code>~/.lein/profiles.clj</code>.
These profiles are available in all your projects.</p>

<p>Below is most of my <code>profiles.clj</code>. I&rsquo;ve removed some sensitive
settings and what is left are the development tools that I find
useful.</p>

<figure class='code'><figcaption><span>Entire :user profile</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">{</span><span class="ss">:user</span> <span class="p">{</span><span class="ss">:plugin-repositories</span> <span class="p">[[</span><span class="s">&quot;private-plugins&quot;</span> <span class="p">{</span><span class="ss">:url</span> <span class="s">&quot;private repo url&quot;</span><span class="p">}]]</span>
</span><span class='line'>        <span class="ss">:dependencies</span> <span class="p">[[</span><span class="nv">pjstadig/humane-test-output</span> <span class="s">&quot;0.6.0&quot;</span><span class="p">]]</span>
</span><span class='line'>        <span class="ss">:injections</span> <span class="p">[(</span><span class="nf">require</span> <span class="ss">&#39;pjstadig.humane-test-output</span><span class="p">)</span>
</span><span class='line'>                     <span class="p">(</span><span class="nf">pjstadig.humane-test-output/activate!</span><span class="p">)]</span>
</span><span class='line'>        <span class="ss">:plugins</span> <span class="p">[[</span><span class="nv">cider/cider-nrepl</span> <span class="s">&quot;0.8.2&quot;</span><span class="p">]</span>
</span><span class='line'>                  <span class="p">[</span><span class="nv">refactor-nrepl</span> <span class="s">&quot;0.2.2&quot;</span><span class="p">]</span>
</span><span class='line'>                  <span class="p">[</span><span class="nv">com.jakemccrary/lein-test-refresh</span> <span class="s">&quot;0.5.5&quot;</span><span class="p">]</span>
</span><span class='line'>                  <span class="p">[</span><span class="nv">lein-autoexpect</span> <span class="s">&quot;1.4.2&quot;</span><span class="p">]</span>
</span><span class='line'>                  <span class="p">[</span><span class="nv">lein-ancient</span> <span class="s">&quot;0.5.5&quot;</span><span class="p">]</span>
</span><span class='line'>                  <span class="p">[</span><span class="nv">jonase/eastwood</span> <span class="s">&quot;0.2.1&quot;</span><span class="p">]</span>
</span><span class='line'>                  <span class="p">[</span><span class="nv">lein-kibit</span> <span class="s">&quot;0.0.8&quot;</span><span class="p">]</span>
</span><span class='line'>                  <span class="p">[</span><span class="nv">lein-pprint</span> <span class="s">&quot;1.1.2&quot;</span><span class="p">]]</span>
</span><span class='line'>        <span class="ss">:test-refresh</span> <span class="p">{</span><span class="ss">:notify-command</span> <span class="p">[</span><span class="s">&quot;terminal-notifier&quot;</span> <span class="s">&quot;-title&quot;</span> <span class="s">&quot;Tests&quot;</span> <span class="s">&quot;-message&quot;</span><span class="p">]}}}</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>:plugin-repositories [["private-plugins" {:url "private repo url"}]]</code>
sets a private plugin repository. This allows me to use
<a href="http://outpace.com/">Outpace&rsquo;s</a> private Leiningen templates for
setting up new projects for work.</p>

<p>The next few lines are all related. They setup
<a href="https://github.com/pjstadig/humane-test-output">humane-test-output</a>.
<code>humane-test-output</code> makes <code>clojure.test</code> output more readable. It
makes using <code>clojure.test</code> much more enjoyable. I highly recommend it.
Sample output can be found in my
<a href="/blog/2014/06/22/comparing-clojure-testing-libraries-output/">Comparing Clojure Testing Libraries</a>
post.</p>

<figure class='code'><figcaption><span>humane-test-output setup in the :user profile</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="ss">:dependencies</span> <span class="p">[[</span><span class="nv">pjstadig/humane-test-output</span> <span class="s">&quot;0.6.0&quot;</span><span class="p">]]</span>
</span><span class='line'><span class="ss">:injections</span> <span class="p">[(</span><span class="nf">require</span> <span class="ss">&#39;pjstadig.humane-test-output</span><span class="p">)</span>
</span><span class='line'>             <span class="p">(</span><span class="nf">pjstadig.humane-test-output/activate!</span><span class="p">)]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Next we get to my <code>:plugins</code> section. This is the bulk of
my <code>profiles.clj</code>.</p>

<figure class='code'><figcaption><span>:plugins section of my :user profile</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="ss">:plugins</span> <span class="p">[[</span><span class="nv">cider/cider-nrepl</span> <span class="s">&quot;0.8.2&quot;</span><span class="p">]</span>
</span><span class='line'>          <span class="p">[</span><span class="nv">refactor-nrepl</span> <span class="s">&quot;0.2.2&quot;</span><span class="p">]</span>
</span><span class='line'>          <span class="p">[</span><span class="nv">com.jakemccrary/lein-test-refresh</span> <span class="s">&quot;0.5.5&quot;</span><span class="p">]</span>
</span><span class='line'>          <span class="p">[</span><span class="nv">lein-autoexpect</span> <span class="s">&quot;1.4.2&quot;</span><span class="p">]</span>
</span><span class='line'>          <span class="p">[</span><span class="nv">lein-ancient</span> <span class="s">&quot;0.5.5&quot;</span><span class="p">]</span>
</span><span class='line'>          <span class="p">[</span><span class="nv">jonase/eastwood</span> <span class="s">&quot;0.2.1&quot;</span><span class="p">]</span>
</span><span class='line'>          <span class="p">[</span><span class="nv">lein-kibit</span> <span class="s">&quot;0.0.8&quot;</span><span class="p">]</span>
</span><span class='line'>          <span class="p">[</span><span class="nv">lein-pprint</span> <span class="s">&quot;1.1.2&quot;</span><span class="p">]]</span>
</span></code></pre></td></tr></table></div></figure>


<p>The first entry is for <code>cider/cider-nrepl</code>. I write Clojure using
Emacs and <a href="https://github.com/clojure-emacs/cider">CIDER</a> and much of
CIDER&rsquo;s functionality exists in nrepl middleware found in
<code>cider/cider-nrepl</code>. This dependency is required for me to be
effective while writing Clojure.</p>

<p><code>refactor-nrepl</code> is next.
<a href="https://github.com/clojure-emacs/clj-refactor.el">clj-refactor.el</a>
requires it for some refactorings. I actually don&rsquo;t use any of those
refactorings (I only use move to let, extract to let, and
introduce let refactorings) but I still keep it around.</p>

<p><code>com.jakemccrary/lein-test-refresh</code> is next. This lets me use
<a href="https://github.com/jakemcc/lein-test-refresh">lein-test-refresh</a>
globally. <code>lein-test-refresh</code> runs your <code>clojure.test</code> tests whenever
a file changes in your project. This is another key development tool
in my process.</p>

<p>Up next is <code>lein-autoexpect</code>. It was the first Leiningen plugin I
wrote and it enables continuous testing with
<a href="https://github.com/jaycfields/expectations">expectations</a>.</p>

<p>Both <code>lein-autoexpect</code> and <code>lein-test-refresh</code> are projects I created
and maintain. Writing <code>lein-autoexpect</code> was my first
exposure to continuous testing and it changed how I develop code. I
find it frustrating to develop without such a tool.</p>

<p>Next up is <a href="https://github.com/xsc/lein-ancient">lein-ancient</a>. It
checks your project.clj for outdated dependencies and plugins. It
isn&rsquo;t something that gets used every day but it is super useful when
you need it.</p>

<p>The next two entries are for
<a href="https://github.com/jonase/eastwood">jonase/eastwood</a> and
<a href="https://github.com/jonase/kibit">lein-kibit</a>. They are both tools
that look at your Clojure code and report common mistakes. I don&rsquo;t use
either consistently but I do find them useful. I&rsquo;ve found bugs with eastwood.</p>

<p>The final plugin is <code>lein-pprint</code>.
<a href="https://github.com/technomancy/leiningen/tree/master/lein-pprint">lein-pprint</a>
prints out your project map. It is useful for trying to grasp what is
going on when messing around with various Leiningen options.</p>

<p>The final part, seen below, of my <code>profiles.clj</code> is configuration for
<code>lein-test-refresh.</code> It configures <code>lein-test-refresh</code> to use
<a href="https://github.com/alloy/terminal-notifier">terminal-notifier</a> to
notify me when my tests pass or fail. Using a continuous tester that
allows flexible notification is useful. Not having to glance at a
terminal to see if your tests are passing or failing is great.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="ss">:test-refresh</span> <span class="p">{</span><span class="ss">:notify-command</span> <span class="p">[</span><span class="s">&quot;terminal-notifier&quot;</span> <span class="s">&quot;-title&quot;</span> <span class="s">&quot;Tests&quot;</span> <span class="s">&quot;-message&quot;</span><span class="p">]}</span>
</span></code></pre></td></tr></table></div></figure>


<p>That is my <code>~/.lein/profiles.clj</code>. I don&rsquo;t think it contains anything
mind blowing but it definitely contains a useful collection of Clojure
development tools. I encourage you to check out them out and to think
about what tools you should be putting into your global <code>:user</code>
profile.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/01/08/reading-in-2014/">Reading in 2014</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-01-08T22:59:00-06:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>8</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>10:59 pm</span></time>
      </p>
    
  </header>


  <div class="entry-content"><p>At the beginning of last year I took some time and
<a href="http://jakemccrary.com/blog/2014/01/01/using-incanter-to-review-my-2013-reading/">reviewed</a>
my 2013 reading using Clojure and Incanter to generate some stats. It
was a useful exercise to reflect back on my reading and play around
with Incanter again.</p>

<p>Over the last couple of weeks I&rsquo;ve taken a similar look at my
2014 reading. The rest of this post highlights some of the top books
from the previous year and then posts some numbers at the end.</p>

<p>I review every book I read using
<a href="https://www.goodreads.com/">Goodreads</a>. If you want to see more of
what I&rsquo;ve been reading you can find me
<a href="https://www.goodreads.com/user/show/3431614-jake-mccrary">here</a>. I
track and review every book I read and have found this practice to be
extremely rewarding.</p>

<h3>2014 Goals</h3>

<p>I entered 2014 without a volume goal. Unlike 2013, I didn&rsquo;t have a
page or book count goal. I entered 2014 with the desire to reread two
specific books and the nebulous goal of reading more non-fiction.</p>

<h3>2014 Results</h3>

<p>I ended up setting a new volume record. I read 69 books for a total of
almost 23,000 pages. I also read every week of
<a href="http://www.amazon.com/gp/product/B00FDWVIHO/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=B00FDWVIHO&amp;linkCode=as2&amp;tag=jakemccrary08-20&amp;linkId=S6TWD3DEAED3EDBF">Day One</a>,
a weekly literary journal containing one short story and one poem from
new authors. This doesn&rsquo;t count towards my page or book count but is
reading I enjoy. It exposes me to many different styles.</p>

<p>More than a third of my reading was non-fiction. I don&rsquo;t
have numbers for 2013 but that feels like an increase. I consider my
goal of reading more non-fiction achieved.</p>

<p>I also reread the two books I had planned on rereading. I wanted to
reread
<a href="http://www.amazon.com/gp/product/B000S1M9LY/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=B000S1M9LY&amp;linkCode=as2&amp;tag=jakemccrary08-20&amp;linkId=XEJIFRILDRUSJXWG">Infinite Jest</a>
and
<a href="http://www.amazon.com/Hard-Boiled-Wonderland-World-Haruki-Murakami-ebook/dp/B004AP9W1O/ref=sr_1_1?ie=UTF8&amp;qid=1420159468&amp;sr=8-1&amp;keywords=a+hard+boiled+wonderland">Hard-Boiled Wonderland and the End of the World</a>
and succeeded in rereading both of them.</p>

<h3>Recommendations</h3>

<p>I awarded seven books a five out of five star rating. I&rsquo;ve listed them
below in (in no particular order). Each book I&rsquo;d recommend without
hesitation. Instead of reworking or copying my previous reviews I&rsquo;ve
provided links to Goodreads. The titles link to Amazon.</p>

<ul>
<li><a href="http://www.amazon.com/gp/product/B00QS2HXUO/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=B00QS2HXUO&amp;linkCode=as2&amp;tag=jakemccrary08-20&amp;linkId=RWTY2PCQBTCXMLOK">Working Effectively with Unit Tests</a> by Jay Fields (<a href="https://www.goodreads.com/review/show/984963558">my review</a>)</li>
<li><a href="http://www.amazon.com/gp/product/B004J35LHQ/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=B004J35LHQ&amp;linkCode=as2&amp;tag=jakemccrary08-20&amp;linkId=FP26VU2OR4JMMDOZ">The Secrets of Consulting</a> by Gerald Weinberg (<a href="https://www.goodreads.com/review/show/519452572">my review</a>)</li>
<li><a href="http://www.amazon.com/gp/product/B00N1ZN6C0/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=B00N1ZN6C0&amp;linkCode=as2&amp;tag=jakemccrary08-20&amp;linkId=LW3CLVNSZMRLBDVW">Extreme Programming Explained</a> by Kent Beck (<a href="https://www.goodreads.com/review/show/1119479193">my review</a>)</li>
<li><a href="http://www.amazon.com/gp/product/B000FC1JAI/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=B000FC1JAI&amp;linkCode=as2&amp;tag=jakemccrary08-20&amp;linkId=5TFM37LOXWLSBMUD">Meditations</a> by Marcus Aurelious and translated by Gregory Hays (<a href="https://www.goodreads.com/review/show/998010207">my review</a>)</li>
<li><a href="http://www.amazon.com/gp/product/B000QUELZ4/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=B000QUELZ4&amp;linkCode=as2&amp;tag=jakemccrary08-20&amp;linkId=56W5DEBPW3LU6XZX">A Man Without a Country</a> by Kurt Vonnegut (<a href="https://www.goodreads.com/review/show/93929432">my review</a>)</li>
<li><a href="http://www.amazon.com/gp/product/B000S1M9LY/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=B000S1M9LY&amp;linkCode=as2&amp;tag=jakemccrary08-20&amp;linkId=XEJIFRILDRUSJXWG">Infinite Jest</a> by David Foster Wallace (<a href="https://www.goodreads.com/review/show/509610965">my first review</a>, <a href="https://www.goodreads.com/review/show/880349659">second review</a>)</li>
<li><a href="http://www.amazon.com/gp/product/B00IHMF9KE/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=B00IHMF9KE&amp;linkCode=as2&amp;tag=jakemccrary08-20&amp;linkId=WPOULKSHDQDXKMLZ">The Bone Clocks</a> by David Mitchell (<a href="https://www.goodreads.com/review/show/1030027657">my review</a>)</li>
</ul>


<p>I&rsquo;m recommending a specific translation of <em>Meditations</em>. I attempted
to read different one first and it was so painful to read I ended up
giving up. The linked translation is modern and contains a useful
forward giving you background information on the time.</p>

<p>I only read one series this year but it was a good one.
<a href="http://www.amazon.com/gp/bookseries/B00HUQBPWE/kindle/?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;linkCode=ur2&amp;tag=jakemccrary08-20&amp;linkId=ABX4JPELH5GKERZP">The Magicians</a>,
by Lev Grossman, was recommended by a friend who described it as
&ldquo;Harry Potter but with characters battling depression.&rdquo; I&rsquo;m not sure
that fully captures the feel of the series but it is a start. The
series introduces you to a world like our own but with magic. You
follow cynical, self-absorbed students as they attend school,
graduate, and grow up living in both the magical and non-magical
world. The first book in the series is the weakest so if you read that
and find it enjoyable you should definitely pick up the next two
books.</p>

<h3>2015 Goals</h3>

<p>2015 isn&rsquo;t going to have an easily measured goal. I don&rsquo;t feel the
need to set number of books or pages goals any more. I&rsquo;m hoping to
increase the quality of my reading. This is a pretty unclear goal. To
me this doesn&rsquo;t mean increasing the average rating of books I read but
instead I want to get more out of what I read. I want to think a bit
deeper about the subjects I&rsquo;m reading.</p>

<h3>2014 Measurements</h3>

<p>Below are some random measurements that are probably only interesting
to me.</p>

<p>This year I recorded the format of the books I read. This was the year
of the ebook; over 90% of the books I read were electronic. I&rsquo;d guess
that this is a higher percentage of ebooks than previous years. I wish
I had recorded the formats read in previous years.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>| Binding   | Number of books |
</span><span class='line'>|-----------+-----------------|
</span><span class='line'>| Hardcover |               1 |
</span><span class='line'>| Paperback |               4 |
</span><span class='line'>| Kindle    |              64 |</span></code></pre></td></tr></table></div></figure>


<p>My average rating has been going down over the last four years.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>| Year | Average Rating |
</span><span class='line'>|------+----------------|
</span><span class='line'>| 2011 | 3.84           |
</span><span class='line'>| 2012 | 3.66           |
</span><span class='line'>| 2013 | 3.67           |
</span><span class='line'>| 2014 | 3.48           |</span></code></pre></td></tr></table></div></figure>


<p>In 2014, three authors composed nearly 25% of my reading (by page count). The
top six authors by page count are below.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>| Author               | My Average Rating | Number of Books | Number of Pages | Percent of Total Page Count |
</span><span class='line'>|----------------------+-------------------+-----------------+-----------------+-----------------------------|
</span><span class='line'>| David Mitchell       |                 4 |               5 |            2334 |                      10.19% |
</span><span class='line'>| David Foster Wallace |       4.333333333 |               3 |            1753 |                       7.65% |
</span><span class='line'>| Lev Grossman         |       3.666666667 |               3 |            1244 |                       5.43% |
</span><span class='line'>| Marisha Pessl        |               3.5 |               2 |            1153 |                       5.03% |
</span><span class='line'>| Haruki Murakami      |               3.5 |               2 |             768 |                       3.35% |
</span><span class='line'>| Cormac McCarthy      |               3.5 |               2 |             650 |                       2.84% |</span></code></pre></td></tr></table></div></figure>


<p>My top six authors by average rating (with ties broken by number of
books) are below.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>| Author               | My Average Rating | Number of Books | Number of Pages | Percent of Total Page Count |
</span><span class='line'>|----------------------+-------------------+-----------------+-----------------+-----------------------------|
</span><span class='line'>| Gerald M. Weinberg   |                 5 |               1 |             228 |                       1.00% |
</span><span class='line'>| Kent Beck            |                 5 |               1 |             224 |                       0.98% |
</span><span class='line'>| Jay Fields           |                 5 |               1 |             204 |                       0.89% |
</span><span class='line'>| Kurt Vonnegut        |               4.5 |               2 |             377 |                       1.65% |
</span><span class='line'>| David Foster Wallace |       4.333333333 |               3 |            1753 |                       7.65% |
</span><span class='line'>| David Mitchell       |                 4 |               5 |            2334 |                      10.19% |</span></code></pre></td></tr></table></div></figure>


<p>I did top six for both of these because otherwise David Mitchell would
not have been in the second one. I&rsquo;ve devoured his writing in the last
year and a half for a reason. I&rsquo;m consistently rating his books
highly.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/12/21/restricting-access-to-certain-routes/">Restricting access to certain routes</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-12-21T16:48:00-06:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2014</span></span> <span class='time'>4:48 pm</span></time>
      </p>
    
  </header>


  <div class="entry-content"><p>Recently I&rsquo;ve been working on adding authentication and authorization
to a Clojure web service. The project uses
<a href="https://github.com/weavejester/compojure">compojure</a> for routing and
<a href="https://github.com/cemerick/friend">friend</a> for authentication and
authorization. My pair and I wanted to restrict access to specific
routes while leaving some routes completely public. It took a few
tries until we figured out how to do this in a way that made us happy.</p>

<p>The rest of this post shows the approximate path we took to our
current solution. It focuses on using friend to restrict access to
specific routes. It does not go into details about adding
authentication to your web service.</p>

<p>Below is an example of the routes before adding authorization checks.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">ns </span><span class="nv">example.server</span>
</span><span class='line'>  <span class="p">(</span><span class="ss">:require</span> <span class="p">[</span><span class="nv">compojure.core</span> <span class="ss">:refer</span> <span class="p">[</span><span class="nv">GET</span> <span class="nv">defroutes</span><span class="p">]</span> <span class="ss">:as</span> <span class="nv">compojure</span><span class="p">]</span>
</span><span class='line'>            <span class="p">[</span><span class="nv">compojure.route</span> <span class="ss">:as</span> <span class="nv">route</span><span class="p">]))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">defroutes</span> <span class="nv">app</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">GET</span> <span class="s">&quot;/status&quot;</span> <span class="nv">_</span> <span class="p">(</span><span class="nf">status</span><span class="p">))</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">GET</span> <span class="s">&quot;/cars&quot;</span> <span class="nv">_</span> <span class="p">(</span><span class="nf">fetch-cars</span><span class="p">))</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">GET</span> <span class="s">&quot;/attributes&quot;</span> <span class="nv">_</span> <span class="p">(</span><span class="nf">fetch-attributes</span><span class="p">))</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">GET</span> <span class="s">&quot;/drivers&quot;</span> <span class="nv">_</span> <span class="p">(</span><span class="nf">fetch-drivers</span><span class="p">))</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">route/not-found</span> <span class="s">&quot;NOT FOUND&quot;</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>We wanted to make <code>/cars</code>, <code>/attributes</code>, and <code>/drivers</code> require that
the request satisfies the <code>:example.server/user</code> role. Requesting
<code>/status</code> should not require authorization. The first attempt left us
with the following code.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">ns </span><span class="nv">example.server</span>
</span><span class='line'>  <span class="p">(</span><span class="ss">:require</span> <span class="p">[</span><span class="nv">compojure.core</span> <span class="ss">:refer</span> <span class="p">[</span><span class="nv">GET</span> <span class="nv">defroutes</span><span class="p">]</span> <span class="ss">:as</span> <span class="nv">compojure</span><span class="p">]</span>
</span><span class='line'>            <span class="p">[</span><span class="nv">compojure.route</span> <span class="ss">:as</span> <span class="nv">route</span><span class="p">]</span>
</span><span class='line'>            <span class="p">[</span><span class="nv">cemerick.friend</span> <span class="ss">:as</span> <span class="nv">friend</span><span class="p">]))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">defroutes</span> <span class="nv">app</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">GET</span> <span class="s">&quot;/status&quot;</span> <span class="nv">_</span> <span class="p">(</span><span class="nf">status</span><span class="p">))</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">GET</span> <span class="s">&quot;/cars&quot;</span> <span class="nv">_</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">friend/authorize</span> <span class="o">#</span><span class="p">{</span><span class="ss">::user</span><span class="p">}</span>
</span><span class='line'>                         <span class="p">(</span><span class="nf">fetch-cars</span><span class="p">)))</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">GET</span> <span class="s">&quot;/attributes&quot;</span> <span class="nv">_</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">friend/authorize</span> <span class="o">#</span><span class="p">{</span><span class="ss">::user</span><span class="p">}</span>
</span><span class='line'>                         <span class="p">(</span><span class="nf">fetch-attributes</span><span class="p">)))</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">GET</span> <span class="s">&quot;/drivers&quot;</span> <span class="nv">_</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">friend/authorize</span> <span class="o">#</span><span class="p">{</span><span class="ss">::user</span><span class="p">}</span>
</span><span class='line'>                         <span class="p">(</span><span class="nf">fetch-drivers</span><span class="p">)))</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">route/not-found</span> <span class="s">&quot;NOT FOUND&quot;</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>The above works but it suffers from repetition. You could write a
macro to minimize the repetition but we thought there must be a better
way.</p>

<p>After reading more of <a href="https://github.com/cemerick/friend">friend</a>&rsquo;s
documentation we discovered <code>friend/wrap-authorize</code>. This is
middleware that only allows requests through if the request
satisfies the required roles. Our first pass at using
<code>friend/wrap-authorize</code> looked like the following example.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">ns </span><span class="nv">example.server</span>
</span><span class='line'>  <span class="p">(</span><span class="ss">:require</span> <span class="p">[</span><span class="nv">compojure.core</span> <span class="ss">:refer</span> <span class="p">[</span><span class="nv">GET</span> <span class="nv">defroutes</span><span class="p">]</span> <span class="ss">:as</span> <span class="nv">compojure</span><span class="p">]</span>
</span><span class='line'>            <span class="p">[</span><span class="nv">compojure.route</span> <span class="ss">:as</span> <span class="nv">route</span><span class="p">]</span>
</span><span class='line'>            <span class="p">[</span><span class="nv">cemerick.friend</span> <span class="ss">:as</span> <span class="nv">friend</span><span class="p">]))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">defroutes</span> <span class="nv">protected-routes</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">GET</span> <span class="s">&quot;/cars&quot;</span> <span class="nv">_</span> <span class="p">(</span><span class="nf">fetch-cars</span><span class="p">))</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">GET</span> <span class="s">&quot;/attributes&quot;</span> <span class="nv">_</span> <span class="p">(</span><span class="nf">fetch-attributes</span><span class="p">))</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">GET</span> <span class="s">&quot;/drivers&quot;</span> <span class="nv">_</span> <span class="p">(</span><span class="nf">fetch-drivers</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">defroutes</span> <span class="nv">app</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">GET</span> <span class="s">&quot;/status&quot;</span> <span class="nv">_</span> <span class="p">(</span><span class="nf">status</span><span class="p">))</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">friend/wrap-authorize</span> <span class="nv">protected-routes</span> <span class="o">#</span><span class="p">{</span><span class="ss">::user</span><span class="p">})</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">route/not-found</span> <span class="s">&quot;NOT FOUND&quot;</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>This is much nicer. The repetition is removed by extracting routes
that require authorization into a separate <code>defroutes</code> and wrapping it
with <code>friend/wrap-authorize</code>.</p>

<p>This introduces a subtle bug. A response with status code 404 is no
longer returned if a non-existent resource is requested and the
request is unauthorized. This is because the authorization check
happens <em>before</em> matching a route. friend&rsquo;s documentation warns
against this and suggests using <code>compojure/context</code> to scope usage of
<code>friend/wrap-authorize</code>. This doesn&rsquo;t solve the problem but it at
least narrows its scope. We can do better.</p>

<p>Compojure
<a href="https://github.com/weavejester/compojure/blob/master/HISTORY.md">1.2.0</a>
introduced the function <code>wrap-routes</code>. <code>wrap-routes</code> applies
middleware <em>after</em> a route is matched. By using this we can have all
of the benefits of using <code>friend/wrap-authorize</code> without breaking
returning 404 responses.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">ns </span><span class="nv">example.server</span>
</span><span class='line'>  <span class="p">(</span><span class="ss">:require</span> <span class="p">[</span><span class="nv">compojure.core</span> <span class="ss">:refer</span> <span class="p">[</span><span class="nv">GET</span> <span class="nv">defroutes</span><span class="p">]</span> <span class="ss">:as</span> <span class="nv">compojure</span><span class="p">]</span>
</span><span class='line'>            <span class="p">[</span><span class="nv">compojure.route</span> <span class="ss">:as</span> <span class="nv">route</span><span class="p">]</span>
</span><span class='line'>            <span class="p">[</span><span class="nv">cemerick.friend</span> <span class="ss">:as</span> <span class="nv">friend</span><span class="p">]))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">defroutes</span> <span class="nv">protected-routes</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">GET</span> <span class="s">&quot;/cars&quot;</span> <span class="nv">_</span> <span class="p">(</span><span class="nf">fetch-cars</span><span class="p">))</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">GET</span> <span class="s">&quot;/attributes&quot;</span> <span class="nv">_</span> <span class="p">(</span><span class="nf">fetch-attributes</span><span class="p">))</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">GET</span> <span class="s">&quot;/drivers&quot;</span> <span class="nv">_</span> <span class="p">(</span><span class="nf">fetch-drivers</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">defroutes</span> <span class="nv">app</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">GET</span> <span class="s">&quot;/status&quot;</span> <span class="nv">_</span> <span class="p">(</span><span class="nf">status</span><span class="p">))</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">compojure/wrap-routes</span> <span class="nv">protected-routes</span>
</span><span class='line'>                         <span class="nv">friend/wrap-authorize</span>
</span><span class='line'>                         <span class="o">#</span><span class="p">{</span><span class="ss">::user</span><span class="p">})</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">route/not-found</span> <span class="s">&quot;NOT FOUND&quot;</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>There we have it. A solution without duplication that still responds
properly to requests for non-existent resources.
<code>compojure/wrap-routes</code> is a useful function to know about.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/12/09/an-effective-code-review-process/">An Effective Code Review Process</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-12-09T20:44:00-06:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>9</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>8:44 pm</span></time>
      </p>
    
  </header>


  <div class="entry-content"><p><a href="https://twitter.com/searls/status/540603801955471360"><img class="center" src="/images/justin-searls-code-reviews-harmful.png" title="The way most organizations implement code reviews in teams is usually more harmful than helpful. I generally recommend going without them. - Justin Searls" ></a></p>

<p>The above was tweeted <sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup> recently and it resulted in some decent
discussion about code reviews. In the past six months at
<a href="http://www.outpace.com">Outpace</a>, I&rsquo;ve been part of a handful of code
review sessions that have been extremely productive. After the reviews
many developers have expressed shock at the effectiveness of the process.
A tweet-sized overview of the process we&rsquo;ve followed can be found in
<a href="https://twitter.com/gigasquid">Carin Meier</a>&rsquo;s
<a href="https://twitter.com/gigasquid/status/540606002547425281">responses</a> to
the above tweet. Since you can&rsquo;t fit details into tweets the rest of
this post expands on our code review process.</p>

<p>Some background before we dive into the details.
<a href="http://www.outpace.com">Outpace</a> is a software company that
practices, despite every programmer working remotely, nearly 100% pair
programming. In addition, the team Carin and I are on do most of our
work through GitHub pull requests. Before merging with master, the
pull requests are reviewed by other teammates. Between pairing and
pull requests many eyes see every line of code as changes are made.</p>

<p>Even with all this, we&rsquo;ve found value in having more traditional code
reviews. We&rsquo;ve found that different feedback and action items emerge
from reviewing code that we already have than from reviews of code
changes (e.g., pull requests).</p>

<p>In addition to working for the team described above, the process below
has been successfully used to review an internal library where the
reviewers where mostly interested users with a couple contributors. It
has also been successful on teams that were not adherent to doing work
through reviewed pull requests.</p>

<h3>The Code Review Process</h3>

<h4>Step 1: Select the code to review</h4>

<p>Typically we do this between a week and two weeks before the code
review. Here we identify the code we want to review and create a
two-hour meeting on a Friday at the end of day.</p>

<p>Having the meeting late on Friday helps create a relaxed environment.
The review becomes a time to unwind, enjoy a beverage of choice, and
talk about code. I haven&rsquo;t met a developer that doesn&rsquo;t enjoy
discussing how to make code better and this lets everyone finish the
week doing just that. The code review becomes an uplifting way to
finish a week.</p>

<h4>Step 2: Open the code review</h4>

<p>A few days (typically late Tuesday or early Wednesday) before the
Friday code review meeting we start the review. We do this by opening
a <a href="https://github.com">GitHub</a> pull request. The following steps will
create a pull request where you can comment every line of code being
reviewed.</p>

<ol>
<li>Create a local branch.</li>
<li>Delete the code being reviewed and commit locally.</li>
<li>Push the branch to GitHub.</li>
<li>Open a pull request.</li>
</ol>


<p>These steps are necessary because GitHub pull requests only let you
view code that has changed. This process marks every line as deleted,
which causes every line to appear the <em>Files changed</em> tab.</p>

<p>Opening the pull request a few days before the review meeting provides
a location for pre-meeting comments to be added. This lets reviewers
spend a couple days thinking about and commenting on the code.
Comments on the pull request indicate a conversation should happen
during the code review meeting.</p>

<h4>Step 3: The code review meeting</h4>

<p>Its finally Friday and time to review the code as a group. Everyone
joins a video conference and someone volunteers to lead the code
review. At least one other person volunteers to be a note taker.</p>

<p>The leader directs the code review and keeps it moving forward. To do
this the leader shares their screen with the video conference and
scrolls through the <em>Files changed</em> view of the pull request. When a
comment appears on screen the leader stops scrolling and discussion
starts.</p>

<p>The comments are read (often silently) and discussion happens. The
leader tries to recognize when a conclusion has been reached or when
further discussion, outside of the code review, needs to happen. When
a conclusion is reached someone (often the leader) states a quick
summary and a note taker records the next steps. The next steps are
added as additional comments in the comment thread being discussed. As
the next steps are recorded the leader moves on to the next comment.</p>

<p>This continues until either time runs out or the group runs out of
things to discuss.</p>

<p>After the code review a volunteer turns the next steps comments into
Trello cards and we take care of the code review items as part of our
usual work.</p>

<h3>Results</h3>

<p>We&rsquo;ve seen impressive improvements to code quality in the projects
that have undergone this style of code review. Both small and large
changes have happened as a result. Code has become simpler, clearer,
and better understood. Additionally, the feeling of collective code
ownership has increased.</p>

<p>Teammates have been surprised at how well this process has worked.
More than a couple have said that historically they have not found
code reviews useful but that these were.</p>

<p>This style of code review has worked in a few different settings and I
encourage you to give it a shot.</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>Reading through the discussion on Twitter after this tweet can give some hints as to what it takes to have an effective code review.<a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/09/07/ergodox-turn-on-led-when-not-on-the-main-layer/">ErgoDox: Turn on an LED When Not on the Main Layer</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-09-07T17:35:00-05:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>5:35 pm</span></time>
      </p>
    
  </header>


  <div class="entry-content"><p>The
<a href="http://jakemccrary.com/blog/2014/07/27/building-the-ergodox-keyboard/">ErgoDox</a>
is a great keyboard. One its appeals is that you can build your own
firmware. This makes it possible to rearrange the keys however you
want and tweak other functionality. The firmware is fairly advanced
and allows you to have multiple layers to your keyboard.</p>

<p>Multiple layers allow the ErgoDox to have fewer physical keys than
traditional keyboards. How often do you use an F key? If you are like
me the answer is almost never. Why bother having a dedicated key?</p>

<p>Another benefit of multiple layers is that your keyboard is multiple
keyboards in one. Do you use the Dvorak layout and your roommate use
Qwerty? Program both a Dvorak layer and a Qwerty layer into your
keyboard and switch between them with the push of a button.</p>

<p>The only downside I&rsquo;ve noticed of multiple layers is that I&rsquo;ll switch
between them by accident. This is frustrating as all of a sudden your
keyboard works differently and there is no indication that you are on a
different layer.</p>

<p>The ErgoDox has a
<a href="https://github.com/benblazak/ergodox-firmware/blob/513b82d585fdc7175db736163340af3ed6c6f38b/src/main.c#L124-L133">few LEDs</a>
in it that I have never used. I don&rsquo;t even have the needed keys as
part of my keyboard layout (Caps lock? Who uses caps lock? I
don&rsquo;t need to shout that often). I decided to repurpose the num lock
LED as an indicator that I&rsquo;m off the main layer.</p>

<p>This was a straight forward change. In the firmware there is a
<a href="https://github.com/benblazak/ergodox-firmware/blob/513b82d585fdc7175db736163340af3ed6c6f38b/src/main.c#L171">variable</a>
that holds what keyboard layer is active. All I had to do to get the
num lock LED on when I changed layers was to move the <code>layers_head</code>
variable higher in <code>main.c</code> and then change the conditional to turn on
the num lock LED when <code>layers_head != 0</code>.
<a href="https://github.com/jakemcc/ergodox-firmware/commit/383f16a3f091b4e2dd031d098007c4289cc1a261">This</a>
is the commit that does this change. It could have been done as a
three line change.</p>

<p>I highly recommend making this change. Now I just need to find a
transparent DSA keycaps so I can see the LED easier.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/09/01/book-review-haskell-data-analysis-cookbook/">Book Review: Haskell Data Analysis Cookbook</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-09-01T13:49:00-05:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>1</span><span class='date-suffix'>st</span>, <span class='date-year'>2014</span></span> <span class='time'>1:49 pm</span></time>
      </p>
    
  </header>


  <div class="entry-content"><p>Packt Publishing recently asked me to write a review of the book
<a href="http://bit.ly/X0YQaL">Haskell Data Analysis Cookbook</a> by Nishant
Shukla. The book is broken into small sections that show you how to do
a particular task related to data analysis. These tasks vary from
reading a csv file or parsing json to listening to a stream of tweets.</p>

<p>I&rsquo;m not a Haskell programmer. My Haskell experience is limited to
reading some books
(<a href="http://learnyouahaskell.com/">Learn You a Haskell for Great Good</a>
and most of <a href="http://realworldhaskell.org/">Real World Haskell</a>) and
solving some toy problems. All of reading and programming happened
years ago though so I&rsquo;m out of practice.</p>

<p>This book is not for a programmer that is unfamiliar with Haskell. If
you&rsquo;ve never studied it before you&rsquo;ll find yourself turning towards
documentation. If you enter this book with a solid understanding of
functional programming you can get by with a smaller understanding of
Haskell but you will not get much from the book.</p>

<p>I&rsquo;ve only read a few cookbook style books and this one followed the
usual format. It will be more useful as a quick reference than as
something you would read through. It doesn&rsquo;t dive deep into any topic
but does point you toward libraries for various tasks and shows a
short example of using them.</p>

<p>A common critic I have of most code examples applies to this book.
Most examples do not do qualified imports of namespaces or selective
imports of functions from namespaces. This is especially useful when
your examples might be read by people who are not be familiar with the
languages standard libraries. Reading code and immediately knowing
where a function comes from is incredibly useful to understanding.</p>

<p>The code for this book is available on
<a href="https://github.com/BinRoot/Haskell-Data-Analysis-Cookbook">GitHub</a>.
It is useful to look at the full example for a section. The examples
in the book are broken into parts with English explanations and I
found that made it hard to fully understand how the code fit together.
Looking at the examples in the GitHub repo helped.</p>

<h4>Recommendation</h4>

<p>I&rsquo;d recommend this book for Haskell programmers who find the table of
contents interesting. If you read the table of contents and think it
would be useful to have a shallow introduction to the topics listed
then you&rsquo;ll find this book useful. It doesn&rsquo;t give a detailed dive
into anything but at least gives you a starting point.</p>

<p>If you either learning Haskell or using Haskell then this book doesn&rsquo;t
have much to offer you.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/07/27/building-the-ergodox-keyboard/">Building the ErgoDox Keyboard</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-07-27T21:05:00-05:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>27</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>9:05 pm</span></time>
      </p>
    
  </header>


  <div class="entry-content"><p>Earlier this year I built an
<a href="https://deskthority.net/wiki/ErgoDox">ErgoDox</a>. The ErgoDox is a split
hand mechanical keyboard whose design has been released under the GNU
GPLv3. There are a few standard <sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup> ways of getting the parts. It
basically comes down to sourcing all the parts yourself or buying a
bundle from <a href="https://www.massdrop.com/buy/ergodox">Massdrop</a>. I opted
to wait until Massdrop was selling them and bought a kit from them.</p>

<p><img src="/images/my-keyboard.jpg" title="My ErgoDox" alt="My ErgoDox" /></p>

<h3>Why?</h3>

<ol>
<li>I&rsquo;ve used an ergonomic keyboard for years and was intrigued by the split hand design.</li>
<li>I wanted to try out Cherry MX key switches.</li>
<li>Using your thumb for more than just space bar made a lot of sense to me.</li>
<li>The firmware lets you have multiple layers. I thought this could be really useful.</li>
<li>The project sounded fun. I used to make physical devices and this
seemed like a good way to do that again.</li>
</ol>


<h3>Buying</h3>

<p>As mentioned earlier I bought my parts from Massdrop. In the buy I
participated in I had the option of a full hand case or the
traditional case and I opted for the full hand. As part of the buy I
also bought additional aluminum top layers, a blank set of DSA <sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>
keycaps, and Cherry MX blue key switches.</p>

<p>If I were doing it again I would not buy the extra aluminum top
layer. I built one of my hands using the aluminum and the other with
the basic acrylic top. I enjoy both the look and feel of the acrylic
hand better.</p>

<p>I would also not buy the set of DSA keycaps from Massdrop. It was
convenient and a bit cheaper to buy from them but had I known I could
get different
<a href="http://keyshop.pimpmykeyboard.com/products/full-keysets/dsa-blank-sets-1">colors</a>
from <a href="http://www.keycapsdirect.com/">Signature Plastics</a> I would have done that.</p>

<p>I also bought eight &ldquo;deep-dish&rdquo; DSA keys direct from Signature
Plastics. These keys feel different which lets me know when my fingers
are above the home row. I&rsquo;d recommend doing this. You can order from
<a href="http://www.keycapsdirect.com/key-capsinventory.php">this</a> page.</p>

<p>For key switches I bought Cherry MX Blues through Massdrop. Blues are
extremely clicky. You can easily hear me typing in every room of my
apartment. It is very satisfying.</p>

<p>After using the keyboard for about a week I also ended up buying some
<a href="http://www.amazon.com/gp/product/B00897D3OQ/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=B00897D3OQ&amp;linkCode=as2&amp;tag=jakemccrary08-20&amp;linkId=HTBBKS475FGFIG2M">pads</a>
for my wrists. I occasionally rest my wrists on the keyboard and the
keyboard&rsquo;s edge would dig into me.</p>

<h3>Building</h3>

<p>I followed Massdrop&rsquo;s step-by-step
<a href="https://www.massdrop.com/ext/ergodox/assembly.php">guide</a> and
<a href="https://www.youtube.com/watch?v=x1irVrAl3Ts">this</a> YouTube video.
Another great resource is the community at
<a href="http://geekhack.org/index.php?topic=22780.0">GeekHack</a>. I&rsquo;d recommend
reading and watching as much as possible before starting your build.</p>

<p>I built this using a cheap soldering iron I&rsquo;ve had for years, very
thin solder, solder wick, and a multimeter. I don&rsquo;t know if this would
have been easier with better tools or not but those got the job done.</p>

<p>While soldering the surface mount diodes I was in the zone and
soldered a few locations that didn&rsquo;t actually need to be soldered.
When you are soldering the diodes you should only be soldering them to
the locations that have the key silk screen.</p>

<p>My system for minimizing errors while soldering the diodes is the
following five steps.</p>

<ol>
<li>Lay down some solder on one of the pads.</li>
<li>Put the correct end of the diode on top of that solder, reheat and
push down.</li>
<li>Test the connection with a multimeter.</li>
<li>Solder the other half of the diode.</li>
<li>Test the connection.</li>
</ol>


<p>I batched up the steps. I&rsquo;d do a whole row of the first step, then
move to the second for the entire row, then do the third, etc. Being
rigorous about testing every connection is important. Catching
mistakes early makes it easier to fix the mistakes.</p>

<p>If you solder a diode on the wrong way there is a huge difference (at
least for me using solder wick) between the difficulty of fixing the
error when only one pad has been soldered versus two pads. I soldered
more than one diode backwards and a mistake noticed after soldering
only one pad was easy to fix. After soldering both pads it took
serious effort.</p>

<p>Eventually you&rsquo;ll need to cut open a USB cable. I ended up removing
the plastic housing using a Dremel. When soldering the wires to the
USB holes I was too concerned with it looking pretty and did not leave
plenty of wire. This made it harder to solder and as a result I ended
up doing a poor job that resulted in a short. After desoldering and
destroying another cable, but leaving more wire, I managed to do a
better job. I originally noticed the short because I kept getting
warnings from my computer about my USB Keyboard drawing too much
power.</p>

<p>I&rsquo;ve
<a href="https://www.evernote.com/shard/s68/sh/4f51c3b2-b50b-47d3-8219-ea155cf5fef5/df239167726bcebf06cc2b5101ac8e42/">annotated a copy</a>
of Massdrop&rsquo;s instructions using Evernote. It contains the above tips
inline.</p>

<h3>Firmware</h3>

<p>After you physically build your keyboard you need to build the
firmware. There are a few different firmwares that can work and you
can discover those on GeekHack. I&rsquo;m using a fork of what Massdrop&rsquo;s
<a href="https://www.massdrop.com/ext/ergodox">graphical configuration</a> tool
uses. It is based off
<a href="https://github.com/benblazak/ergodox-firmware">benblazak/ergodox-firmware</a>.</p>

<p>One of the exciting things about the ErgoDox is tweaking the firmware.
I took the base firmware and modified it to have media key support and
<a href="https://github.com/jakemcc/ergodox-firmware/commit/383f16a3f091b4e2dd031d098007c4289cc1a261">light up the LEDs</a>
when I&rsquo;m on any layer besides the base. Some people have added the
ability to record keyboard macros and other neat features. I encourage
you to take a look at the source even if you use the graphical
configuration tool. I haven&rsquo;t explored beyond
<a href="https://github.com/benblazak/ergodox-firmware">benblazak/ergodox-firmware</a>
so I can&rsquo;t compare it to other firmwares.</p>

<h3>Conclusion</h3>

<p>I really enjoy it. Building it was both fun and frustrating <sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup>.</p>

<p>After using the keyboard for a few months I&rsquo;ve found that I really
only use three (on each hand) of the thumb cluster keys. I also don&rsquo;t
use the keyboard layers too often. I have three layers programmed and
I always stay on the main one unless I want to hit a media key.</p>

<p>Would I recommend building your own ErgoDox? If you already can or are
willing to learn to solder and this sounds at all interesting to you I
would recommend it. The project can be frustrating but the result is
great.</p>

<h3>The Future</h3>

<p>There is still a lot left to explore in the custom keyboard space.
Even so I have no plans on leaving the ErgoDox anytime soon. In terms
of improving my ErgoDox, I plan on poking around the different
firmwares at some point. I&rsquo;d also like to explore
<a href="http://geekhack.org/index.php?topic=22780.msg1405792#msg1405792">tenting</a>
<a href="https://github.com/adereth/ergodox-tent">options</a>.</p>

<h3>Resources</h3>

<ul>
<li><a href="http://geekhack.org/index.php?topic=22780.0">GeekHack ErgoDox thread</a></li>
<li><a href="http://geekhack.org/index.php?topic=40501.0">GeekHack FAQ</a>
Useful for general information about keyboard topics.</li>
<li><a href="http://geekhack.org/index.php?topic=40501.0#post_DD">GeekHack Cherry actuation forces</a></li>
<li><a href="https://www.massdrop.com/buy/ergodox">Massdrop Buy</a></li>
<li><a href="https://www.massdrop.com/ext/ergodox">Massdrop Configuration Tool</a></li>
<li><a href="https://github.com/benblazak/ergodox-firmware">benblazak/ergodox-firmware</a></li>
<li><a href="http://geekhack.org/index.php?topic=48106.0">TMK firmware for ErgoDox</a>
One of the alternative firmwares.</li>
</ul>

<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>I feel a bit odd using the word standard to describe acquiring parts to build a keyboard.<a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
<li id="fn:2">
<p><a href="http://keycapsdirect.com/key-caps.php">This</a> page has diagrams that shows the different keycap families.<a href="#fnref:2" rev="footnote">&#8617;</a></p></li>
<li id="fn:3">
<p>Those surface mount diodes are so tiny.<a href="#fnref:3" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/07/04/using-emacs-to-explore-an-http-api/">Using Emacs to Explore an HTTP API</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-07-04T13:05:00-05:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>4</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>1:05 pm</span></time>
      </p>
    
  </header>


  <div class="entry-content"><p>Recently I rediscovered an Emacs package that allows you to interact
with HTTP endpoints from the comfort of an Emacs buffer.
<a href="https://github.com/pashky/restclient.el">restclient.el</a> provides
<code>restclient-mode</code>. This mode allows you to write and execute HTTP
requests in an Emacs buffer. This package can be found in
<a href="http://melpa.milkbox.net/#/restclient">MELPA</a>.</p>

<p>Below is an example buffer that touches the GitHub API.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="ss">:github</span> <span class="o">=</span> <span class="ss">https</span><span class="p">:</span><span class="sr">//</span><span class="n">api</span><span class="o">.</span><span class="n">github</span><span class="o">.</span><span class="n">com</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># get users orgs</span>
</span><span class='line'>
</span><span class='line'><span class="no">GET</span> <span class="ss">:github</span><span class="o">/</span><span class="n">users</span><span class="o">/</span><span class="n">jakemcc</span><span class="o">/</span><span class="n">orgs</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># rendor markdown</span>
</span><span class='line'>
</span><span class='line'><span class="no">POST</span> <span class="ss">:github</span><span class="o">/</span><span class="n">markdown</span>
</span><span class='line'>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="s2">&quot;text&quot;</span> <span class="p">:</span> <span class="s2">&quot;## Title&quot;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># rendor markdown raw</span>
</span><span class='line'>
</span><span class='line'><span class="no">POST</span> <span class="ss">:github</span><span class="o">/</span><span class="n">markdown</span><span class="o">/</span><span class="n">raw</span>
</span><span class='line'><span class="no">Content</span><span class="o">-</span><span class="ss">Type</span><span class="p">:</span> <span class="n">text</span><span class="o">/</span><span class="n">plain</span>
</span><span class='line'>
</span><span class='line'><span class="no">Title</span>
</span><span class='line'><span class="o">-----</span>
</span></code></pre></td></tr></table></div></figure>


<p>The example above has a few interesting snippets. <code>:github</code> is an
example of a variable. Lines 8-14 show an example of posting json to
an endpoint. You put the data you want to send below the query. The
last POST shows how to set headers for a request.</p>

<p>The location of your cursor decides what query to execute. Comments
start with <code>#</code> and break your document into sections. The query in the
same section as your cursor is the one that is executed. If the cursor
is anywhere on lines 3-6 and I hit <code>C-c C-c</code> then Emacs queries GitHub
for my organizations. Below is what pops up in a buffer.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">[</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="s2">&quot;avatar_url&quot;</span><span class="o">:</span> <span class="s2">&quot;https:\/\/avatars.githubusercontent.com\/u\/1826953?&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="s2">&quot;public_members_url&quot;</span><span class="o">:</span> <span class="s2">&quot;https:\/\/api.github.com\/orgs\/speakerconf\/public_members{\/member}&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="s2">&quot;members_url&quot;</span><span class="o">:</span> <span class="s2">&quot;https:\/\/api.github.com\/orgs\/speakerconf\/members{\/member}&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="s2">&quot;events_url&quot;</span><span class="o">:</span> <span class="s2">&quot;https:\/\/api.github.com\/orgs\/speakerconf\/events&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="s2">&quot;repos_url&quot;</span><span class="o">:</span> <span class="s2">&quot;https:\/\/api.github.com\/orgs\/speakerconf\/repos&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;https:\/\/api.github.com\/orgs\/speakerconf&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="mi">1826953</span><span class="p">,</span>
</span><span class='line'>        <span class="s2">&quot;login&quot;</span><span class="o">:</span> <span class="s2">&quot;speakerconf&quot;</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="s2">&quot;avatar_url&quot;</span><span class="o">:</span> <span class="s2">&quot;https:\/\/avatars.githubusercontent.com\/u\/4711436?&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="s2">&quot;public_members_url&quot;</span><span class="o">:</span> <span class="s2">&quot;https:\/\/api.github.com\/orgs\/outpace\/public_members{\/member}&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="s2">&quot;members_url&quot;</span><span class="o">:</span> <span class="s2">&quot;https:\/\/api.github.com\/orgs\/outpace\/members{\/member}&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="s2">&quot;events_url&quot;</span><span class="o">:</span> <span class="s2">&quot;https:\/\/api.github.com\/orgs\/outpace\/events&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="s2">&quot;repos_url&quot;</span><span class="o">:</span> <span class="s2">&quot;https:\/\/api.github.com\/orgs\/outpace\/repos&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;https:\/\/api.github.com\/orgs\/outpace&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="mi">4711436</span><span class="p">,</span>
</span><span class='line'>        <span class="s2">&quot;login&quot;</span><span class="o">:</span> <span class="s2">&quot;outpace&quot;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">]</span>
</span><span class='line'><span class="c1">// HTTP/1.1 200 OK</span>
</span><span class='line'><span class="c1">// Server: GitHub.com</span>
</span><span class='line'><span class="c1">// Date: Fri, 04 Jul 2014 17:34:26 GMT</span>
</span><span class='line'><span class="c1">// Content-Type: application/json; charset=utf-8</span>
</span><span class='line'><span class="c1">// other headers removed for space consideration on blog</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>C-c C-c</code> triggers <code>restclient-http-send-current</code> which runs a query
and pretty prints the result. I could have used <code>C-c C-r</code> to trigger
<code>restclient-http-send-current-raw</code> which executes a query and shows
the raw result.</p>

<p>It isn&rsquo;t a perfect mode. One issue I&rsquo;ve come across is that queries
targeting <code>localhost</code> fail. The solution is to query <code>127.0.0.1</code>.</p>

<p><code>restclient-mode</code> makes Emacs a useful tool for exploring and
testing HTTP APIs. Since it operates on a simple text
format it allows you to easily share executable documentation with
others. I highly recommend <strong>restclient.el</strong>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/06/22/comparing-clojure-testing-libraries-output/">Comparing Clojure Testing Libraries: Output</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-06-22T21:16:00-05:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2014</span></span> <span class='time'>9:16 pm</span></time>
      </p>
    
  </header>


  <div class="entry-content"><p>I recently became interested in how Clojure testing libraries help you
when there is a test failure. This interest resulted in me
<a href="https://github.com/jakemcc/clojure-test-bed">exploring</a> different
Clojure testing libraries. I created the same tests using <strong>clojure.test</strong>
(with and without
<a href="https://github.com/pjstadig/humane-test-output">humane-test-output</a>),
<a href="http://jayfields.com/expectations/">expectations</a>,
<a href="https://github.com/marick/Midje">Midje</a>, and
<a href="http://speclj.com/">Speclj</a> and looked at the output.</p>

<p>I ran all of these examples using Leiningen. <strong>Midje</strong>, <strong>Speclj</strong>, and
<strong>expectations</strong> color their output but I&rsquo;m not going to try to reproduce
that here. The color added by <strong>Midje</strong> and <strong>expectations</strong> is useful. <strong>Speclj</strong>
color hurt its readability. I use a dark colored terminal and <strong>Speclj</strong>
colors the line that tells where the failure occurs
black. This made it hard to read.</p>

<p>I&rsquo;m not going to show what the tests look like for each testing
library past the first comparison. How a test in expressed is
important but not what I want to focus on in this post.</p>

<h2>Comparing Strings</h2>

<p>Going to start off with a basic string comparison. The failing test
compares two strings that only differ by one character.</p>

<h5>clojure.test</h5>

<p>Most (hopefully all) Clojure programmers should be familiar with
<strong>clojure.test</strong>. It is the testing library that is included with Clojure.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">ns </span><span class="nv">example.string-test</span>
</span><span class='line'>  <span class="p">(</span><span class="ss">:require</span> <span class="p">[</span><span class="nv">clojure.test</span> <span class="ss">:refer</span> <span class="ss">:all</span><span class="p">]))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">deftest</span> <span class="nv">string-comparisons</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">is</span> <span class="p">(</span><span class="nb">= </span><span class="s">&quot;strings equal&quot;</span> <span class="s">&quot;strings equal&quot;</span><span class="p">))</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">is</span> <span class="p">(</span><span class="nb">= </span><span class="s">&quot;space&quot;</span> <span class="s">&quot;spice&quot;</span><span class="p">)))</span>
</span></code></pre></td></tr></table></div></figure>


<p>The output below is what you get when the above test runs. Even in
this simple example it isn&rsquo;t the easiest to read. It doesn&rsquo;t make it
easy to find the expected or actual values.</p>

<figure class='code'><figcaption><span>clojure.test output</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">FAIL in (string-comparisons) (string_test.clj:6)</span>
</span><span class='line'><span class="go">expected: (= &quot;space&quot; &quot;spice&quot;)</span>
</span><span class='line'><span class="go">  actual: (not (= &quot;space&quot; &quot;spice&quot;))</span>
</span></code></pre></td></tr></table></div></figure>


<p>Below is the same test but with <strong>humane-test-output</strong> enabled. It is easy
to read the output and see the expected and actual value. It even
provides a diff between them although in this situation it isn&rsquo;t that useful.</p>

<figure class='code'><figcaption><span>clojure.test with humane-test-output</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">FAIL in (string-comparisons) (string_test.clj:6)</span>
</span><span class='line'><span class="go">expected: &quot;space&quot;</span>
</span><span class='line'><span class="go">  actual: &quot;spice&quot;</span>
</span><span class='line'><span class="go">    diff: - &quot;space&quot;</span>
</span><span class='line'><span class="go">          + &quot;spice&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<h5>expectations</h5>

<p>Another testing library is Jay Field&rsquo;s
<a href="http://jayfields.com/expectations/">expectations</a>. You can see from
the example that it has a fairly minimal syntax.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">ns </span><span class="nv">example.string-expectations</span>
</span><span class='line'>  <span class="p">(</span><span class="ss">:require</span> <span class="p">[</span><span class="nv">expectations</span> <span class="ss">:refer</span> <span class="ss">:all</span><span class="p">]))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">expect</span> <span class="s">&quot;strings equal&quot;</span> <span class="s">&quot;strings equal&quot;</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="nf">expect</span> <span class="s">&quot;space&quot;</span> <span class="s">&quot;spice&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>expectations output</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">failure in (string_expectations.clj:5) : example.string-expectations</span>
</span><span class='line'><span class="go">(expect &quot;space&quot; &quot;spice&quot;)</span>
</span><span class='line'>
</span><span class='line'><span class="go">           expected: &quot;space&quot;</span>
</span><span class='line'><span class="go">                was: &quot;spice&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="go">           matches: &quot;sp&quot;</span>
</span><span class='line'><span class="go">           diverges: &quot;ace&quot;</span>
</span><span class='line'><span class="go">                  &amp;: &quot;ice&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>The output from <strong>expectations</strong> is very readable. You can easily pick out
the expected and actual values. It also shows you where the
string starts to diverge.</p>

<h5>Speclj</h5>

<p>Before writing this post I had zero experience with Micah Martin&rsquo;s
<a href="http://speclj.com/">Speclj</a>. Below is my translation of the failing
string test and its output.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">ns </span><span class="nv">example.string-spec</span>
</span><span class='line'>  <span class="p">(</span><span class="ss">:require</span> <span class="p">[</span><span class="nv">speclj.core</span> <span class="ss">:refer</span> <span class="ss">:all</span><span class="p">]))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">describe</span> <span class="s">&quot;String comparisons&quot;</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">it</span> <span class="s">&quot;have nice error message&quot;</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">should=</span> <span class="s">&quot;space&quot;</span> <span class="s">&quot;spice&quot;</span><span class="p">)))</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>Speclj</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">  9) String comparisons have nice error message</span>
</span><span class='line'><span class="go">     Expected: &quot;space&quot;</span>
</span><span class='line'><span class="go">          got: &quot;spice&quot; (using =)</span>
</span><span class='line'><span class="go">     /Users/jake/src/jakemcc/example/spec/example/string_spec.clj:7</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Speclj</strong>&rsquo;s test output above is an improvement over <strong>clojure.test</strong>. You
can easily find the expected and actual values. It doesn&rsquo;t provide any
help with diagnosing how those values are different.</p>

<h5>Midje</h5>

<p>I have a little bit of experience with Brian Marick&rsquo;s
<a href="https://github.com/marick/Midje">Midje</a>. Unlike the other libraries
it switches up the assertion syntax. In <strong>Midje</strong> the expected value is on
the right side of <code>=&gt;</code>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">ns </span><span class="nv">example.string-test</span>
</span><span class='line'>  <span class="p">(</span><span class="ss">:require</span> <span class="p">[</span><span class="nv">midje.sweet</span> <span class="ss">:refer</span> <span class="ss">:all</span><span class="p">]))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">fact</span> <span class="s">&quot;strings are equal&quot;</span>
</span><span class='line'>  <span class="s">&quot;string is equal&quot;</span> <span class="nv">=&gt;</span> <span class="s">&quot;string is equal&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">fact</span> <span class="s">&quot;strings not equal&quot;</span>
</span><span class='line'>   <span class="s">&quot;spice&quot;</span> <span class="nv">=&gt;</span> <span class="s">&quot;space&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>Midje</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">FAIL &quot;strings not equal&quot; at (string_test.clj:8)</span>
</span><span class='line'><span class="go">    Expected: &quot;space&quot;</span>
</span><span class='line'><span class="go">      Actual: &quot;spice&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Midje</strong>&rsquo;s output is similar to <strong>Speclj</strong>&rsquo;s. You can quickly find the
expected and actual values but it doesn&rsquo;t help you spot the
difference.</p>

<h3>String Comparison Winner</h3>

<p><strong>expectations</strong> wins for best output. You can easily spot the expected
and actual values and it also helps you find the difference between
the strings.</p>

<p>The worst output comes from <strong>clojure.test</strong>. It doesn&rsquo;t make it easy to
spot the difference or even find the expected and actual values.</p>

<h2>Comparing Maps</h2>

<p>For maps I&rsquo;ve setup three assertions. The first has an extra key-value
pair in the actual value. The second has an extra in the expected
value. The final assertion has a different value for the <code>:cheese</code>
key. The <strong>clojure.test</strong> example is below.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="nf">deftest</span> <span class="nv">map-comparisons</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">is</span> <span class="p">(</span><span class="nb">= </span><span class="p">{</span><span class="ss">:sheep</span> <span class="mi">1</span><span class="p">}</span> <span class="p">{</span><span class="ss">:cheese</span> <span class="mi">1</span> <span class="ss">:sheep</span> <span class="mi">1</span><span class="p">}))</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">is</span> <span class="p">(</span><span class="nb">= </span><span class="p">{</span><span class="ss">:sheep</span> <span class="mi">1</span> <span class="ss">:cheese</span> <span class="mi">1</span><span class="p">}</span> <span class="p">{</span><span class="ss">:sheep</span> <span class="mi">1</span><span class="p">}))</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">is</span> <span class="p">(</span><span class="nb">= </span><span class="p">{</span><span class="ss">:sheep</span> <span class="mi">1</span> <span class="ss">:cheese</span> <span class="mi">1</span><span class="p">}</span> <span class="p">{</span><span class="ss">:sheep</span> <span class="mi">1</span> <span class="ss">:cheese</span> <span class="mi">5</span><span class="p">})))</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>clojure.test</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">FAIL in (map-comparisons) (map_test.clj:5)</span>
</span><span class='line'><span class="go">expected: (= {:sheep 1} {:cheese 1, :sheep 1})</span>
</span><span class='line'><span class="go">  actual: (not (= {:sheep 1} {:cheese 1, :sheep 1}))</span>
</span><span class='line'>
</span><span class='line'><span class="go">FAIL in (map-comparisons) (map_test.clj:6)</span>
</span><span class='line'><span class="go">expected: (= {:sheep 1, :cheese 1} {:sheep 1})</span>
</span><span class='line'><span class="go">  actual: (not (= {:cheese 1, :sheep 1} {:sheep 1}))</span>
</span><span class='line'>
</span><span class='line'><span class="go">FAIL in (map-comparisons) (map_test.clj:7)</span>
</span><span class='line'><span class="go">expected: (= {:sheep 1, :cheese 1} {:sheep 1, :cheese 5})</span>
</span><span class='line'><span class="go">  actual: (not (= {:cheese 1, :sheep 1} {:cheese 5, :sheep 1}))</span>
</span></code></pre></td></tr></table></div></figure>


<p>Unsurprisingly the default <strong>clojure.test</strong> output for maps suffers from
the same problems found in the string comparisons. To find the
actual and expected values you need to manually parse the output.</p>

<figure class='code'><figcaption><span>clojure.test with humane-test-output</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">FAIL in (map-comparisons) (map_test.clj:5)</span>
</span><span class='line'><span class="go">expected: {:sheep 1}</span>
</span><span class='line'><span class="go">  actual: {:cheese 1, :sheep 1}</span>
</span><span class='line'><span class="go">    diff: + {:cheese 1}</span>
</span><span class='line'>
</span><span class='line'><span class="go">FAIL in (map-comparisons) (map_test.clj:6)</span>
</span><span class='line'><span class="go">expected: {:cheese 1, :sheep 1}</span>
</span><span class='line'><span class="go">  actual: {:sheep 1}</span>
</span><span class='line'><span class="go">    diff: - {:cheese 1}</span>
</span><span class='line'>
</span><span class='line'><span class="go">FAIL in (map-comparisons) (map_test.clj:7)</span>
</span><span class='line'><span class="go">expected: {:cheese 1, :sheep 1}</span>
</span><span class='line'><span class="go">  actual: {:cheese 5, :sheep 1}</span>
</span><span class='line'><span class="go">    diff: - {:cheese 1}</span>
</span><span class='line'><span class="go">          + {:cheese 5}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Above is the output of using <strong>clojure.test</strong> with <strong>humane-test-output</strong>. It
is a big improvement over the default <strong>clojure.test</strong>. You can quickly
see the expected and actual values. Unlike with the string assertions
the diff view is actually helpful. The diffs do a good job of helping
you identify the error.</p>

<figure class='code'><figcaption><span>expectations</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">failure in (map_expectations.clj:6) : example.map-expectations</span>
</span><span class='line'><span class="go">(expect {:sheep 1} {:sheep 1, :cheese 1})</span>
</span><span class='line'>
</span><span class='line'><span class="go">           expected: {:sheep 1}</span>
</span><span class='line'><span class="go">                was: {:cheese 1, :sheep 1}</span>
</span><span class='line'>
</span><span class='line'><span class="go">           in expected, not actual: null</span>
</span><span class='line'><span class="go">           in actual, not expected: {:cheese 1}</span>
</span><span class='line'>
</span><span class='line'><span class="go">failure in (map_expectations.clj:7) : example.map-expectations</span>
</span><span class='line'><span class="go">(expect {:sheep 1, :cheese 1} {:sheep 1})</span>
</span><span class='line'>
</span><span class='line'><span class="go">           expected: {:cheese 1, :sheep 1}</span>
</span><span class='line'><span class="go">                was: {:sheep 1}</span>
</span><span class='line'>
</span><span class='line'><span class="go">           in expected, not actual: {:cheese 1}</span>
</span><span class='line'><span class="go">           in actual, not expected: null</span>
</span><span class='line'>
</span><span class='line'><span class="go">failure in (map_expectations.clj:8) : example.map-expectations</span>
</span><span class='line'><span class="go">(expect {:sheep 1, :cheese 5} {:sheep 1, :cheese 1})</span>
</span><span class='line'>
</span><span class='line'><span class="go">           expected: {:cheese 5, :sheep 1}</span>
</span><span class='line'><span class="go">                was: {:cheese 1, :sheep 1}</span>
</span><span class='line'>
</span><span class='line'><span class="go">           in expected, not actual: {:cheese 5}</span>
</span><span class='line'><span class="go">           in actual, not expected: {:cheese 1}</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>expectations</strong> does a pretty good job helping you as well. As before,
you can clearly read the expected and actual values. <strong>expectations</strong> also
provides some hint as to what is different between the maps. I find
the English descriptions a bit easier to read than
<strong>humane-test-output</strong>&rsquo;s diff view. Still seeing lines like line 7 (<code>in
expected, not actual: null</code>) is a bit confusing and the output would
be improved if it was suppressed.</p>

<p>I&rsquo;m just going to lump <strong>Speclj</strong> and <strong>Midje</strong> together. The output for each
is below. They both improve over <strong>clojure.test</strong> by making it easy to see
the expected and actual value. They both don&rsquo;t do anything beyond that.</p>

<figure class='code'><figcaption><span>Speclj</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">  4) map comparisons have nice error messages when extra entries keys present</span>
</span><span class='line'><span class="go">     Expected: {:sheep 1}</span>
</span><span class='line'><span class="go">          got: {:cheese 1, :sheep 1} (using =)</span>
</span><span class='line'><span class="go">     /Users/jake/src/jakemcc/example/spec/example/map_spec.clj:7</span>
</span><span class='line'>
</span><span class='line'><span class="go">  5) map comparisons have nice error messages when missing an entry</span>
</span><span class='line'><span class="go">     Expected: {:cheese 1, :sheep 1}</span>
</span><span class='line'><span class="go">          got: {:sheep 1} (using =)</span>
</span><span class='line'><span class="go">     /Users/jake/src/jakemcc/example/spec/example/map_spec.clj:9</span>
</span><span class='line'>
</span><span class='line'><span class="go">  6) map comparisons have nice error messages when mismatched values</span>
</span><span class='line'><span class="go">     Expected: {:cheese 5, :sheep 1}</span>
</span><span class='line'><span class="go">          got: {:cheese 1, :sheep 1} (using =)</span>
</span><span class='line'><span class="go">     /Users/jake/src/jakemcc/example/spec/example/map_spec.clj:11</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>Midje</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">FAIL &quot;map is missing an entry&quot; at (map_test.clj:5)</span>
</span><span class='line'><span class="go">    Expected: {:cheese 1, :sheep 1}</span>
</span><span class='line'><span class="go">      Actual: {:sheep 1}</span>
</span><span class='line'>
</span><span class='line'><span class="go">FAIL &quot;map has an extra entry&quot; at (map_test.clj:8)</span>
</span><span class='line'><span class="go">    Expected: {:sheep 1}</span>
</span><span class='line'><span class="go">      Actual: {:cheese 1, :sheep 1}</span>
</span><span class='line'>
</span><span class='line'><span class="go">FAIL &quot;map has a different value&quot; at (map_test.clj:11)</span>
</span><span class='line'><span class="go">    Expected: {:cheese 5, :sheep 1}</span>
</span><span class='line'><span class="go">      Actual: {:cheese 1, :sheep 1}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Map Comparison Winner</h3>

<p>Tie between <strong>humane-test-output</strong> and <strong>expectations</strong>. Both do a
good job of helping the reader spot the difference.</p>

<h2>Comparing Sets</h2>

<p>Next up are sets. Only two assertions for this section. One
with the actual value having an extra member and one test where it is
missing a member.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">ns </span><span class="nv">example.set-test</span>
</span><span class='line'>  <span class="p">(</span><span class="ss">:require</span> <span class="p">[</span><span class="nv">clojure.test</span> <span class="ss">:refer</span> <span class="ss">:all</span><span class="p">]))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">deftest</span> <span class="nv">set-comparisons</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">is</span> <span class="p">(</span><span class="nb">= </span><span class="o">#</span><span class="p">{</span><span class="ss">:a</span> <span class="ss">:b</span><span class="p">}</span> <span class="o">#</span><span class="p">{</span><span class="ss">:a</span> <span class="ss">:b</span> <span class="ss">:c</span><span class="p">}))</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">is</span> <span class="p">(</span><span class="nb">= </span><span class="o">#</span><span class="p">{</span><span class="ss">:a</span> <span class="ss">:b</span> <span class="ss">:c</span><span class="p">}</span> <span class="o">#</span><span class="p">{</span><span class="ss">:a</span> <span class="ss">:b</span><span class="p">})))</span>
</span></code></pre></td></tr></table></div></figure>


<p>First up is the basic <strong>clojure.test</strong> output. It suffers from the same
problem it has suffered this entire time. It doesn&rsquo;t make it easy to
read the expected and actual values.</p>

<figure class='code'><figcaption><span>clojure.test</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">FAIL in (set-comparisons) (set_test.clj:5)</span>
</span><span class='line'><span class="go">expected: (= #{:b :a} #{:c :b :a})</span>
</span><span class='line'><span class="go">  actual: (not (= #{:b :a} #{:c :b :a}))</span>
</span><span class='line'>
</span><span class='line'><span class="go">FAIL in (set-comparisons) (set_test.clj:6)</span>
</span><span class='line'><span class="go">expected: (= #{:c :b :a} #{:b :a})</span>
</span><span class='line'><span class="go">  actual: (not (= #{:c :b :a} #{:b :a}))</span>
</span></code></pre></td></tr></table></div></figure>


<p>No surprises with <strong>humane-test-output</strong>. It improves the <strong>clojure.test</strong>
output by making it easy to read the expected and actual values. The
diff view also helps figure out what is causing the assertion to fail.</p>

<figure class='code'><figcaption><span>clojure.test with humane-test-output</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">FAIL in (set-comparisons) (set_test.clj:5)</span>
</span><span class='line'><span class="go">expected: #{:b :a}</span>
</span><span class='line'><span class="go">  actual: #{:c :b :a}</span>
</span><span class='line'><span class="go">    diff: + #{:c}</span>
</span><span class='line'>
</span><span class='line'><span class="go">FAIL in (set-comparisons) (set_test.clj:6)</span>
</span><span class='line'><span class="go">expected: #{:c :b :a}</span>
</span><span class='line'><span class="go">  actual: #{:b :a}</span>
</span><span class='line'><span class="go">    diff: - #{:c}</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>expectations</strong> once again delivers nice output. It continues to be easy
to find the expected and actual values and helps you spot the
differences with a diff view.</p>

<figure class='code'><figcaption><span>expectations</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">failure in (set_expectations.clj:4) : example.set-expectations</span>
</span><span class='line'><span class="go">(expect #{:b :a} #{:c :b :a})</span>
</span><span class='line'>
</span><span class='line'><span class="go">           expected: #{:b :a}</span>
</span><span class='line'><span class="go">                was: #{:c :b :a}</span>
</span><span class='line'>
</span><span class='line'><span class="go">           in expected, not actual: null</span>
</span><span class='line'><span class="go">           in actual, not expected: #{:c}</span>
</span><span class='line'>
</span><span class='line'><span class="go">failure in (set_expectations.clj:5) : example.set-expectations</span>
</span><span class='line'><span class="go">(expect #{:c :b :a} #{:b :a})</span>
</span><span class='line'>
</span><span class='line'><span class="go">           expected: #{:c :b :a}</span>
</span><span class='line'><span class="go">                was: #{:b :a}</span>
</span><span class='line'>
</span><span class='line'><span class="go">           in expected, not actual: #{:c}</span>
</span><span class='line'><span class="go">           in actual, not expected: null</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Speclj</strong> and <strong>Midje</strong> both have better output than the basic <strong>clojure.test</strong>.</p>

<figure class='code'><figcaption><span>Speclj</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">  7) set comparisons have nice error messages when missing item</span>
</span><span class='line'><span class="go">     Expected: #{:b :a}</span>
</span><span class='line'><span class="go">          got: #{:c :b :a} (using =)</span>
</span><span class='line'><span class="go">     /Users/jake/src/jakemcc/example/spec/example/set_spec.clj:9</span>
</span><span class='line'>
</span><span class='line'><span class="go">  8) set comparisons have nice error messages when more items</span>
</span><span class='line'><span class="go">     Expected: #{:c :b :a}</span>
</span><span class='line'><span class="go">          got: #{:b :a} (using =)</span>
</span><span class='line'><span class="go">     /Users/jake/src/jakemcc/example/spec/example/set_spec.clj:11</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>Midje</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">FAIL &quot;set is superset of expected&quot; at (set_test.clj:5)</span>
</span><span class='line'><span class="go">    Expected: #{:a :b}</span>
</span><span class='line'><span class="go">      Actual: #{:a :b :c}</span>
</span><span class='line'>
</span><span class='line'><span class="go">FAIL &quot;set is subset of expected&quot; at (set_test.clj:8)</span>
</span><span class='line'><span class="go">    Expected: #{:a :b :c}</span>
</span><span class='line'><span class="go">      Actual: #{:a :b}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Set Comparison Winner</h3>

<p>Similar to the winner of the map comparisons I&rsquo;m going to split the
victory between <strong>expectations</strong> and <strong>humane-test-output</strong>.</p>

<h2>Comparing Lists</h2>

<p>Next up we compare lists (and lists to vectors). There are three
comparisons; one with an extra element, one with same length but a
mismatched element, and one comparing a vector and list with drastically
different contents.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">ns </span><span class="nv">example.seq-test</span>
</span><span class='line'>  <span class="p">(</span><span class="ss">:require</span> <span class="p">[</span><span class="nv">clojure.test</span> <span class="ss">:refer</span> <span class="ss">:all</span><span class="p">]))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">deftest</span> <span class="nv">list-comparisons</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">is</span> <span class="p">(</span><span class="nb">= </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">)))</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">is</span> <span class="p">(</span><span class="nb">= </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)))</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">is</span> <span class="p">(</span><span class="nb">= </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">9</span> <span class="mi">8</span> <span class="mi">7</span><span class="p">)</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">])))</span>
</span></code></pre></td></tr></table></div></figure>


<p>First up <strong>clojure.test</strong>. Same issues as with all the previous
comparisons.</p>

<figure class='code'><figcaption><span>clojure.test</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">FAIL in (list-comparisons) (seq_test.clj:5)</span>
</span><span class='line'><span class="go">expected: (= (quote (1 2 3)) (quote (1 2 3 4)))</span>
</span><span class='line'><span class="go">  actual: (not (= (1 2 3) (1 2 3 4)))</span>
</span><span class='line'>
</span><span class='line'><span class="go">FAIL in (list-comparisons) (seq_test.clj:6)</span>
</span><span class='line'><span class="go">expected: (= (quote (1 2 4)) (quote (1 2 3)))</span>
</span><span class='line'><span class="go">  actual: (not (= (1 2 4) (1 2 3)))</span>
</span><span class='line'>
</span><span class='line'><span class="go">FAIL in (list-comparisons) (seq_test.clj:7)</span>
</span><span class='line'><span class="go">expected: (= (quote (9 8 7)) [1 2 3])</span>
</span><span class='line'><span class="go">  actual: (not (= (9 8 7) [1 2 3]))</span>
</span></code></pre></td></tr></table></div></figure>


<p>Once again <strong>humane-test-output</strong> improves upon <strong>clojure.test</strong>. Only
interesting difference from previous comparisons is that the diff view
ends up having <code>nil</code> values in it where the elements are the same.</p>

<figure class='code'><figcaption><span>clojure.test with humane-test-output</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">FAIL in (list-comparisons) (seq_test.clj:5)</span>
</span><span class='line'><span class="go">expected: (1 2 3)</span>
</span><span class='line'><span class="go">  actual: (1 2 3 4)</span>
</span><span class='line'><span class="go">    diff: + [nil nil nil 4]</span>
</span><span class='line'>
</span><span class='line'><span class="go">FAIL in (list-comparisons) (seq_test.clj:6)</span>
</span><span class='line'><span class="go">expected: (1 2 4)</span>
</span><span class='line'><span class="go">  actual: (1 2 3)</span>
</span><span class='line'><span class="go">    diff: - [nil nil 4]</span>
</span><span class='line'><span class="go">          + [nil nil 3]</span>
</span><span class='line'>
</span><span class='line'><span class="go">FAIL in (list-comparisons) (seq_test.clj:7)</span>
</span><span class='line'><span class="go">expected: (9 8 7)</span>
</span><span class='line'><span class="go">  actual: [1 2 3]</span>
</span><span class='line'><span class="go">    diff: - [9 8 7]</span>
</span><span class='line'><span class="go">          + [1 2 3]</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>expectations</strong> continues to have good output. It tries to help you out
as well. You&rsquo;ll notice that it also has <code>nil</code> values inserted
where the lists are the same.</p>

<figure class='code'><figcaption><span>expectations</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">failure in (list_expectations.clj:4) : example.list-expectations</span>
</span><span class='line'><span class="go">(expect &#39;(1 2 3) &#39;(1 2 3 4))</span>
</span><span class='line'>
</span><span class='line'><span class="go">           expected: (1 2 3)</span>
</span><span class='line'><span class="go">                was: (1 2 3 4)</span>
</span><span class='line'>
</span><span class='line'><span class="go">           in expected, not actual: null</span>
</span><span class='line'><span class="go">           in actual, not expected: [nil nil nil 4]</span>
</span><span class='line'><span class="go">           actual is larger than expected</span>
</span><span class='line'>
</span><span class='line'><span class="go">failure in (list_expectations.clj:5) : example.list-expectations</span>
</span><span class='line'><span class="go">(expect &#39;(1 2 4) &#39;(1 2 3))</span>
</span><span class='line'>
</span><span class='line'><span class="go">           expected: (1 2 4)</span>
</span><span class='line'><span class="go">                was: (1 2 3)</span>
</span><span class='line'>
</span><span class='line'><span class="go">           in expected, not actual: [nil nil 4]</span>
</span><span class='line'><span class="go">           in actual, not expected: [nil nil 3]</span>
</span><span class='line'>
</span><span class='line'><span class="go">failure in (list_expectations.clj:6) : example.list-expectations</span>
</span><span class='line'><span class="go">(expect &#39;(9 8 7) [1 2 3])</span>
</span><span class='line'>
</span><span class='line'><span class="go">           expected: (9 8 7)</span>
</span><span class='line'><span class="go">                was: [1 2 3]</span>
</span><span class='line'>
</span><span class='line'><span class="go">           in expected, not actual: [9 8 7]</span>
</span><span class='line'><span class="go">           in actual, not expected: [1 2 3]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Unsurprisingly, <strong>Speclj</strong> and <strong>Midje</strong> are better than <strong>clojure.test</strong> but
again don&rsquo;t go beyond making easy to find the expected and actual
values.</p>

<figure class='code'><figcaption><span>Speclj</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">  1) List/vector comparisons when there is an extra element</span>
</span><span class='line'><span class="go">     Expected: (1 2 3)</span>
</span><span class='line'><span class="go">          got: (1 2 3 4) (using =)</span>
</span><span class='line'><span class="go">     /Users/jake/src/jakemcc/example/spec/example/string_spec.clj:7</span>
</span><span class='line'>
</span><span class='line'><span class="go">  2) List/vector comparisons when there is a mismatched element</span>
</span><span class='line'><span class="go">     Expected: (1 2 4)</span>
</span><span class='line'><span class="go">          got: (1 2 3) (using =)</span>
</span><span class='line'><span class="go">     /Users/jake/src/jakemcc/example/spec/example/string_spec.clj:9</span>
</span><span class='line'>
</span><span class='line'><span class="go">  3) List/vector comparisons when comparing different types</span>
</span><span class='line'><span class="go">     Expected: (9 8 7)</span>
</span><span class='line'><span class="go">          got: [1 2 3] (using =)</span>
</span><span class='line'><span class="go">     /Users/jake/src/jakemcc/example/spec/example/string_spec.clj:11</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>Midje</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">FAIL &quot;lists are different sizes&quot; at (seq_test.clj:5)</span>
</span><span class='line'><span class="go">    Expected: (1 2 3)</span>
</span><span class='line'><span class="go">      Actual: (1 2 3 4)</span>
</span><span class='line'>
</span><span class='line'><span class="go">FAIL &quot;lists have different entries&quot; at (seq_test.clj:8)</span>
</span><span class='line'><span class="go">    Expected: (1 2 4)</span>
</span><span class='line'><span class="go">      Actual: (1 2 3)</span>
</span><span class='line'>
</span><span class='line'><span class="go">FAIL &quot;compare very different list like values&quot; at (seq_test.clj:14)</span>
</span><span class='line'><span class="go">    Expected: (9 8 7)</span>
</span><span class='line'><span class="go">      Actual: [1 2 3]</span>
</span></code></pre></td></tr></table></div></figure>


<h3>List Comparison Winner</h3>

<p>I find the <strong>clojure.test</strong> with <strong>humane-test-output</strong> to be a bit easier to
read than <strong>expectations</strong>. Both have better output than the basic
<strong>clojure.test</strong>, <strong>Speclj</strong>, and <strong>Midje</strong>.</p>

<h2>Overall Winner</h2>

<p>If I were picking a testing library based entirely on what a failing
test looks like I would use <strong>expectations</strong>. My second pick would be
<strong>clojure.test</strong> with <strong>humane-test-output</strong>.</p>

<p>It is great that Clojure ships with <strong>clojure.test</strong>. It is unfortunate
that it does so little to help you read a failing test. Every library
I tried has better output than <strong>clojure.test</strong>.</p>

<h3>Addendum</h3>

<p><em>Added 2014/06/23</em></p>

<p>Colin Jones
<a href="http://jakemccrary.com/blog/2014/06/22/comparing-clojure-testing-libraries-output/#comment-1449451549">points out</a>
that Speclj provides <code>should==</code>. <code>should==</code> checks that the expected
and actual value have the same contents. He provided a
<a href="https://gist.github.com/trptcolin/7e1ece5179581085730f">gist</a> that
shows the difference.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/05/31/quicker-feedback-from-failing-tests/">Quicker Feedback From Failing Tests</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-05-31T13:14:00-05:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>31</span><span class='date-suffix'>st</span>, <span class='date-year'>2014</span></span> <span class='time'>1:14 pm</span></time>
      </p>
    
  </header>


  <div class="entry-content"><p>Over the last couple of years I&rsquo;ve desired quicker feedback from my
Clojure tests. This has resulted in the development of
<a href="https://github.com/jakemcc/lein-autoexpect">lein-autoexpect</a> and more
recently
<a href="https://github.com/jakemcc/lein-test-refresh">lein-test-refresh</a>.
Each tool monitors your project for changes and on change uses
<a href="https://github.com/clojure/tools.namespace">tools.namespace</a> to
reload your code and then reruns either your
<a href="http://jayfields.com/expectations/">expectations</a> or <code>clojure.test</code>
tests. Using tools like these has changed my development process.</p>

<p>Version 0.5.0 of <strong>lein-test-refresh</strong> was released last week. This
release enables even quicker feedback by tracking which tests fail and
after reloading your code it runs those tests first. Only when your
previously failed tests pass does it then rerun all of your tests.</p>

<p><strong>lein-test-refresh</strong> has had quite a few features added since I last
wrote about it. The
<a href="https://github.com/jakemcc/lein-test-refresh/blob/master/README.md#features">readme</a>
will always have the latest list but as of the time of writing this
they include:</p>

<ul>
<li>Reloads code and reruns tests on changes to your project&rsquo;s code.</li>
<li>Runs previously failing tests first.</li>
<li>Supports
<a href="https://github.com/jakemcc/lein-test-refresh/blob/d6b2f2710ae94ae3270d92b0efd85d481717477b/sample.project.clj#L6-L9">custom notification</a>
commands.</li>
<li>Built in <a href="http://growl.info/">Growl</a> support.</li>
<li>Can notify after test success and failure or <a href="https://github.com/jakemcc/lein-test-refresh/blob/d6b2f2710ae94ae3270d92b0efd85d481717477b/sample.project.clj#L12">just after failure</a>.</li>
<li>Supports a
<a href="https://github.com/jakemcc/lein-test-refresh/blob/master/CHANGES.md#040">subset</a>
of Leiningen test selectors.</li>
<li>Reports on your tests running time.</li>
</ul>


<p>I don&rsquo;t have enough experience with the new <strong>lein-test-refresh</strong> to
say how having failing tests will affect my development practices. I
don&rsquo;t expect this to change my development practices but it will
enable quicker feedback. Quick feedback cycles are what it is all
about.</p>

<h3>Acknowledgments</h3>

<p>Most of the &lsquo;rerun failed tests first&rsquo; feature was hashed out and spiked
during a mob programming session organized by
<a href="http://www.zeespencer.com/">Zee Spencer</a>. This happened at a company
conference put on by <a href="http://www.outpace.com/">Outpace</a> in Las Vegas.
Many developers were involved but two that most influenced the final
result were <a href="https://github.com/noprompt">Joel Holdbrooks</a> and
<a href="https://github.com/timothypratley">Timothy Pratley</a>.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog//8">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog//6">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2020/03/10/more-working-from-home-tips/">More working from home tips</a>
      </li>
    
      <li class="post">
        <a href="/blog/2020/02/25/auto-syncing-a-git-repository/">Auto-syncing a git repository</a>
      </li>
    
      <li class="post">
        <a href="/blog/2020/01/11/reading-in-2019/">Reading in 2019</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/10/12/building-an-atreus-keyboard/">Building an Atreus keyboard</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/08/23/building-a-onewheel-stand/">Building a Onewheel stand</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/08/15/switching-my-ergodox-to-qmk-firmware/">Switching my Ergodox to QMK firmware</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/04/30/how-i-use-social-media/">How I use social media</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/03/20/breaking-change-and-more-in-lein-test-refresh-0-dot-24-dot-0/">Breaking change and more in lein-test-refresh 0.24.1</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/02/13/testing-asynchronous-javascript-with-jasmine/">Testing asynchronous JavaScript with Jasmine</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/01/28/how-to-use-leiningen-test-selectors-to-filter-by-test-name/">How to use Leiningen test selectors to filter by test name</a>
      </li>
    
  </ul>
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  <a href="/disclosure-policy">Disclosure Policy</a><br/>
  <a href="//www.iubenda.com/privacy-policy/509351" class="iubenda-nostyle iub-legal-only iubenda-embed" title="Privacy Policy">Privacy Policy</a><br/>
<script type="text/javascript">(function (w,d) {var loader = function () {var s = d.createElement("script"), tag = d.getElementsByTagName("script")[0]; s.src = "//cdn.iubenda.com/iubenda.js"; tag.parentNode.insertBefore(s,tag);}; if(w.addEventListener){w.addEventListener("load", loader, false);}else if(w.attachEvent){w.attachEvent("onload", loader);}else{w.onload = loader;}})(window, document);</script>
  Content licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/3.0/">Creative Commons Attribution-NonCommercial 3.0 Unported License</a>.
</p>


</footer>
  


</body>
</html>
