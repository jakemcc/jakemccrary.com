
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="iem7"><![endif]-->
<!--[if lt IE 9]><html class="lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html lang="en"><!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <title>Using Incanter to review my 2013 reading - Jake McCrary</title>
    <meta name="author" content="Jake McCrary">

    
    
    
    

    <meta itemprop="name" content="Using Incanter to review my 2013 reading" />
    <meta itemprop="description" content=" I use goodreads to keep track of
my reading
and have since early 2010. I find very useful for capturing what I
want to read and reminding me of how I &hellip;" />

    <!-- Twitter Card data -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@jakemcc" />
    <meta name="twitter:title" content="Using Incanter to review my 2013 reading" />
    <meta name="twitter:description" content=" I use goodreads to keep track of
my reading
and have since early 2010. I find very useful for capturing what I
want to read and reminding me of how I &hellip;" />
    <meta name="twitter:creator" content="@jakemcc" />
    <meta name="twitter:image" content="https://jakemccrary.com/images/jake-surprised-eyes-brighter.jpg" />

    <!-- Open Graph data -->
    <meta property="og:site_name" content="The Blog of Jake McCrary" />
    <meta property="og:url" content="https://jakemccrary.com/blog/2014/01/01/using-incanter-to-review-my-2013-reading/" />
    <meta property="og:title" content="Using Incanter to review my 2013 reading" />
    <meta property="og:description" content=" I use goodreads to keep track of
my reading
and have since early 2010. I find very useful for capturing what I
want to read and reminding me of how I &hellip;" />
    <meta property="og:image" content="https://jakemccrary.com/images/jake-surprised-eyes-brighter.jpg" />
    
      <meta property="og:type" content="article" />
    
    
      <meta property="article:published_time" content="2014-01-01T17:31:00-06:00" />
    

    <meta name="description" content=" I use goodreads to keep track of
my reading
and have since early 2010. I find very useful for capturing what I
want to read and reminding me of how I &hellip;">

    

    <!-- http://t.co/dKP3o1e -->
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="canonical" href="https://jakemccrary.com/blog/2014/01/01/using-incanter-to-review-my-2013-reading/">
    <link href="/favicon.png" rel="icon">
    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="http://feeds.feedburner.com/JakeMccrarysMusings" rel="alternate" title="Jake McCrary" type="application/atom+xml">
    <link href="https://jakemccrary.com/feed.json" rel="alternate" title="Jake McCrary" type="application/json">

    <!-- iOS scaling bug fix Rewritten version By @mathias, @cheeaun and @jdalton Source url: https://gist.github.com/901295 -->
    <script type="text/javascript">
     (function(doc) {
       var addEvent = 'addEventListener',
           type = 'gesturestart',
           qsa = 'querySelectorAll',
           scales = [1, 1],
           meta = qsa in doc ? doc[qsa]('meta[name=viewport]') : [];
       function fix() {
         meta.content = 'width=device-width,minimum-scale=' + scales[0] + ',maximum-scale=' + scales[1];
         doc.removeEventListener(type, fix, true);
       }
       if ((meta = meta[meta.length - 1]) && addEvent in doc) {
         fix();
         scales = [0.25, 1.6];
         doc[addEvent](type, fix, true);
       }
     }(document));
    </script>
    
<script>
 var origin = window.location.origin;
 if (!origin) {
   origin = window.location.protocol + '//' + window.location.hostname + (window.location.port ? (':' + window.location.port) : '');
 }
 if (origin.indexOf('localhost') === -1) {
   (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
   })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

   ga('create', 'UA-19834208-2', 'auto');
   ga('send', 'pageview');
 }
</script>


  </head>

<body  >
  <header role="banner"><hgroup>
  <h1><a href="/">Jake McCrary</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul role=main-navigation>
  <li><a href="/">Articles</a></li>
  <li><a href="/adventures/">Adventures</a></li>
  <li><a href="/about.html">About</a></li>
  <li><a href="/blog/archives/">Archives</a></li>
  <li><a href="http://feeds.feedburner.com/JakeMccrarysMusings" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
</ul>

  <form action="https://google.com/search" method="get">
    <fieldset role="search">
      <input type="hidden" name="sitesearch" value="jakemccrary.com">
      <input class="search" type="text" name="q" placeholder="Search"/>
    </fieldset>
  </form>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Using Incanter to review my 2013 reading</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-01-01T17:31:00-06:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>1</span><span class='date-suffix'>st</span>, <span class='date-year'>2014</span></span> <span class='time'>5:31 pm</span></time>
      </p>
    
  </header>


  <div class="entry-content"><p>I use <a href="https://goodreads.com">goodreads</a> to keep track of
<a href="https://www.goodreads.com/user/show/3431614-jake-mccrary">my reading</a>
and have since early 2010. I find very useful for capturing what I
want to read and reminding me of how I felt about books I&rsquo;ve read. I
thought it would be fun to take a closer look at what I read in 2013.
I&rsquo;m doing this using <a href="http://clojure.org/">Clojure</a> with
<a href="http://incanter.org/">Incanter</a>. I haven&rsquo;t used Incanter since I
wrote
<a href="http://jakemccrary.com/blog/2010/02/21/plotting-time-series-data-with-incanter/">this</a>
post and thought this would be a good opportunity to visit it again.</p>

<p>First I need to get my data out of goodreads. I&rsquo;ve worked with the
Goodreads API before <sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup> but am not going to use it for this
exercise. Instead I&rsquo;m using the goodreads export functionality (at
goodreads follow the links: My Books > import/export) to export a csv
file. Having the csv file also lets me cleanup some of the data since
some of the book&rsquo;s page counts were missing <sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>.</p>

<p>Now that I have data it is time to start playing with it. Run <code>lein new goodreads-summary</code> and edit the <code>project.clj</code> file to have a dependency on Incanter.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defproject </span><span class="nv">goodreads-summary</span> <span class="s">&quot;0.1.0-SNAPSHOT&quot;</span>
</span><span class='line'>  <span class="ss">:dependencies</span> <span class="p">[[</span><span class="nv">org.clojure/clojure</span> <span class="s">&quot;1.5.1&quot;</span><span class="p">]</span>
</span><span class='line'>                 <span class="p">[</span><span class="nv">org.clojure/data.csv</span> <span class="s">&quot;0.1.2&quot;</span><span class="p">]</span>
</span><span class='line'>                 <span class="p">[</span><span class="nv">incanter</span> <span class="s">&quot;1.5.4&quot;</span><span class="p">]</span>
</span><span class='line'>                 <span class="p">[</span><span class="nv">clj-time</span> <span class="s">&quot;0.6.0&quot;</span><span class="p">]])</span>
</span></code></pre></td></tr></table></div></figure>


<p>Next I&rsquo;m going to take the csv file and transform it into an Incanter
dataset. This is easily done with
<a href="http://liebke.github.io/incanter/io-api.html#incanter.io/read-dataset">incanter.io/read-dataset</a>.
It isn&rsquo;t well documented but by passing <code>:keyword-headers false</code> to
<code>read-dataset</code> the headers from the csv are not converted to keywords.
I&rsquo;m doing this because some of the goodreads headers contain spaces
and dealing with spaces in keywords is a pain. The snippet below has
all of the necessary requires for the remainder of the examples.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">ns </span><span class="nv">goodreads-summary.core</span>
</span><span class='line'>  <span class="p">(</span><span class="ss">:require</span> <span class="p">[</span><span class="nv">clojure.data.csv</span> <span class="ss">:as</span> <span class="nv">csv</span><span class="p">]</span>
</span><span class='line'>            <span class="p">[</span><span class="nv">clojure.string</span> <span class="ss">:as</span> <span class="nv">str</span><span class="p">]</span>
</span><span class='line'>            <span class="p">[</span><span class="nv">incanter.core</span> <span class="ss">:as</span> <span class="nv">incanter</span><span class="p">]</span>
</span><span class='line'>            <span class="p">[</span><span class="nv">incanter.io</span> <span class="ss">:as</span> <span class="nv">io</span><span class="p">]</span>
</span><span class='line'>            <span class="p">[</span><span class="nv">incanter.charts</span> <span class="ss">:as</span> <span class="nv">charts</span><span class="p">]</span>
</span><span class='line'>            <span class="p">[</span><span class="nv">clj-time.core</span> <span class="ss">:as</span> <span class="nv">tc</span><span class="p">]</span>
</span><span class='line'>            <span class="p">[</span><span class="nv">clj-time.format</span> <span class="ss">:as</span> <span class="nv">tf</span><span class="p">]))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">read-csv</span> <span class="p">[</span><span class="nv">filepath</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">io/read-dataset</span> <span class="nv">filepath</span> <span class="ss">:header</span> <span class="nv">true</span> <span class="ss">:keyword-headers</span> <span class="nv">false</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>Calling <code>read-csv</code> with the path to the exported goodreads data
results in dataset. If you want to view the data use
<a href="http://liebke.github.io/incanter/core-api.html#incanter.core/view">incanter.core/view</a>.
Running <code>(incanter/view (read-csv "goodreads_export.csv"))</code> pops up a
grid of with all the data. I don&rsquo;t care about most of the columns so
lets define a function that selects out the few I care about.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">select-columns</span> <span class="p">[</span><span class="nv">dataset</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">incanter/sel</span> <span class="nv">dataset</span> <span class="ss">:cols</span> <span class="p">[</span><span class="s">&quot;Number of Pages&quot;</span> <span class="s">&quot;Date Read&quot;</span> <span class="s">&quot;Bookshelves&quot;</span> <span class="s">&quot;Exclusive Shelf&quot;</span><span class="p">]))</span>
</span></code></pre></td></tr></table></div></figure>


<p>Selecting columns is done with
<a href="http://liebke.github.io/incanter/core-api.html#incanter.core/sel">incanter.core/sel</a>.
Like most Incanter functions it has many overloads. One way to use it
is to pass a dataset with a vector of columns you want to select.</p>

<p>Filtering a dataset is done using
<a href="http://liebke.github.io/incanter/core-api.html#incanter.core/$where">incanter.core/$where</a>.
Goodreads has three default shelves <strong>to-read</strong>,
<strong>currently-reading</strong>, and <strong>read</strong>. To select all your read books you
filter of the <strong>Exclusive Shelf</strong> column for <strong>read</strong> books.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">finished</span> <span class="p">[</span><span class="nv">dataset</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">incanter/$where</span> <span class="p">{</span><span class="s">&quot;Exclusive Shelf&quot;</span> <span class="s">&quot;read&quot;</span><span class="p">}</span> <span class="nv">dataset</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>Filtering for books read in 2013 is a bit more complicated. First I
convert the <strong>Date Read</strong> column from a string to a
<code>org.joda.time.DateTime</code>. This is done with the combination of
<code>transform-date-read-column</code> and <code>parse-date</code>. Some of the my data is missing a <strong>Date Read</strong> value. I&rsquo;m choosing to handle this by treating missing data as the result of <code>(clj-time.core/date-time 0)</code>.</p>

<p>The <code>$where</code> in <code>books-read-in-2013</code> is a bit more complicated than
the filtering in <code>finished</code>. Here I&rsquo;m providing a predicate to
use instead of just doing an equality comparison.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">parse-date</span> <span class="p">[</span><span class="nv">date-str</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="k">if </span><span class="nv">date-str</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">tf/parse</span> <span class="p">(</span><span class="nf">tf/formatter</span> <span class="s">&quot;yyyy/MM/dd&quot;</span><span class="p">)</span> <span class="nv">date-str</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">tc/date-time</span> <span class="mi">0</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">transform-date-read-column</span> <span class="p">[</span><span class="nv">dataset</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">incanter/transform-col</span> <span class="nv">dataset</span> <span class="s">&quot;Date Read&quot;</span> <span class="nv">parse-date</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">date-greater-than-pred</span> <span class="p">[</span><span class="nv">date</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">challenger</span><span class="p">]</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">&gt; </span><span class="p">(</span><span class="nf">.compareTo</span> <span class="nv">challenger</span> <span class="nv">date</span><span class="p">)</span> <span class="mi">0</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">books-read-in-2013</span> <span class="p">[</span><span class="nv">dataset</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">finished</span> <span class="p">(</span><span class="nf">finished</span> <span class="p">(</span><span class="nf">select-columns</span> <span class="nv">dataset</span><span class="p">))</span>
</span><span class='line'>        <span class="nv">with-dates</span> <span class="p">(</span><span class="nf">incanter/$where</span> <span class="p">{</span><span class="s">&quot;Date Read&quot;</span> <span class="p">{</span><span class="ss">:fn</span> <span class="nv">identity</span><span class="p">}}</span> <span class="nv">finished</span><span class="p">)</span>
</span><span class='line'>        <span class="nv">with-date-objects</span> <span class="p">(</span><span class="nf">transform-date-read-column</span> <span class="nv">with-dates</span><span class="p">)]</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">incanter/$where</span> <span class="p">{</span><span class="s">&quot;Date Read&quot;</span> <span class="p">{</span><span class="ss">:fn</span> <span class="p">(</span><span class="nf">date-greater-than-pred</span> <span class="p">(</span><span class="nf">parse-date</span> <span class="s">&quot;2012/12/31&quot;</span><span class="p">))}}</span>
</span><span class='line'>                     <span class="nv">with-date-objects</span><span class="p">)))</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now we have a dataset that that contains only books read in 2013
(well, until I read a book in 2014 and the filter above also grabs
books in 2014). Now to generate some analytic for each month. First
lets add a <strong>Month</strong> column to our data. Originally I wrote the
function below. It uses <code>incanter.core/$map</code> to generate the data,
makes a dataset with the new data, and then adds that to the original
dataset.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">add-month-read-column</span> <span class="p">[</span><span class="nv">dataset</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">month-read</span> <span class="p">(</span><span class="nf">incanter/$map</span> <span class="nv">tc/month</span> <span class="s">&quot;Date Read&quot;</span> <span class="nv">dataset</span><span class="p">)</span>
</span><span class='line'>        <span class="nv">month-dataset</span> <span class="p">(</span><span class="nf">incanter/dataset</span> <span class="p">[</span><span class="s">&quot;Month&quot;</span><span class="p">]</span> <span class="nv">month-read</span><span class="p">)</span>
</span><span class='line'>        <span class="nv">with-month-read</span> <span class="p">(</span><span class="nf">incanter/conj-cols</span> <span class="nv">dataset</span> <span class="nv">month-dataset</span><span class="p">)]</span>
</span><span class='line'>    <span class="nv">with-month-read</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>When I wrote the above code it seemed like there should be a better
way. While writing this post I stumbled across
<a href="http://liebke.github.io/incanter/core-api.html#incanter.core/add-derived-column">incanter.core/add-derived-column</a>.
Switching to <code>add-derived-column</code> makes <code>add-month-read-column</code> almost trivial.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">add-month-read-column</span> <span class="p">[</span><span class="nv">dataset</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">incanter/add-derived-column</span> <span class="s">&quot;Month&quot;</span> <span class="p">[</span><span class="s">&quot;Date Read&quot;</span><span class="p">]</span> <span class="nv">tc/month</span> <span class="nv">dataset</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now that we have <code>add-month-read-column</code>  we can now start aggregating
some stats. Lets write code for calculating the pages read per month.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">pages-by-month</span> <span class="p">[</span><span class="nv">dataset</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">with-month-read</span> <span class="p">(</span><span class="nf">add-month-read-column</span> <span class="nv">dataset</span><span class="p">)]</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">-&gt;&gt;</span> <span class="p">(</span><span class="nf">incanter/$rollup</span> <span class="ss">:sum</span> <span class="s">&quot;Number of Pages&quot;</span> <span class="s">&quot;Month&quot;</span> <span class="nv">with-month-read</span><span class="p">)</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">incanter/$order</span> <span class="s">&quot;Month&quot;</span> <span class="ss">:asc</span><span class="p">))))</span>
</span></code></pre></td></tr></table></div></figure>


<p>That was pretty easy. Lets write a function to count the number of books read per month.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">book-count-by-month</span> <span class="p">[</span><span class="nv">dataset</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">with-month-read</span> <span class="p">(</span><span class="nf">add-month-read-column</span> <span class="nv">dataset</span><span class="p">)]</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">-&gt;&gt;</span> <span class="p">(</span><span class="nf">incanter/$rollup</span> <span class="ss">:count</span> <span class="s">&quot;Number of books&quot;</span> <span class="s">&quot;Month&quot;</span> <span class="nv">with-month-read</span><span class="p">)</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">incanter/$order</span> <span class="s">&quot;Month&quot;</span> <span class="ss">:asc</span><span class="p">))))</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>pages-by-month</code> and <code>book-count-by-month</code> are very similar. Each uses <a href="http://liebke.github.io/incanter/core-api.html#incanter.core/$rollup">incanter.core/$rollup</a> to calculate per month stats. The first argument to <code>$rollup</code> can be a function that takes a sequence of values or one of the supported magical &ldquo;function identifier keywords&rdquo;.</p>

<p>Next lets combine the data together so we can print out a nice table. While we are at it lets add another column.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">stats-by-month</span> <span class="p">[</span><span class="nv">dataset</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">-&gt;&gt;</span> <span class="p">(</span><span class="nf">incanter/$join</span> <span class="p">[</span><span class="s">&quot;Month&quot;</span> <span class="s">&quot;Month&quot;</span><span class="p">]</span>
</span><span class='line'>                     <span class="p">(</span><span class="nf">pages-by-month</span> <span class="nv">dataset</span><span class="p">)</span>
</span><span class='line'>                     <span class="p">(</span><span class="nf">book-count-by-month</span> <span class="nv">dataset</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">incanter/rename-cols</span> <span class="p">{</span><span class="s">&quot;Number of Pages&quot;</span> <span class="s">&quot;Page Count&quot;</span>
</span><span class='line'>                              <span class="s">&quot;Number of books&quot;</span> <span class="s">&quot;Book Count&quot;</span><span class="p">})</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">incanter/add-derived-column</span> <span class="s">&quot;Pages/Books&quot;</span>
</span><span class='line'>                                  <span class="p">[</span><span class="s">&quot;Page Count&quot;</span> <span class="s">&quot;Book Count&quot;</span><span class="p">]</span>
</span><span class='line'>                                  <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">p</span> <span class="nv">b</span><span class="p">]</span> <span class="p">(</span><span class="nf">Math/round</span> <span class="p">(</span><span class="nb">double </span><span class="p">(</span><span class="nb">/ </span><span class="nv">p</span> <span class="nv">b</span><span class="p">)))))))</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>stats-by-month</code> returns a dataset which when printed looks like the following table. It joins the data, renames columns, and adds a derived column.</p>

<pre><code>| Month | Book Count | Page Count | Pages/Books |
|-------+------------+------------+-------------|
|     1 |          6 |       1279 |         213 |
|     2 |          2 |       1251 |         626 |
|     3 |          8 |       2449 |         306 |
|     4 |          5 |       1667 |         333 |
|     5 |          6 |       2447 |         408 |
|     6 |          5 |       1609 |         322 |
|     7 |          5 |       1445 |         289 |
|     8 |          5 |       2229 |         446 |
|     9 |          2 |        963 |         482 |
|    10 |          5 |       1202 |         240 |
|    11 |          5 |       2248 |         450 |
|    12 |          7 |       1716 |         245 |
</code></pre>

<p>Great. Now we have a little ascii table. Lets get graphical and make some bar charts.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">chart-column-by-month</span> <span class="p">[</span><span class="nv">column</span> <span class="nv">dataset</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nb">select </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">column</span><span class="p">]</span> <span class="p">(</span><span class="nf">incanter/sel</span> <span class="nv">dataset</span> <span class="ss">:cols</span> <span class="nv">column</span><span class="p">))</span>
</span><span class='line'>        <span class="nv">months</span> <span class="p">(</span><span class="nb">select </span><span class="s">&quot;Month&quot;</span><span class="p">)]</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">charts/bar-chart</span> <span class="nv">months</span> <span class="p">(</span><span class="nb">select </span><span class="nv">column</span><span class="p">)</span>
</span><span class='line'>                      <span class="ss">:y-label</span> <span class="nv">column</span> <span class="ss">:x-label</span> <span class="s">&quot;Month&quot;</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">chart-page-count-by-month</span> <span class="p">[</span><span class="nv">dataset</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">chart-column-by-month</span> <span class="s">&quot;Page Count&quot;</span> <span class="nv">dataset</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">chart-book-count-by-month</span> <span class="p">[</span><span class="nv">dataset</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">chart-column-by-month</span> <span class="s">&quot;Book Count&quot;</span> <span class="nv">dataset</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">view-page-count-chart</span> <span class="p">[]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">-&gt; </span><span class="p">(</span><span class="nf">read-csv</span> <span class="s">&quot;goodreads_export.csv&quot;</span><span class="p">)</span>
</span><span class='line'>      <span class="nv">books-read-in-2013</span>
</span><span class='line'>      <span class="nv">stats-by-month</span>
</span><span class='line'>      <span class="nv">chart-page-count-by-month</span>
</span><span class='line'>      <span class="nv">incanter/view</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>Running the snippet <code>view-page-count-chart</code> produces a pop-up with the
below bar chart. The chart actually surprises me as I fully expected
to have higher page counts during the winter months than the summer
months. This chart and analysis is pretty useless though without
knowing the difficulty of the pages read. For example, last February I
read
<a href="http://www.amazon.com/gp/product/0316920045/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=0316920045&amp;linkCode=as2&amp;tag=jakemccrary08-20&amp;linkId=RTXH5NFJLAODUEBP">Infinite Jest</a>.
Knowing that I don&rsquo;t feel like having a low page count in that month
is slacking at all.</p>

<p><img src="/images/page-count-by-month.png" title="Bar chart of total page count by month" alt="Bar chart of total page count by month" /></p>

<h3>2013 Summary</h3>

<p>2013 was a pretty big year of reading. I read more books this past
year than all other years that I have data. I also read some of the
best books I&rsquo;ve ever read. Not only that but I actually created
multiple <sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup> custom Kindle dictionaries to help improve my (and
others) reading experience.</p>

<p>Summary table <sup id="fnref:4"><a href="#fn:4" rel="footnote">4</a></sup>:</p>

<pre><code>|   :shelf | :books | :pages |
|----------+--------+--------|
| non-tech |     51 |  17798 |
|     tech |     10 |   2707 |
|     read |     61 |  20505 |
</code></pre>

<h3>Plans for 2014</h3>

<p>I&rsquo;m planning on reading a similar amount in this upcoming year but
will probably have a bit more non-fiction books. First step towards doing
that is to start classifying my books as non-fiction or fiction. I&rsquo;m
also planning on rereading at least two books that I&rsquo;ve read in the
last few years. This is unusual for me because I don&rsquo;t often reread
books that quickly.</p>

<p>If you have any book recommendations feel free to leave them in the
comments or contact me through twitter or email.</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>A project on Heroku that takes your to-read list from goodreads and queries the Chicago Public Library to see if books are available. Someday I&rsquo;ll give it some love and make it usable by others.<a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
<li id="fn:2">
<p>I&rsquo;ve also applied to be a goodreads librarian so I can actually fix their data as well.<a href="#fnref:2" rev="footnote">&#8617;</a></p></li>
<li id="fn:3">
<p>One for <a href="http://jakemccrary.com/blog/2013/07/09/releasing-the-functional-javascript-companion/">Functional JavaScript</a> and another for <a href="http://gum.co/dune-dictionary">Dune</a>. If you want a custom Kindle dictionary made feel free to reach out.<a href="#fnref:3" rev="footnote">&#8617;</a></p></li>
<li id="fn:4">
<p>tech shelf only includes programming books.<a href="#fnref:4" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Jake McCrary</span></span>

      




<time class='entry-date' datetime='2014-01-01T17:31:00-06:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>1</span><span class='date-suffix'>st</span>, <span class='date-year'>2014</span></span> <span class='time'>5:31 pm</span></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/books/'>books</a>, <a class='category' href='/blog/categories/clojure/'>clojure</a>, <a class='category' href='/blog/categories/incanter/'>incanter</a>
  
</span>


    </p>
    
      <div class="sharing">
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2013/12/14/book-review-clojure-high-performance-programming/" title="Previous Post: Book Review: Clojure High Performance Programming">&laquo; Book Review: Clojure High Performance Programming</a>
      
      
        <a class="basic-alignment right" href="/blog/2014/01/12/releasing-lein-test-refresh-0-dot-3-0/" title="Next Post: Releasing lein-test-refresh 0.3.0">Releasing lein-test-refresh 0.3.0 &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite">

  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <div id="disqus_target" >
    <script>
     var insertDisqus = function() {
       var elem = document.createElement('script');
       elem.innerHTML =  "var disqus_shortname = 'jakemccrary'; var disqus_identifier = 'https://jakemccrary.com/blog/2014/01/01/using-incanter-to-review-my-2013-reading/'; var disqus_url = 'https://jakemccrary.com/blog/2014/01/01/using-incanter-to-review-my-2013-reading/'; (function () {var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);}());"
       var target = document.getElementById('disqus_target');
       target.parentNode.replaceChild(elem, target);
     }
    </script>
    <button class="comment-button" onclick="insertDisqus()"><span>ENABLE COMMENTS AND RECOMMENDED ARTICLES</span></button>
  </div>

</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2020/01/11/reading-in-2019/">Reading in 2019</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/10/12/building-an-atreus-keyboard/">Building an Atreus keyboard</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/08/23/building-a-onewheel-stand/">Building a Onewheel stand</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/08/15/switching-my-ergodox-to-qmk-firmware/">Switching my Ergodox to QMK firmware</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/04/30/how-i-use-social-media/">How I use social media</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/03/20/breaking-change-and-more-in-lein-test-refresh-0-dot-24-dot-0/">Breaking change and more in lein-test-refresh 0.24.1</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/02/13/testing-asynchronous-javascript-with-jasmine/">Testing asynchronous JavaScript with Jasmine</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/01/28/how-to-use-leiningen-test-selectors-to-filter-by-test-name/">How to use Leiningen test selectors to filter by test name</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/01/27/how-to-display-a-message-to-all-tmux-clients/">How to display a message to all tmux clients</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/01/21/reading-in-2018/">Reading in 2018</a>
      </li>
    
  </ul>
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  <a href="/disclosure-policy">Disclosure Policy</a><br/>
  <a href="//www.iubenda.com/privacy-policy/509351" class="iubenda-nostyle iub-legal-only iubenda-embed" title="Privacy Policy">Privacy Policy</a><br/>
<script type="text/javascript">(function (w,d) {var loader = function () {var s = d.createElement("script"), tag = d.getElementsByTagName("script")[0]; s.src = "//cdn.iubenda.com/iubenda.js"; tag.parentNode.insertBefore(s,tag);}; if(w.addEventListener){w.addEventListener("load", loader, false);}else if(w.attachEvent){w.attachEvent("onload", loader);}else{w.onload = loader;}})(window, document);</script>
  Content licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/3.0/">Creative Commons Attribution-NonCommercial 3.0 Unported License</a>.
</p>


</footer>
  


</body>
</html>
