<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <title>Speeding up my blog - Jake McCrary</title>
  <meta name="author" content="">
  <!-- <link rel="stylesheet" href="/style.css"> -->

  <meta itemprop="name" content="Speeding up my blog - Jake McCrary" />
  
  <meta itemprop="description" content="In an effort to improve my readers&#39; experience I made my Octopress blog load significantly faster." />
  

  <!-- Twitter Card data -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@jakemcc" />
  <meta name="twitter:title" content="Speeding up my blog - Jake McCrary" />
  
  <meta name="twitter:description" content="In an effort to improve my readers&#39; experience I made my Octopress blog load significantly faster." />
  
  <meta name="twitter:creator" content="@jakemcc" />
  <!-- <meta name="twitter:image" content="" /> -->

  <!-- Open Graph data -->
  <meta property="og:site_name" content="Writing by Jake McCrary" />
  <meta property="og:url" content="https://jakemccrary.com//blog/2016/04/30/speeding-up-my-blog/" />
  <meta property="og:title" content="Speeding up my blog - Jake McCrary" />
  
  <meta property="og:description" content="In an effort to improve my readers&#39; experience I made my Octopress blog load significantly faster." />
  
  <!-- <meta property="og:image" content="" /> -->
  
  <meta property="og:type" content="article" />
  
  
  <!-- maybe rfc blahblahblah it? -->
  <meta property="article:published_time" content="2016-04-30T23:59:59+00:00" />
  

  <link rel="canonical" href="https://jakemccrary.com//blog/2016/04/30/speeding-up-my-blog/">

  <style>
   body {
     font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
     max-width: 1200px;
     margin: 0 auto;
     padding: 1rem;
     line-height: 1.5;
   }

   header {
     margin-bottom: 0.5rem;
   }

   header h1 {
     margin: 0;
     font-size: 2.5rem;
   }

   header h1 a {
     color: #333;
     text-decoration: none;
   }

   .main-nav {
     display: flex;
     align-items: center;
     justify-content: space-between;
     padding: 0.5rem 0;
     margin-bottom: 2rem;
   }

   .nav-list {
     display: flex;
     list-style: none;
     margin: 0;
     padding: 0;
     gap: 1.5rem;
   }

   .nav-list a {
     text-decoration: none;
     color: #333;
   }

   .search-form fieldset {
     border: none;
     margin: 0;
     padding: 0;
   }

   .search {
     padding: 0.5rem;
     border: none;
     background: #f5f5f5;
     border-radius: 4px;
   }

   /* Blog post list styling */
   .post-list {
     list-style: none;
     padding: 0;
     margin: 0;
   }

   .post-list li {
     margin-bottom: 1.5rem;
   }

   .post-meta {
     margin-bottom: 0.25rem;
   }

   .post-meta time {
     color: #666;
     margin-right: 0.5rem;
   }

   .post-list h2 {
     display: inline;
     font-size: 1.1rem;
     font-weight: 500;
     margin: 0;
   }

   .post-list h2 a {
     color: #0066cc;
     text-decoration: none;
   }

   .post-list h2 a:hover {
     text-decoration: underline;
   }

   .post-description {
     color: #444;
     margin: 0.25rem 0 0 0;
     line-height: 1.6;
   }

   .right {
     float: right;
   }
   .left {
     float: left;
   }
   .mr1 {
     margin-right: 1em;
   }
   /* Style the footnote references in the text */
   [id^="fnref"] sup {
     font-size: 0.75em;
     line-height: 0;
     position: relative;
     top: -0.5em;
     padding: 0 0.3em;
   }

   [id^="fnref"] a {
     text-decoration: none;
     background-color: #f3f4f6;
     color: #4b5563;
     border-radius: 3px;
     padding: 2px 6px;
     transition: all 0.2s ease;
   }

   [id^="fnref"] a:hover {
     background-color: #e5e7eb;
     color: #1f2937;
   }

   /* Style the footnotes section */
   .footnotes {
     margin-top: 3rem;
     padding-top: 2rem;
     border-top: 2px solid #e5e7eb;
   }

   /* Create custom numbering for footnotes */
   .footnotes li {
     margin-bottom: 1rem;
     color: #4b5563;
   }
   
   /* Style the return links in footnotes */
   .footnotes li a[href^="#fnref"] {
     text-decoration: none;
     color: #6b7280;
     margin-left: 0.5rem;
     font-size: 0.875rem;
     transition: color 0.2s ease;
   }

   .footnotes li a[href^="#fnref"]:hover {
     color: #374151;
   }

   blockquote {
     border-left: 4px solid #d1d5db;
     padding-left: 1em;
     margin-left: 1em;
     color: #4b5563;
     font-style: italic;
     background-color: #f9fafb;
   }

   figure {
     margin: 1rem 0;
     text-align: center;
   }

   figcaption {
     color: #666;
     font-size: 0.9em;
     margin-top: 0.5rem;
     font-style: italic;
   }

   .page-header h1 {
     margin: 0
   }

   .page-header .publication-date {
     color: #666;
     font-size: 0.8em;
     margin: 0;
   }

   body > footer {
     font-size: .8em;
	   color: #888;
     margin-top: 1em;
	   padding-top: 1em;
     padding-bottom: 1em;
   }
   p code, li code {
     display: inline-block;
     white-space: nowrap;
     border: 1px solid #ddd;
     -moz-border-radius: .4em;
     -webkit-border-radius: .4em;
     border-radius: .4em;
     padding: 0 .3em;
     margin: -1px 0;
   }

  </style>
  <link rel="stylesheet" href="/highlight/base16/tomorrow-night.min.css">
</head>
<body>
<header>
    <h1><a href="/">Jake McCrary</a></h1>
  </header>
  <nav role="navigation" class="main-nav">
    <ul role="main-navigation" class="nav-list">
      <li><a href="/">Articles</a></li>
      <li><a href="/adventures/">Adventures</a></li>
      <li><a href="/about.html">About</a></li>
      <li><a href="/blog/archives/">Archives</a></li>
      <li><a href="http://feeds.feedburner.com/JakeMccrarysMusings" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
      <li><a href="https://jakemccrary.substack.com/welcome" target="_blank" rel="subscribe-email" title="subscribe via email">Newsletter</a></li>
    </ul>
    <form class="search-form" action="https://google.com/search" method="get">
      <fieldset role="search">
        <input type="hidden" name="sitesearch" value="jakemccrary.com">
        <input class="search" type="text" name="q" placeholder="Search">
      </fieldset>
    </form>
  </nav>
  
  <div class="page-header">
    <h1>Speeding up my blog</h1>
    
    
    <p class="publication-date">Published on 
      <time datetime="2016-04-30">April 30, 2016</time>
    </p>
    
  </div>
  

  <p>I was recently reading <a href='https://jefframnani.com/about/'>Jeff Ramnani's</a> <i>about</i> page and I was somewhat inspired by it. It loads quickly and links to <a href='http://mattgemmell.com/designing-blogs-for-readers/'>Designing blogs for readers</a>, an interesting essay by Matt Gemmmell. Reading that essay inspired me to think about my own site and what experience I want to deliver to readers.</p><p>I can't imagine what every reader wants but I know what I want to experience when I read an article online. Reading high quality content is my highest priority. Beyond that I enjoy when a page loads fast and the visual design doesn't get in the way. I think a great example of these two requirements is <a href='http://zenhabits.net/falling/'>zen habits</a> (along with Jeff Ramnani's and Matt Gemmell's).</p><p>My own site sort of achieves those goals. I like to think I'm writing well-written content that helps others. I know it has helped me. With regards to visual design I think there is room for improvement. I don't think my site's design is actively distracting from the content though, so I've decided to focus on improving the page load time first.</p><h2>The optimization process</h2><p>As with any optimization problem it is important figure what you're going to measure, how you're going to measure it and your starting point. I decided to focus on my page load time, as measured by <a href='http://www.webpagetest.org'>Web Page Test</a>. I used Google's <a href='https://developers.google.com/speed/pagespeed/insights/'>PageSpeed Insights</a> to score and provide helpful tips for improving page speed. Unfortunately I didn't capture my starting point with PageSpeed Insights but I think I was scoring around a 66/100 for mobile and 79/100 for desktop.</p><p><img src="/images/before-optimizations.png" alt="Starting point from Web Page Test" /></p><p>As measured by Web Page Test, the first load of my main page took five seconds and it wasn't fully loaded for another second. This is ridiculous. My page is almost entirely static content and most of my assets are served from CloudFlare. It should be blazing fast.</p><p>Next I looked at what was actually being loaded. Google's PageSpeed Insights identified that I had three render-blocking <code>script</code> tags. The offending scripts were Modernizr, jQuery, and octopress.js. PageSpeed Insights <a href='https://developers.google.com/speed/docs/insights/BlockingJS#overview'>recommends</a> inlining JavaScript required to render the page or make loading asynchronous. I decided to go a step further and remove the need for the JavaScript.</p><h3>Removing octopress.js</h3><p>It turns out <code>octopress.js</code> was the reason Modernizr and jQuery were required. Most of what <a href='https://github.com/jakemcc/jakemccrary.com/blob/c27a131aef437181dcab9552c3241f8adafb3884/source/javascripts/octopress.js'>octopress.js</a> did were things that I don't need; some sort of <a href='https://github.com/jakemcc/jakemccrary.com/blob/c27a131aef437181dcab9552c3241f8adafb3884/source/javascripts/octopress.js#L111'>flash video fallback</a>, adding line numbers to <a href='https://github.com/jakemcc/jakemccrary.com/blob/c27a131aef437181dcab9552c3241f8adafb3884/source/javascripts/octopress.js#L112'>GitHub Gists</a>, <a href='https://github.com/jakemcc/jakemccrary.com/blob/c27a131aef437181dcab9552c3241f8adafb3884/source/javascripts/octopress.js#L99'>rendering</a> delicious links, and toggling the <a href='https://github.com/jakemcc/jakemccrary.com/blob/c27a131aef437181dcab9552c3241f8adafb3884/source/javascripts/octopress.js#L114'>sidebar visibility</a>. I was able to delete all that code.</p><p>Next up was the <a href='https://github.com/jakemcc/jakemccrary.com/blob/c27a131aef437181dcab9552c3241f8adafb3884/source/javascripts/octopress.js#L1-L13'>mobile navigation</a> <code>octopress.js</code> provided. This feature enabled navigation through a <code>&lt;select&gt;</code> element when the reader's view port was tiny. Restyling my navigation bar to fit better on small screens allowed me to remove this feature. <code>ocotpress.js</code> also did some <a href='https://github.com/jakemcc/jakemccrary.com/blob/c27a131aef437181dcab9552c3241f8adafb3884/source/javascripts/octopress.js#L37'>feature detection</a> for Modernizr. I stopped using image masks and was able to remove that code as well. </p><p>The remaining code in <code>octopress.js</code> was a workaround for an <a href='https://github.com/jakemcc/jakemccrary.com/blob/c27a131aef437181dcab9552c3241f8adafb3884/source/javascripts/octopress.js#L121-L136'>iOS scaling bug</a>. This JavaScript was inlined into my html. At this point <code>octopress.js</code> was empty and with it empty the requirements for jQuery and Modernizer disappeared. This let me remove three render-blocking <code>script</code> tags.</p><h3>Remaining JavaScript</h3><p>At this point the remaining JavaScript used for my blog was enabling comments with Disqus and showing recent tweets in my sidebar. I still enjoy having comments on my blog so I'm keeping Disqus around. I doubt that readers care what my most recent tweets are so I removed Twitter's JavaScript. Removing my tweets also cleans up my sidebar and helps keep the focus on my writing.</p><h3>Nearly no JavaScript, now what?</h3><p>At this point Google's PageSpeed Insight was suggesting that I up my cache times, inline my css, and move my web fonts lower on my page. Bumping up my cache times was trivial; I simply tweaked a CloudFlare setting. </p><p>I opted to not inline my css. This would require me to modify my site's generation and I just didn't feel like diving down that rabbit hole. I also didn't move the web fonts lower on the page. I find fonts re-rendering jarring and as a result kept them loading<a href='#fn-1' id='fnref1'><sup>1</sup></a> in my <code>&lt;head&gt;</code>.</p><h2>The results</h2><p>I used Web Page Test to measure again and now the page load time is down to 2.5 seconds. Page load times are cut in half from the starting point. My PageSpeed Insights scores are also higher; up to 79/100 for mobile and 92/100 for desktop.</p><p><img src="/images/after-optimizations.png" alt="Web Page Test after optimization" /></p><p>Honestly, that number still seems high<a href='#fn-2' id='fnref2'><sup>2</sup></a> to me and I'm sure I could get it lower. But for now it is good enough<a href='#fn-3' id='fnref3'><sup>3</sup></a>. As a result of doing this I've learned more about my blogging setup and managed to speed up my page load. Now it is time to focus on researching for future posts (and at some point restyling).</p><h2>Update on 2016-05-03</h2><p>I completely removed web font loading from my site. Getting rid of the fonts reduced my load time, as measured by Web Page Test, by a second. Google's PageSpeed Insights now scores this site at 90/100 for mobile and 96/100 for desktop.</p><p><img src="/images/after-optimizations2.png" alt="Web Page Test after font removal" /></p><ol class='footnotes'><li id='fn-1'>When I first wrote this I didn't change anything about my web fonts. After thinking about it for a few days I ended up removing them completely. Details are in the update at the end of the post.<a href='#fnref1'>&#8617;</a></li><li id='fn-2'>I'm asking Web Page Test to load my page using IE10. I get much faster load times using Chrome or Firefox locally which is what most of my readers use. This is good enough for now.<a href='#fnref2'>&#8617;</a></li><li id='fn-3'>I mean, the starting point was probably good enough but if I admitted that then I wouldn't have had the excuse to dig into my site's load time.<a href='#fnref3'>&#8617;</a></li></ol>
  <script src="/highlight/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>
  <script></script>
  <footer>
    <p xmlns:cc="http://creativecommons.org/ns#" >This work by <a rel="cc:attributionURL dct:creator" property="cc:attributionName" href="https://jakemccrary.com">Jake McCrary</a> is licensed under <a href="https://creativecommons.org/licenses/by-nc/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">CC BY-NC 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1" alt=""></a></p> 
    <a href="/disclosure-policy">Disclosure Policy</a><br/>
  </footer>
</body>
</html>
