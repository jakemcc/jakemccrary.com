
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="iem7"><![endif]-->
<!--[if lt IE 9]><html class="lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html lang="en"><!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <title>Jake McCrary</title>
    <meta name="author" content="Jake McCrary">

    
    
    
    

    <meta itemprop="name" content="Jake McCrary" />
    <meta itemprop="description" content=" My ideal command history would let me search the history of every
shell but when I hit the up arrow it would only cycle through my
current shell& &hellip;" />

    <!-- Twitter Card data -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@jakemcc" />
    <meta name="twitter:title" content="Jake McCrary" />
    <meta name="twitter:description" content=" My ideal command history would let me search the history of every
shell but when I hit the up arrow it would only cycle through my
current shell& &hellip;" />
    <meta name="twitter:creator" content="@jakemcc" />
    <meta name="twitter:image" content="https://jakemccrary.com/images/jake-surprised-eyes-brighter.jpg" />

    <!-- Open Graph data -->
    <meta property="og:site_name" content="The Blog of Jake McCrary" />
    <meta property="og:url" content="https://jakemccrary.com/blog/5/" />
    <meta property="og:title" content="Jake McCrary" />
    <meta property="og:description" content=" My ideal command history would let me search the history of every
shell but when I hit the up arrow it would only cycle through my
current shell& &hellip;" />
    <meta property="og:image" content="https://jakemccrary.com/images/jake-surprised-eyes-brighter.jpg" />
    
    

    <meta name="description" content=" My ideal command history would let me search the history of every
shell but when I hit the up arrow it would only cycle through my
current shell& &hellip;">

    

    <!-- http://t.co/dKP3o1e -->
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="canonical" href="https://jakemccrary.com/blog/5/">
    <link href="/favicon.png" rel="icon">
    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="http://feeds.feedburner.com/JakeMccrarysMusings" rel="alternate" title="Jake McCrary" type="application/atom+xml">
    <link href="https://jakemccrary.com/feed.json" rel="alternate" title="Jake McCrary" type="application/json">

    <!-- iOS scaling bug fix Rewritten version By @mathias, @cheeaun and @jdalton Source url: https://gist.github.com/901295 -->
    <script type="text/javascript">
     (function(doc) {
       var addEvent = 'addEventListener',
           type = 'gesturestart',
           qsa = 'querySelectorAll',
           scales = [1, 1],
           meta = qsa in doc ? doc[qsa]('meta[name=viewport]') : [];
       function fix() {
         meta.content = 'width=device-width,minimum-scale=' + scales[0] + ',maximum-scale=' + scales[1];
         doc.removeEventListener(type, fix, true);
       }
       if ((meta = meta[meta.length - 1]) && addEvent in doc) {
         fix();
         scales = [0.25, 1.6];
         doc[addEvent](type, fix, true);
       }
     }(document));
    </script>
    
<script>
 var origin = window.location.origin;
 if (!origin) {
   origin = window.location.protocol + '//' + window.location.hostname + (window.location.port ? (':' + window.location.port) : '');
 }
 if (origin.indexOf('localhost') === -1) {
   (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
   })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

   ga('create', 'UA-19834208-2', 'auto');
   ga('send', 'pageview');
 }
</script>


  </head>

<body  >
  <header role="banner"><hgroup>
  <h1><a href="/">Jake McCrary</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul role=main-navigation>
  <li><a href="/">Articles</a></li>
  <li><a href="/adventures/">Adventures</a></li>
  <li><a href="/about.html">About</a></li>
  <li><a href="/blog/archives/">Archives</a></li>
  <li><a href="http://feeds.feedburner.com/JakeMccrarysMusings" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
</ul>

  <form action="https://google.com/search" method="get">
    <fieldset role="search">
      <input type="hidden" name="sitesearch" value="jakemccrary.com">
      <input class="search" type="text" name="q" placeholder="Search"/>
    </fieldset>
  </form>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/09/28/better-command-history-in-your-shell/">Better command history in your shell</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-09-28T11:42:00-05:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>28</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>11:42 am</span></time>
      </p>
    
  </header>


  <div class="entry-content"><p>My ideal command history would let me search the history of every
shell but when I hit the up arrow it would only cycle through my
current shell&rsquo;s history. In February, I was able to achieve this setup
in large part because of a utility
called <a href="https://github.com/dvorka/hstr">hstr</a>.</p>

<h2>What is <code>hstr</code>?</h2>

<p>hstr is a neat Bash and Zsh utility that lets you easily search, view,
and manage your command history. hstr provides a tool named <code>hh</code> that
provides a text interface for manipulating your command
history. To see what it looks like check out
the <a href="https://github.com/dvorka/hstr/blob/master/README.md">README</a> and
this <a href="https://www.youtube.com/watch?v=sPF29NyXe2U">video</a> tutorial. If
you are running OS X and use Homebrew you can install it by running <code>brew
install hh</code>.</p>

<h2>Making global history searchable but arrows cycle through local history</h2>

<p>hstr is a neat tool but my favorite part of my setup is how the global
command history is searchable but only a shell&rsquo;s local history is
cycled through with the arrow keys. This is achieved by manipulating
where history is written and tweaking some environment variables.</p>

<p>The first step is to change your <code>$PROMPT_COMMAND</code> to append your
shell&rsquo;s history to a global history file. Below is the snippet that
does this from my <code>.bashrc</code> file.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># Whenever a command is executed, write it to a global history
</span><span class='line'>PROMPT_COMMAND="history -a ~/.bash_history.global; $PROMPT_COMMAND"</span></code></pre></td></tr></table></div></figure>


<p>The next step is to bind a keystroke to run <code>hh</code>, which is what hstr
provides, with <code>$HISTFILE</code> pointing to <code>~/.bash_history.global</code>. I
wanted to fully replace the default command history searching (and I
use Emacs style keyboard shortcuts) so I&rsquo;ve bound these actions to ctrl-r.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># On C-r set HISTFILE and run hh</span>
</span><span class='line'><span class="nb">bind</span> -x <span class="s1">&#39;&quot;\C-r&quot;: &quot;HISTFILE=~/.bash_history.global hh&quot;&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>With those two additions to my <code>.bashrc</code> I&rsquo;ve achieved my ideal
command history searching. When I hit ctrl-r I&rsquo;m searching all of my
history and yet I only cycle through a shell&rsquo;s local history with the
arrow keys. This small addition<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup> made my command line productivity
higher.</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>My setup was inspired by <a href="https://unix.stackexchange.com/questions/200225/search-history-from-multiple-bash-session-only-when-ctrl-r-is-used-not-when-a">this</a> StackExchange post.<a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/08/28/better-code-reloading-in-a-cloure-web-server/">Better code reloading in a Clojure web server</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-08-28T17:20:00-05:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>28</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>5:20 pm</span></time>
      </p>
    
  </header>


  <div class="entry-content"><p>A couple weeks ago I released
<a href="https://github.com/jakemcc/reload">com.jakemccrary/reload</a>. This tiny
library provides a ring middleware that uses
<a href="https://github.com/clojure/tools.namespace">org.clojure/tools.namespace</a>
 to reload changed Clojure code on incoming http requests.</p>

<p>This middleware was created because my team was running into problems
using ring&rsquo;s <code>wrap-reload</code> middleware. Unfortunately these problems
happened about nine months ago and, since I didn&rsquo;t write this post
back then, I&rsquo;ve since forgotten these problems. Regardless, this
project has been used since the beginning of this year and has helped
make my team&rsquo;s development workflow smoother. If you are running into
problems it might help you too.</p>

<h3>Usage</h3>

<p>If you&rsquo;d like to give it a shot, then add the <a href="https://clojars.org/com.jakemccrary/reload">latest version</a> (at the time of writing <code>[com.jakemccrary/reload "0.1.0"]</code>) to your project.clj.</p>

<p>Require <code>com.jakemccrary.middleware.reload</code> and wrap your handler with <code>wrap-reload</code>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">ns </span><span class="nv">example</span>
</span><span class='line'>  <span class="p">(</span><span class="ss">:require</span>
</span><span class='line'>   <span class="c1">;; more deps</span>
</span><span class='line'>   <span class="p">[</span><span class="nv">com.jakemccrary.middleware.reload</span> <span class="ss">:as</span> <span class="nv">reload</span><span class="p">]))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;; wherever you are setting up your middleware stack</span>
</span><span class='line'><span class="p">(</span><span class="nf">reload/wrap-reload</span> <span class="nv">routes</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>reload/wrap-reload</code> optionally takes a list of directories to monitor
as a second parameter. By default it reloads the <code>src</code> directory.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/07/31/aws-elastic-beanstalk-send-a-sqs-message-to-a-specific-route-in-your-worker-environment/">AWS Elastic Beanstalk: Send a SQS message to a specific route in your worker environment</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-07-31T12:16:00-05:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>31</span><span class='date-suffix'>st</span>, <span class='date-year'>2016</span></span> <span class='time'>12:16 pm</span></time>
      </p>
    
  </header>


  <div class="entry-content"><p><a href="https://lumanu.com">Lumanu</a> uses
<a href="https://aws.amazon.com/elasticbeanstalk/">AWS Elastic Beanstalk</a>. Elastic
Beanstalk (from now on abbreviated as EB) helps you provision and tie
together Amazon services to fairly easily get web applications and
services running with push button (or command line) deploys. We&rsquo;ve
been using EB with a multi-container docker deploy for nearly a year
now and it pretty much just works.</p>

<p>EB has a concept of environment tiers and there are two different
types; a web tier and a worker tier. Web tier environments provide
the configuration and components necessary for serving HTTP requests
in a scalable
fashion. <a href="http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/using-features-managing-env-tiers.html">Worker environments</a>
are designed to run operations that you wouldn&rsquo;t want performed by
your front-end serving web application.</p>

<p>A major difference between the two environment tiers is that a worker
environment provisions a <a href="https://aws.amazon.com/sqs/">SQS</a> queue and
provides a daemon that reads from this queue and POSTs messages to an
instance of your worker service. This daemon prevents your worker
service from having to connect to and manage a SQS queue. By default,
the daemon POSTs messages to <code>http://localhost/</code>. You can optionally
configure it to POST to a different route.</p>

<p>It is possible to have different messages POST to different
routes. You can do this by setting the <code>beanstalk.sqsd.path</code> attribute
on your SQS message. For example, if you want your worker service to
receive a message at <code>/trigger-email</code> you would set the
<code>beanstalk.sqsd.path</code> attribute to <code>/trigger-email</code>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/06/28/seven-tips-for-successful-remote-meetings/">7 tips for a successful remote meeting</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-06-28T09:36:00-05:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>28</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>9:36 am</span></time>
      </p>
    
  </header>


  <div class="entry-content"><blockquote><p>See all of my remote/working-from-home <a href="/blog/categories/remote/">articles here</a>.</p></blockquote>

<p>As mentioned in my
<a href="/blog/2016/06/14/tips-for-working-from-home/">tips for working from home</a>
article, I&rsquo;ve been working remotely for nearly three years. In those
three years I&rsquo;ve been in countless meetings, both productive and
unproductive. Meetings, both in-person and remote, are hard. Remote
meetings pose some additional challenges but they also offer some
unique benefits.</p>

<p>Below are seven tips that will help you have successful remote
meetings. I wrote this article focusing on remote meetings but many of
these tips will improve your co-located meetings as well.</p>

<h3>Have an agenda</h3>

<p>If you are organizing a meeting, you should make sure that the meeting
has an agenda. The agenda doesn&rsquo;t have to be a long, complicated
document; it can be as simple as a list of topics and goals.</p>

<p>Why should you have an agenda? An agenda helps focus discussion by
providing an outline of what the meeting is designed to cover.</p>

<p>Send out your agenda with the meeting invite. This gives invitees time
to think about the topics and helps prevent people from showing up
clueless. It also provides an opportunity for an invitee to excuse
themself or suggest an alternative person if they don&rsquo;t believe they
will contribute to the meeting.</p>

<h3>Start and end on time</h3>

<p>You should start your meetings on time. You should end your meetings
on time or early. If you are not starting and ending on time then you
are not being respectful of your attendees time. The lack of
punctuality contributes towards people dreading meetings.</p>

<p>If you are running out of time, wind down the meeting. If more
discussions need to happen, reflect and see if more time needs to be
scheduled with the entire group or if only a subset of the group is
required.</p>

<h3>Use video chat</h3>

<p>Even if you don&rsquo;t work remotely, you&rsquo;ve probably had to dial in to a
group audio chat. This is almost always a terrible experience. Without
body language, it is near impossible to tell when someone is about to
start speaking and, as a result, there are awkward pauses while
everyone waits for someone else to speak and everyone speaks over each
other. It is terrible.</p>

<p>This is why I recommend using video chat. Video chats let you see
the other people on the call and this allows you to pick up on
physical cues. These cues vastly improve communication in the meeting.</p>

<h3>Co-located attendees should use their own device</h3>

<p>Sometimes you&rsquo;ll have a mixed meeting, some attendees are remote and
others are together in an office. The co-located attendees should each
use their own device to connect to the meeting.</p>

<p>Co-located attendees sharing a single device is non-optimal for many
reasons. It is often hard for all the co-located attendees to be
captured by the camera in a way that enables the remote attendees to
reliably view them. Sharing a single microphone also makes it so some
co-located attendees are easy to hear and others are barely audible.</p>

<p>Using a single device also makes it harder for all the co-located
attendees to view the remote attendees. Without a clear view of the
remote attendees, the co-located attendees often accidentally exclude
the remote people by focusing on discussions between the co-located
group.</p>

<h3>Ignore distractions</h3>

<p>Hopefully you have invited just the right people to the meeting and
everyone is engaged in the discussion and paying
attention. Realistically this doesn&rsquo;t happen. Computers are incredibly
good at so many things and one of those things is distracting the
user.</p>

<p>When you are attending a remote meeting, minimize what can distract
you. Close your email and hide the chat program. Put your phone out of
arms reach. Try to focus intently on the meeting. If you find yourself
not paying attention and not contributing, take this as a signal that
you shouldn&rsquo;t be in this meeting. If nothing on the rest of the agenda
seems like it requires you, then leave the meeting and be more
selective about what you join in the future.</p>

<p>If you notice other attendees not paying attention, gently call them
out on it. This can be done by soliciting discussion from them or by
being direct.</p>

<h3>Have a shared artifact</h3>

<p>This is one of the more important tips in this list and it is one of
the areas where remote meetings have an advantage over in-person
meetings.</p>

<p>When the meeting starts give everyone a link to a shared document that
everyone can edit (for example a
<a href="https://www.google.com/docs/about/">Google Doc</a>). It can be useful to
seed this document with the agenda. This shared document can be used
to capture whatever you want. I&rsquo;ve found it useful to capture options
discussed, pros/cons lists, and follow-up actions. Writing in the
shared document helps solidify ideas and gives the group a reference
both during and after the meeting.</p>

<p>With in-person meetings, this shared artifact is often a
whiteboard. Whiteboards are immensely useful but are barely editable
by more than one person at once and are harder to reference after a
meeting. I know I&rsquo;m not the only person who dislikes trying to
decipher terrible whiteboard handwriting captured by someone&rsquo;s phone.</p>

<p>Except for when drawing diagrams, I&rsquo;ve found the Google Docs style
shared document used during a remote meeting more effective than using
a whiteboard in an in-person meeting. You can always use a shared
document in an in-person meeting as well but then you are requiring
attendees to have a laptop open and that is an invitation for
distracted attendees.</p>

<h3>Assign responsibilities</h3>

<p>Hopefully you are having a meeting to influence an outcome and not
just hear everyone talk. As a result, you should be assigning
follow-up responsibilities as the meeting progresses. Make the
follow-up actions explicit and assigned to an individual. You can
capture these responsibilities in your shared artifact.</p>

<hr />

<p>Meetings can be difficult. You should do what you can to make them
more successful. If you are being invited to a meeting without an
agenda, ask for an agenda. If you&rsquo;re in a meeting and you can tell
someone is constantly distracted, try nicely calling them out on it
(either privately or in the group). If there isn&rsquo;t a shared artifact,
make one and suggest it to the group. Meetings don&rsquo;t have to be
terrible. We can make them better.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/06/20/my-recommended-clojure-testing-setup/">My recommended Clojure testing setup</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-06-20T21:03:00-05:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>20</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>9:03 pm</span></time>
      </p>
    
  </header>


  <div class="entry-content"><p>Occasionally, either on Stack Overflow or in the
<a href="http://clojurians.net/">Clojurians</a> Slack group, someone will ask
what tools they should use to test Clojure code. Below is what I would
currently recommend. I&rsquo;ve come to this recommendation through
observing teams using a variety of testing tools and through my own
use them.</p>

<blockquote><p>Use clojure.test with
<a href="https://github.com/pjstadig/humane-test-output">humane-test-output</a>
and <a href="https://github.com/jakemcc/lein-test-refresh">lein-test-refresh</a>.</p></blockquote>

<h3>Use clojure.test</h3>

<p>clojure.test is ubiquitous and not a big departure from other
languages' testing libraries. It has its warts but your team will be
able to understand it quickly and will be able to write maintainable
tests.</p>

<h3>Use humane-test-output</h3>

<p>You should use clojure.test with
<a href="https://github.com/pjstadig/humane-test-output">humane-test-output</a>. Together
they provide a testing library that has minimal additional syntax and
good test failure reporting.</p>

<h3>Use lein-test-refresh</h3>

<p>If you&rsquo;re not using a tool that reloads and reruns your tests on file
changes then you are wasting your time. The delay between changing
code and seeing test results is drastically reduced by using a tool
like
<a href="https://github.com/jakemcc/lein-test-refresh">lein-test-refresh</a>. Nearly
everyone I know who tries adding lein-test-refresh to their testing
toolbox continues to use it. Many of these converts were not newcomers
to Clojure either, they had years of experience and had already
developed workflows that worked for them.</p>

<h3>Use lein-test-refresh&rsquo;s advanced features</h3>

<p><a href="https://github.com/jakemcc/lein-test-refresh">lein-test-refresh</a>
makes development better even if you don&rsquo;t change any of its
settings. It gets even better if you use some of its advanced
features.</p>

<p>Below is a stripped down version of my <code>~/.lein/profiles.clj</code>. The
<code>:test-refresh</code> key points towards my recommended lein-test-refresh
settings.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">{</span><span class="ss">:user</span> <span class="p">{</span><span class="ss">:dependencies</span> <span class="p">[[</span><span class="nv">pjstadig/humane-test-output</span> <span class="s">&quot;0.8.0&quot;</span><span class="p">]]</span>
</span><span class='line'>        <span class="ss">:injections</span> <span class="p">[(</span><span class="nf">require</span> <span class="ss">&#39;pjstadig.humane-test-output</span><span class="p">)</span>
</span><span class='line'>                     <span class="p">(</span><span class="nf">pjstadig.humane-test-output/activate!</span><span class="p">)]</span>
</span><span class='line'>        <span class="ss">:plugins</span> <span class="p">[[</span><span class="nv">com.jakemccrary/lein-test-refresh</span> <span class="s">&quot;0.16.0&quot;</span><span class="p">]]</span>
</span><span class='line'>        <span class="ss">:test-refresh</span> <span class="p">{</span><span class="ss">:notify-command</span> <span class="p">[</span><span class="s">&quot;terminal-notifier&quot;</span> <span class="s">&quot;-title&quot;</span> <span class="s">&quot;Tests&quot;</span> <span class="s">&quot;-message&quot;</span><span class="p">]</span>
</span><span class='line'>                       <span class="ss">:quiet</span> <span class="nv">true</span>
</span><span class='line'>                       <span class="ss">:changes-only</span> <span class="nv">true</span><span class="p">}}}</span>
</span></code></pre></td></tr></table></div></figure>


<p>These settings turn on notifications when my tests finish running
(<code>:notify-command</code> setting), make clojure.test&rsquo;s output less verbose
(<code>:quiet true</code>), and only run tests in namespaces affected by the
previous code change (<code>:changes-only true</code>). These three settings give
me the quickest feedback possible and free me from having the terminal
running <code>lein test-refresh</code> visible.</p>

<p>Quick feedback lets you make changes faster. If you&rsquo;re going to write
tests, and you should write tests, having them run quickly is
powerful. After years of writing Clojure, this is my current go-to for
testing Clojure code and getting extremely fast feedback.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/06/14/tips-for-working-from-home/">Tips for working from home</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-06-14T10:05:00-05:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>14</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>10:05 am</span></time>
      </p>
    
  </header>


  <div class="entry-content"><blockquote><p>See all of my remote/working-from-home <a href="/blog/categories/remote/">articles here</a>.</p></blockquote>

<p>I&rsquo;ve been working remotely since October 2013. I can barely believe
that nearly three years have passed and I&rsquo;ve probably spent about two
weeks in a traditional office.</p>

<p>It took me a bit of time to adjust to working remotely. I&rsquo;m better at
it now than I was three years ago. The rest of this post describes
some of my learnings.</p>

<p>But first, some background. My remote experience comes from working at
<a href="http://outpace.com">Outpace</a> and <a href="https://lumanu.com">Lumanu</a>. Both
are remote first companies, almost everyone works remotely with a few
people occasionally working in a San Francisco office. The work is
remote but it is not asynchronous. Both companies value pair
programming and real time collaboration and, as a result, employees
tend to work a core set of hours. My observations are probably most
applicable in a similar environment.</p>

<h3>Setup a home workspace</h3>

<p>Before working remotely I did not have a great home computing setup. I
worked using a 13-inch MacBook Air either sitting on my couch or at my
dinner table. This worked fine for the occasional work-from-home day
and for evening and weekend programming. It didn&rsquo;t work fine when I
was spending extended hours at a computer every day.</p>

<p>I&rsquo;ve written about my setup
<a href="/blog/2015/03/31/my-home-work-space/">before</a>. Below is a list of the
improvements I made to my home working environment.</p>

<ol>
<li>Outpace provided a beefy MacBook Pro and two 27-inch Apple Cinema displays.</li>
<li>I upgraded my chair to to a <a href="http://amzn.to/1XNWKru">Herman Miller Setu</a>.</li>
<li>I bought a <a href="http://www.amazon.com/gp/product/B000OOYECC/=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=B000OOYECC&amp;linkCode=as2&amp;tag=jakemccrary08-20&amp;linkId=L5THOTZHJ6FPJSAL">mStand Laptop Stand</a> to raise my laptop to a better viewing height.</li>
<li>I upgraded my desk to a sit-stand desk.</li>
<li>I built my own <a href="/blog/2014/07/27/building-the-ergodox-keyboard/">ErgoDox keyboard</a>.</li>
<li>I switched to an adjustable monitor arm so I could adjust my monitor height.</li>
</ol>


<p>With each change my working experience improved. Each improvement left
me feeling better at the end of my day. Many, if not all, of these
improvements are things I&rsquo;d expect to have in a traditional
office. Don&rsquo;t skimp on your setup because it is in your home. Part of
your home is your office now.</p>

<h3>Introduce a habit that delineates work from after-work</h3>

<p>One of the great things about working from home is that you no longer
have a commute. You don&rsquo;t have to dodge cars on your bicycle, squeeze
into a train, or sit in traffic while driving. This is a huge benefit.</p>

<p>A downside of not having a commute is that you lose a forced
intermission between work and non-work. My commute was either a
30-minute bicycle ride or a 30-minute public transit ride. That time
acted as a forced decompression period where I focused on something
that wasn&rsquo;t computing.</p>

<p>It took me months to realize that not having this intermission was
stressing me out. The intermission helped me shift between working
and non-working mindsets.</p>

<p>I reintroduced a decompression activity between work and non-work and
became less stressed and generally happier. I&rsquo;ve replaced my commute
intermission with reading, cooking, or riding my bicycle. I&rsquo;ve found
doing a non-computer activity benefits me the most.</p>

<h3>Stop working</h3>

<p>When I first started working from home I was very guilty of
overworking. It was so easy to just keep working. I would get invested
in a problem and all sudden realize it was time to go to bed. Or I&rsquo;d
actually stop working, only to find myself checking our application&rsquo;s
monitoring or pulling up the codebase when I originally sat down to do
some personal task.</p>

<p>In an office you have signals; your coworkers leaving, the cleaning
crew vacuuming, air conditioning turning off, etc., that provide a
hint that you should think about stopping. You don&rsquo;t have these
signals when you are working remotely. There also isn&rsquo;t that spatial
boundary between your office and your home.</p>

<p>You can search online and find many articles about how overwork is
detrimental. You and your employer benefit if you are <strong>not</strong>
overworked.</p>

<h3>Get out of your house</h3>

<p>I live in Chicago. During the winter the weather is very cold. Chicago
is also a big city, so all sorts of food delivery options (both cooked
and uncooked) exist. The cold weather combined with food delivery
makes it easy to stay inside. During the winter, I&rsquo;ve realized many
times that I haven&rsquo;t left my apartment for days. My girlfriend can
tell when I haven&rsquo;t gotten outside because I&rsquo;m grumpier.</p>

<p>If I get out of the apartment for a while I almost always come back
feeling better. It barely matters what I do when I leave, after an
extended period of time inside of my home just getting outside and
doing anything helps. A change of scenery is good for you.</p>

<h3>Don&rsquo;t just talk about business with your remote coworkers</h3>

<p>When you work in an office you are pretty much forced to have non-work
related chats with coworkers. You should do the same with your remote
team.</p>

<p>Having non-work related conversations helps you make better
connections with your coworkers. These better connections can lead to
better communication, both with voice and text, and humanize the person
on the other side of the screen.</p>

<p>Its even better if you can do this in a video conference. Then you get
to learn the facial expressions and tone of voice of your
coworker. This can make it easier to interpret text communication in
the way they actually mean it.</p>

<h3>Meet in person occasionally</h3>

<p>It is great that technology and Internet speeds have progressed enough
that working remotely works well. If you want, you can make it feel
like your pair is sitting right next to you. This is great.</p>

<p>There are still benefits to meeting in person though. The main one is
that it helps you make connections with coworkers. You can eat a meal
together or play board games (though, you can do this online as well
but it is a different experience). It can also be easier to have
certain types of group discussions (video conferences do have
limitations).</p>

<p>When you meet in person, I&rsquo;d recommend doing something different than
your normal day-to-day work. Don&rsquo;t just exchange remote pairing for
local pairing. Try to identify that are difficult to do remotely and
do them in person.</p>

<p>I don&rsquo;t have a concrete recommendation for how often your remote
company should meet but I think it should be infrequent enough where
you don&rsquo;t feel pressure to do normal work.</p>

<h2>End</h2>

<p>Working from home has its challenges but with those challenges come
many benefits. It is a different experience than working in an office
and that experience isn&rsquo;t for everyone. The above recommendations are
things that have helped me adjust to working remotely. Some of these
tips are actionable at an individual level and some require buy in
from the company. Hopefully this list can help give guidance towards
improving your remote work situation.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/05/14/use-google-to-get-a-sites-favicon/">Use Google to get a site's favicon</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-05-14T09:10:00-05:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>14</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>9:10 am</span></time>
      </p>
    
  </header>


  <div class="entry-content"><p>A few months ago I was implementing some changes to
<a href="https://lumanu.com">Lumanu&rsquo;s</a> user interface. Lumanu is a tool I&rsquo;ve
been working on that helps its users create, discover, and curate
engaging content.</p>

<p>This interface change was to our discovery view. This is the view that
surfaces interesting content to our users. The change involved
showing the favicon of content&rsquo;s origin in our interface.</p>

<p>I often browse the Internet with the network tab of the Chrome
Developer Tools open. I do this because I find it interesting to see
what services other web applications are using. I had the network tab
open while browsing a site that displayed many favicons and noticed a
lot fetches from google.com. This surprised me, so I took a deeper
look at the requests and saw they were hitting a URL that appeared to
provide favicons. It turns out you can query Google for favicons.</p>

<h3>Example</h3>

<p>Let&rsquo;s pretend we want to get the favicon for <code>jakemccrary.com</code>. You
simply construct a URL that looks like
<a href="https://www.google.com/s2/favicons?domain=jakemccrary.com"><code>https://www.google.com/s2/favicons?domain=jakemccrary.com</code></a>
and all of a sudden you have the favicon. Just replace
<code>jakemccrary.com</code> with the domain you care about and you&rsquo;ll be
rewarded with that domain&rsquo;s favicon.</p>

<p><img src="https://www.google.com/s2/favicons?domain=jakemccrary.com" title="Favicon from Google" alt="My favicon from Google" /></p>

<p>This definitely isn&rsquo;t a new feature. If you search online you&rsquo;ll see
people talking about it years ago. I had never heard of it before and
discovering it saved us an unknown amount of time. It allowed us to
iterate on our interface without having to figure out the nuances of
favicons. We were able to quickly try out the interface change and
then throw it away without costing us too much time.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/04/30/speeding-up-my-blog/">Speeding up my blog</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-04-30T23:42:00-05:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>30</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>11:42 pm</span></time>
      </p>
    
  </header>


  <div class="entry-content"><p>I was recently reading
<a href="https://jefframnani.com/about/">Jeff Ramnani&rsquo;s</a> <em>about</em> page and I
was somewhat inspired by it. It loads quickly and links to
<a href="http://mattgemmell.com/designing-blogs-for-readers/">Designing blogs for readers</a>,
an interesting essay by Matt Gemmmell. Reading that essay inspired me
to think about my own site and what experience I want to deliver to
readers.</p>

<p>I can&rsquo;t imagine what every reader wants but I know what I want to
experience when I read an article online. Reading high quality content
is my highest priority. Beyond that I enjoy when a page loads fast and
the visual design doesn&rsquo;t get in the way. I think a great example of
these two requirements is <a href="http://zenhabits.net/falling/">zen habits</a>
(along with Jeff Ramnani&rsquo;s and Matt Gemmell&rsquo;s).</p>

<p>My own site sort of achieves those goals. I like to think I&rsquo;m writing
well-written content that helps others. I know it has helped me. With
regards to visual design I think there is room for improvement. I don&rsquo;t
think my site&rsquo;s design is actively distracting from the content
though, so I&rsquo;ve decided to focus on improving the page load time
first.</p>

<h2>The optimization process</h2>

<p>As with any optimization problem it is important figure what you&rsquo;re
going to measure, how you&rsquo;re going to measure it and your starting
point. I decided to focus on my page load time, as measured by
<a href="http://www.webpagetest.org">Web Page Test</a>. I used Google&rsquo;s
<a href="https://developers.google.com/speed/pagespeed/insights/">PageSpeed Insights</a>
to score and provide helpful tips for improving page
speed. Unfortunately I didn&rsquo;t capture my starting point with PageSpeed
Insights but I think I was scoring around a 66/100 for mobile and
79/100 for desktop.</p>

<p><img src="/images/before-optimizations.png" alt="Starting point from Web Page Test" /></p>

<p>As measured by Web Page Test, the first load of my main page took five
seconds and it wasn&rsquo;t fully loaded for another second. This is
ridiculous. My page is almost entirely static content and most of my
assets are served from CloudFlare. It should be blazing fast.</p>

<p>Next I looked at what was actually being loaded. Google&rsquo;s PageSpeed
Insights identified that I had three render-blocking <code>script</code>
tags. The offending scripts were Modernizr, jQuery, and
octopress.js. PageSpeed Insights
<a href="https://developers.google.com/speed/docs/insights/BlockingJS#overview">recommends</a>
inlining JavaScript required to render the page or make loading
asynchronous. I decided to go a step further and remove the need for
the JavaScript.</p>

<h3>Removing octopress.js</h3>

<p>It turns out <code>octopress.js</code> was the reason Modernizr and jQuery were
required. Most of what
<a href="https://github.com/jakemcc/jakemccrary.com/blob/c27a131aef437181dcab9552c3241f8adafb3884/source/javascripts/octopress.js">octopress.js</a>
did were things that I don&rsquo;t need; some sort of
<a href="https://github.com/jakemcc/jakemccrary.com/blob/c27a131aef437181dcab9552c3241f8adafb3884/source/javascripts/octopress.js#L111">flash video fallback</a>,
adding line numbers to
<a href="https://github.com/jakemcc/jakemccrary.com/blob/c27a131aef437181dcab9552c3241f8adafb3884/source/javascripts/octopress.js#L112">GitHub Gists</a>,
<a href="https://github.com/jakemcc/jakemccrary.com/blob/c27a131aef437181dcab9552c3241f8adafb3884/source/javascripts/octopress.js#L99">rendering</a>
delicious links, and toggling the
<a href="https://github.com/jakemcc/jakemccrary.com/blob/c27a131aef437181dcab9552c3241f8adafb3884/source/javascripts/octopress.js#L114">sidebar visibility</a>. I
was able to delete all that code.</p>

<p>Next up was the
<a href="https://github.com/jakemcc/jakemccrary.com/blob/c27a131aef437181dcab9552c3241f8adafb3884/source/javascripts/octopress.js#L1-L13">mobile navigation</a>
<code>octopress.js</code> provided. This feature enabled navigation through a
<code>&lt;select&gt;</code> element when the reader&rsquo;s view port was tiny. Restyling my
navigation bar to fit better on small screens allowed me to remove
this feature. <code>ocotpress.js</code> also did some
<a href="https://github.com/jakemcc/jakemccrary.com/blob/c27a131aef437181dcab9552c3241f8adafb3884/source/javascripts/octopress.js#L37">feature detection</a>
for Modernizr. I stopped using image masks and was able to remove that
code as well.</p>

<p>The remaining code in <code>octopress.js</code> was a workaround for an
<a href="https://github.com/jakemcc/jakemccrary.com/blob/c27a131aef437181dcab9552c3241f8adafb3884/source/javascripts/octopress.js#L121-L136">iOS scaling bug</a>. This
JavaScript was inlined into my html. At this point <code>octopress.js</code> was
empty and with it empty the requirements for jQuery and Modernizer
disappeared. This let me remove three render-blocking <code>script</code> tags.</p>

<h3>Remaining JavaScript</h3>

<p>At this point the remaining JavaScript used for my blog was enabling
comments with Disqus and showing recent tweets in my sidebar. I still
enjoy having comments on my blog so I&rsquo;m keeping Disqus around. I doubt
that readers care what my most recent tweets are so I removed
Twitter&rsquo;s JavaScript. Removing my tweets also cleans up my sidebar and
helps keep the focus on my writing.</p>

<h3>Nearly no JavaScript, now what?</h3>

<p>At this point Google&rsquo;s PageSpeed Insight was suggesting that I up my
cache times, inline my css, and move my web fonts lower on my
page. Bumping up my cache times was trivial; I simply tweaked a
CloudFlare setting.</p>

<p>I opted to not inline my css. This would require me to modify my
site&rsquo;s generation and I just didn&rsquo;t feel like diving down that rabbit
hole. I also didn&rsquo;t move the web fonts lower on the page. I find fonts
re-rendering jarring and as a result kept them loading<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup> in my <code>&lt;head&gt;</code>.</p>

<h2>The results</h2>

<p>I used Web Page Test to measure again and now the page load time is
down to 2.5 seconds. Page load times are cut in half from the starting
point. My PageSpeed Insights scores are also higher; up to 79/100 for mobile
and 92/100 for desktop.</p>

<p><img src="/images/after-optimizations.png" alt="Web Page Test after optimization" /></p>

<p>Honestly, that number still seems high<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup> to me and I&rsquo;m sure I could
get it lower. But for now it is good enough<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup>. As a result of doing
this I&rsquo;ve learned more about my blogging setup and managed to speed up
my page load. Now it is time to focus on researching for future
posts (and at some point restyling).</p>

<h2>Update on 2016-05-03</h2>

<p>I completely removed web font loading from my site. Getting rid of the
fonts reduced my load time, as measured by Web Page Test, by a
second. Google&rsquo;s PageSpeed Insights now scores this site at 90/100 for
mobile and 96/100 for desktop.</p>

<p><img src="/images/after-optimizations2.png" alt="Web Page Test after font removal" /></p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>When I first wrote this I didn&rsquo;t change anything about my web fonts. After thinking about it for a few days I ended up removing them completely. Details are in the update at the end of the post.<a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
<li id="fn:2">
<p>I&rsquo;m asking Web Page Test to load my page using IE10. I get much faster load times using Chrome or Firefox locally which is what most of my readers use. This is good enough for now.<a href="#fnref:2" rev="footnote">&#8617;</a></p></li>
<li id="fn:3">
<p>I mean, the starting point was probably good enough but if I admitted that then I wouldn&rsquo;t have had the excuse to dig into my site&rsquo;s load time.<a href="#fnref:3" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/04/10/the-usefulness-of-clojures-cond-arrow/">The usefulness of Clojure's cond-></a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-04-10T18:45:00-05:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>10</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>6:45 pm</span></time>
      </p>
    
  </header>


  <div class="entry-content"><p>Clojure&rsquo;s
<a href="https://clojure.github.io/clojure/clojure.core-api.html#clojure.core/cond-%3E"><code>cond-&gt;</code></a>
(and <code>cond-&gt;&gt;</code>) is a versatile macro. It isn&rsquo;t a new macro, it
has been around since version 1.5, but I finally discovered and
started using it sometime last year. It isn&rsquo;t a workhorse macro,
you won&rsquo;t be using it everyday, but it comes in handy.</p>

<h3>What is <code>cond-&gt;</code>?</h3>

<p>Let&rsquo;s start by looking at the docstring.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Usage: (cond-&gt; expr & clauses)
</span><span class='line'>
</span><span class='line'>Takes an expression and a set of test/form pairs. Threads expr (via -&gt;)
</span><span class='line'>through each form for which the corresponding test
</span><span class='line'>expression is true. Note that, unlike cond branching, cond-&gt; threading does
</span><span class='line'>not short circuit after the first true test expression.</span></code></pre></td></tr></table></div></figure>


<p>So what does the docstring mean? Let&rsquo;s break it down with an example.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="nf">cond-&gt;</span> <span class="mi">10</span>
</span><span class='line'>  <span class="nv">false</span> <span class="nv">inc</span><span class="p">)</span>
</span><span class='line'><span class="nv">=&gt;</span> <span class="mi">10</span>
</span></code></pre></td></tr></table></div></figure>


<p>In the above example <code>10</code> is the <code>expr</code> mentioned in the docstring and
everything after it are the <code>clauses</code>. Each clause is a pair made up
of a test and a form. In this example there is a single clause with
the value <code>false</code> as the test the function <code>inc</code> as the form. Since
the test evaluates to a false value the expression is not threaded
into the form. As a result the original expression, <code>10</code>, is returned.</p>

<p>Let&rsquo;s look at an example with a truthy test.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="nf">cond-&gt;</span> <span class="mi">10</span>
</span><span class='line'>  <span class="nv">true</span> <span class="p">(</span><span class="nb">- </span><span class="mi">2</span><span class="p">)</span>
</span><span class='line'><span class="nv">=&gt;</span> <span class="mi">8</span>
</span></code></pre></td></tr></table></div></figure>


<p>Once again, <code>10</code> is the starting expression. The single clause has a
test that evaluates to true so the expression is threaded into the
first position of the form <code>(- 2)</code>. The result is <code>8</code> and this is
returned.</p>

<p>Next is an example of a <code>cond-&gt;</code> with multiple clauses. Explanations
are inline with the code.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="nf">cond-&gt;</span> <span class="mi">10</span> <span class="c1">; start with 10</span>
</span><span class='line'>  <span class="c1">;; test evaluates to true, so apply inc to 10. Current value is now 11.</span>
</span><span class='line'>  <span class="nv">true</span> <span class="nv">inc</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">;; (zero? 1) evaluates to false, do not perform action. Current value stays 11.</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">zero? </span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">2</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">;; (pos? 4) evaluates to true, thread 11 into first position of form.</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">pos? </span><span class="mi">4</span><span class="p">)</span> <span class="p">(</span><span class="nb">- </span><span class="mi">5</span><span class="p">))</span>
</span><span class='line'><span class="nv">=&gt;</span> <span class="mi">6</span> <span class="c1">; The result of (- 11 5) is 6.</span>
</span></code></pre></td></tr></table></div></figure>


<p>If you understand the above example then you have a good grasp of
<code>cond-&gt;</code>. But when is this functionality useful?</p>

<h3>When do I use cond->?</h3>

<p>Looking through the codebases I work on, I almost primarily see
<code>cond-&gt;</code> being used with the initial expression being a hash-map. It
is being used in situations where we want to selectively
<code>assoc</code>, <code>update</code>, or <code>dissoc</code> something from a map.</p>

<p>If <code>cond-&gt;</code> did not exist you would accomplish those selective
modifications with code similar to below.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">some-pred?</span> <span class="nv">q</span><span class="p">)</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">assoc </span><span class="nv">m</span> <span class="ss">:a-key</span> <span class="ss">:a-value</span><span class="p">)</span>
</span><span class='line'>  <span class="nv">m</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>You can rewrite the above with <code>cond-&gt;</code>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="nf">cond-&gt;</span> <span class="nv">m</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">some-pred?</span> <span class="nv">q</span><span class="p">)</span> <span class="p">(</span><span class="nb">assoc </span><span class="ss">:a-key</span> <span class="ss">:a-value</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>If you&rsquo;re not used to seeing <code>cond-&gt;</code> the above transformation might
seem like a step backwards. I know it felt that way to me when I first
saw <code>cond-&gt;</code>. Give yourself time to get familiar with it and you&rsquo;ll be
glad you&rsquo;re using it.</p>

<p>A meatier example of using <code>cond-&gt;</code> is demonstrated below. Here we&rsquo;re
manipulating data structures designed for use with
<a href="https://github.com/jkk/honeysql">honeysql</a> to generate SQL
statements. We start with a <code>base-query</code> and selectively modify it
based on incoming parameters.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">query</span> <span class="p">[</span><span class="nv">req-params</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">and-clause</span> <span class="p">(</span><span class="nf">fnil</span> <span class="nb">conj </span><span class="p">[</span><span class="ss">:and</span><span class="p">])</span>
</span><span class='line'>        <span class="nv">base-query</span> <span class="p">{</span><span class="ss">:select</span> <span class="p">[</span><span class="ss">:name</span> <span class="ss">:job</span><span class="p">]</span>
</span><span class='line'>                    <span class="ss">:from</span> <span class="p">[</span><span class="ss">:person</span><span class="p">]}]</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond-&gt;</span> <span class="nv">base-query</span>
</span><span class='line'>      <span class="p">(</span><span class="ss">:job</span> <span class="nv">req-params</span><span class="p">)</span> <span class="p">(</span><span class="nf">update</span> <span class="ss">:where</span> <span class="nv">and-clause</span> <span class="p">[</span><span class="ss">:=</span> <span class="ss">:job</span> <span class="p">(</span><span class="ss">:job</span> <span class="nv">req-params</span><span class="p">)])</span>
</span><span class='line'>      <span class="p">(</span><span class="ss">:name</span> <span class="nv">req-params</span><span class="p">)</span> <span class="p">(</span><span class="nf">update</span> <span class="ss">:where</span> <span class="nv">and-clause</span> <span class="p">[</span><span class="ss">:=</span> <span class="ss">:name</span> <span class="p">(</span><span class="ss">:name</span> <span class="nv">req-params</span><span class="p">)])</span>
</span><span class='line'>      <span class="p">(</span><span class="ss">:min-age</span> <span class="nv">req-params</span><span class="p">)</span> <span class="p">(</span><span class="nf">update</span> <span class="ss">:where</span> <span class="nv">and-clause</span> <span class="p">[</span><span class="ss">:&gt;</span> <span class="ss">:age</span> <span class="p">(</span><span class="ss">:min-age</span> <span class="nv">req-params</span><span class="p">)]))))</span>
</span></code></pre></td></tr></table></div></figure>


<p>Hopefully this gives you a taste of <code>cond-&gt;</code>. I&rsquo;ve found it to be
quite useful. It has a place in every Clojure developer&rsquo;s toolbox.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/04/08/book-review-serverless-single-page-apps/">Book review: Serverless Single Page Apps</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-04-08T10:15:00-05:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>8</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>10:15 am</span></time>
      </p>
    
  </header>


  <div class="entry-content"><p>I&rsquo;ve read Ben Rady&rsquo;s
<a href="https://pragprog.com/book/brapps/serverless-single-page-apps">Serverless Single Page Apps</a>
twice now. As an early technical reviewer, I was able to watch and
take part in the book&rsquo;s evolution. The early draft was good but the
most recent near-final draft was better.</p>

<p><em>Serverless Single Page Apps</em> walks you through building a low-cost,
highly-available, serverless single page web application. It does this
on top of various Amazon web services (DynamoDB, Cognito, Lambda, API
Gateway, S3). If you follow along you&rsquo;ll end up with a simple web
application with authentication.</p>

<p>The book is very enjoyable. The examples are clear and the book is
well written. The book uses JavaScript to implement the serverless
application. For the user interface it uses plain JavaScript with a
bit of jQuery and for the AWS Lambda functions you dip into some
Node.js. <em>Serverless</em> doesn&rsquo;t distract you from learning about
serverless applications by forcing you to learn new JavaScript
frameworks or libraries.</p>

<p>One of my favorite parts of the book is Ben&rsquo;s use of test driven
development. The examples provided give the reader a decent taste of
the benefits of test-first development. Having the tests helped me
when I made some silly mistakes in later parts of the book.</p>

<p>Overall I&rsquo;d recommend this book to developers who are interested in
learning what a serverless application might look like. If you follow
along you&rsquo;ll know how to build one by the end and will have a good
starting point for diving deeper into the topic.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog//6">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog//4">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2020/05/04/how-to-be-alerted-when-a-long-running-process-finishes/">How to be notified when long running processes finish</a>
      </li>
    
      <li class="post">
        <a href="/blog/2020/04/26/hanging-a-hangboard-using-a-doorway-pull-up-bar/">How to hang a hangboard using a doorway pull-up bar</a>
      </li>
    
      <li class="post">
        <a href="/blog/2020/04/21/using-bash-preexec-for-monitoring-the-runtime-of-your-last-command/">Using Bash-Preexec for monitoring the runtime of your last command</a>
      </li>
    
      <li class="post">
        <a href="/blog/2020/03/16/a-retrospective-format/">A retrospective format for remote or co-located teams</a>
      </li>
    
      <li class="post">
        <a href="/blog/2020/03/10/more-working-from-home-tips/">More working from home tips</a>
      </li>
    
      <li class="post">
        <a href="/blog/2020/02/25/auto-syncing-a-git-repository/">Auto-syncing a git repository</a>
      </li>
    
      <li class="post">
        <a href="/blog/2020/01/11/reading-in-2019/">Reading in 2019</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/10/12/building-an-atreus-keyboard/">Building an Atreus keyboard</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/08/23/building-a-onewheel-stand/">Building a Onewheel stand</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/08/15/switching-my-ergodox-to-qmk-firmware/">Switching my Ergodox to QMK firmware</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Subscribe</h1>
  <p>Looking forward to the next article? 
    Subscribe to the <a href="https://feeds.feedburner.com/JakeMccrarysMusings">RSS</a> feed to receive full articles as they are posted or sign-up for periodic <a target="_blank" href="https://jakemccrary.substack.com/welcome">emails</a> containing links back to this site.
  </p>
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  <a href="/disclosure-policy">Disclosure Policy</a><br/>
  <a href="//www.iubenda.com/privacy-policy/509351" class="iubenda-nostyle iub-legal-only iubenda-embed" title="Privacy Policy">Privacy Policy</a><br/>
<script type="text/javascript">(function (w,d) {var loader = function () {var s = d.createElement("script"), tag = d.getElementsByTagName("script")[0]; s.src = "//cdn.iubenda.com/iubenda.js"; tag.parentNode.insertBefore(s,tag);}; if(w.addEventListener){w.addEventListener("load", loader, false);}else if(w.attachEvent){w.attachEvent("onload", loader);}else{w.onload = loader;}})(window, document);</script>
  Content licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/3.0/">Creative Commons Attribution-NonCommercial 3.0 Unported License</a>.
</p>


</footer>
  


</body>
</html>
